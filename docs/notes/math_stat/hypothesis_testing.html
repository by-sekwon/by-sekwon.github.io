<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>수리 통계 7. 가설검정과 신뢰구간 – 세상의 모든 통계 이야기</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d24c3880db9ce3ca4ea2d5bb002bea1f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">세상의 모든 통계 이야기</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="검색"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="탐색 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">기초수학</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="../../notes/math/function.html">
 <span class="dropdown-text">함수</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math/derivate_integral.html">
 <span class="dropdown-text">미분적분</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math/vector.html">
 <span class="dropdown-text">벡터</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math/matrix.html">
 <span class="dropdown-text">행렬</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">수리통계</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--1">    
        <li>
    <a class="dropdown-item" href="../../notes/math_stat/probability.html">
 <span class="dropdown-text">확률</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math_stat/random_variable.html">
 <span class="dropdown-text">확률변수</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math_stat/famous_distribution.html">
 <span class="dropdown-text">유명한분포</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math_stat/multi_variate.html">
 <span class="dropdown-text">다변량확률변수</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math_stat/random_sample.html">
 <span class="dropdown-text">확률표본_난수생성</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math_stat/estimation.html">
 <span class="dropdown-text">추정</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/math_stat/hypothesis_testing.html">
 <span class="dropdown-text">가설검정_신뢰구간</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">조사방법론</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--2">    
        <li>
    <a class="dropdown-item" href="../../notes/survey/survey_intro.html">
 <span class="dropdown-text">조사방법 기초</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/survey/sample_design.html">
 <span class="dropdown-text">표본설계</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/survey/questionnaire.html">
 <span class="dropdown-text">설문지</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/survey/nonresponse.html">
 <span class="dropdown-text">무응답 대체</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/survey/data_process.html">
 <span class="dropdown-text">데이터 처리</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/survey/survey_scale.html">
 <span class="dropdown-text">조사지 척도</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/survey/delphi_ahp_conjoint.html">
 <span class="dropdown-text">델파이_AHP_컨조인트</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/survey/psm.html">
 <span class="dropdown-text">PSM 성향점수매칭</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">일변량분석</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--3">    
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/concept_of_stat.html">
 <span class="dropdown-text">일변량분석 개념</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/data.html">
 <span class="dropdown-text">데이터와 통계</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/univariate.html">
 <span class="dropdown-text">일변량분석</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/crosstab.html">
 <span class="dropdown-text">교차표분석</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/goodness_of_fits.html">
 <span class="dropdown-text">적합성검정</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/normality.html">
 <span class="dropdown-text">정규변환</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/correlation.html">
 <span class="dropdown-text">상관분석</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/anova.html">
 <span class="dropdown-text">실험설계 분산분석</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/intro_stat/time_series.html">
 <span class="dropdown-text">시계열분석</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">회귀분석</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--4">    
        <li>
    <a class="dropdown-item" href="../../notes/linear_model/lm_concept.html">
 <span class="dropdown-text">개념&amp;추정</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/linear_model/lm_selection.html">
 <span class="dropdown-text">변수선택</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/linear_model/lm_multicolin.html">
 <span class="dropdown-text">다중공선성</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/linear_model/lm_diagnosis.html">
 <span class="dropdown-text">회귀진단</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notes/linear_model/lm_logistic.html">
 <span class="dropdown-text">로지스틱회귀</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../cardnews/index.html"> 
<span class="menu-text">카드뉴스</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../consult.html"> 
<span class="menu-text">통계상담</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--5" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">📡스트리밍</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--5">    
        <li>
    <a class="dropdown-item" href="https://by-sekwonappio-esqshnv7wueapp4da6jrizn.streamlit.app" target="_blank">
 <span class="dropdown-text">실시간주가[5대종목]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://by-sekwonappio-k5e5n7wasvj3kveyqbwmgc.streamlit.app/" target="_blank">
 <span class="dropdown-text">대전유성구 일기예보</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#chapter-1.-가설검정" id="toc-chapter-1.-가설검정" class="nav-link active" data-scroll-target="#chapter-1.-가설검정"><span style="color:green">chapter 1. 가설검정</span></a>
  <ul>
  <li><a href="#기초" id="toc-기초" class="nav-link" data-scroll-target="#기초"><span style="color:blue">1. 기초</span></a></li>
  <li><a href="#가설검정-방법" id="toc-가설검정-방법" class="nav-link" data-scroll-target="#가설검정-방법"><span style="color:blue">2. 가설검정 방법</span></a></li>
  </ul></li>
  <li><a href="#chapter-2.-구간-추정" id="toc-chapter-2.-구간-추정" class="nav-link" data-scroll-target="#chapter-2.-구간-추정"><span style="color:green">chapter 2. 구간 추정</span></a>
  <ul>
  <li><a href="#구간추정" id="toc-구간추정" class="nav-link" data-scroll-target="#구간추정"><span style="color:blue">1. 구간추정</span></a></li>
  <li><a href="#정규분포-가정-모형" id="toc-정규분포-가정-모형" class="nav-link" data-scroll-target="#정규분포-가정-모형"><span style="color:blue">2. 정규분포 가정 모형</span></a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">수리 통계 7. 가설검정과 신뢰구간</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><br></p>
<section id="chapter-1.-가설검정" class="level3">
<h3 class="anchored" data-anchor-id="chapter-1.-가설검정"><span style="color:green">chapter 1. 가설검정</span></h3>
<section id="기초" class="level4">
<h4 class="anchored" data-anchor-id="기초"><span style="color:blue">1. 기초</span></h4>
<section id="개념" class="level5">
<h5 class="anchored" data-anchor-id="개념">(1) 개념</h5>
<p>추론 통계학 inference statistics 은 모집단의 특성치인 모수 <span class="math inline">\(\theta\)</span>에 대한 추정치(점 추정치, 구간 추정치)를 구하는 추정 과 모수 값에 대한 가설의 진위 여부(통계적 유의성)를 알아보는 가설 검정 hypothesis testing이 있다.</p>
<p>가설 검정은 과학적 연구와 유사하다. ⑴자연 현상을 관찰하여 ⑵이론을 정립하고 (임의의 모수 값) ⑶관측치를 통하여 이론 진위 여부를 테스트 한다. 이론의 옳고 그름은 표본 관측치에 의해 판단된다.</p>
<p>가설검정은 무죄 추정의 원칙으로 범인의 유죄여부를 배심원의 결정과정과 동일하다. <span dir="rtl">’</span>범인은 무죄이다<span dir="rtl">’</span>를 시작으로 <span dir="rtl">’</span>검사가 제시한 여러 증거<span dir="rtl">’</span>(표본 데이터)를 기반하여 범인의 유죄, 무죄를 판결한다. 가설검정은 연역적 추론 과정과 유사하여 1) 자연현상, 사회현상을 관찰하여 이론을 도출하고 2)이를 통계적 가설로 만든 후 3)적절한 (확률표본) 데이터를 수집 분석하여 4)가설의 진위를 검증한다.</p>
</section>
<section id="통계적-가설" class="level5">
<h5 class="anchored" data-anchor-id="통계적-가설">(2) 통계적 가설</h5>
<p>통계적 가설은 모수에 관한 가정이다. <span class="math inline">\(X \sim f(x;\theta,\theta \in \Omega)\)</span>의 모수 <span class="math inline">\(\theta\)</span>가 가지는 값에 대한 가정이다. 설정한 통계적 가설은 통계적 방법으로 테스트 할 수 있도록 한 것으로 모수의 값에 관한 것이다.</p>
<ul>
<li><p>불량률이 5%인 제조 공정을 개선하기 위한 새로운 공정이 제안되었다. 모수는 모집단 비율 <span class="math inline">\(\theta = p\)</span></p></li>
<li><p>기존의 약에 비해 두통에 효과적인 새로운 약을 개발하였다고 하자. 두 모집단 평균 차이 <span class="math inline">\(\theta = \mu_{old} - \mu_{new}\)</span></p></li>
<li><p>수능성적과 GPA의 관계? <span class="math inline">\(GPA = a + b \times SAT\)</span>, <span class="math inline">\(b = 0\)</span>?</p></li>
</ul>
<p><strong>【정의】</strong> 모수 <span class="math inline">\((\theta \in \Omega = \left\{ \theta;\omega_{0} \cup \omega_{1} \right\},\omega_{0} \cap \omega_{1} = \phi)\)</span>에 관한 통계적 가설은 다음과 같이 2개의 가설로 나뉜다.</p>
<ul>
<li><p>귀무가설 null hypothesis : <span class="math inline">\(H_{0}:\theta \in \omega_{0}\)</span>, 집합 <span class="math inline">\(\omega_{0}\)</span>에는 하나의 값 <span class="math inline">\(\omega_{0}\)</span>만 있다.</p></li>
<li><p>대립가설 alternative hypothesis : <span class="math inline">\(H_{1}:\theta \in \omega_{1}\)</span>, 집합 <span class="math inline">\(\omega_{1} = \{\theta;\theta \neq \theta_{0}\}\)</span>이다.</p></li>
<li><p>양측 대립가설 : <span class="math inline">\(\omega_{1} = \{\theta;\theta \neq \theta_{0}\}\)</span></p></li>
<li><p>단측 대립가설 : <span class="math inline">\(\omega_{1} = \{\theta;\theta &lt; \theta_{0}\}\)</span>, <span class="math inline">\(\omega_{1} = \{\theta;\theta &gt; \theta_{0}\}\)</span></p></li>
</ul>
<p>우리가 지지하는 가설은 연구가설 research hypothesis 혹은 대립가설이라 한다. 대립가설과 반대되는 가설을 귀무가설라 한다. 어떤 가설이 지지되느냐는 관측된 표본 데이터에 의존한다. <span dir="rtl">”</span>귀무”(null)의 의미는 아무 것도 없다는 것이다.</p>
</section>
<section id="검정통계량" class="level5">
<h5 class="anchored" data-anchor-id="검정통계량">(3) 검정통계량</h5>
<p>검정통계량은 통계적 가설 검정에서 사용되는 중요한 개념으로 확률표본 데이터를 기반으로 계산되며 귀무가설을 평가하는데 사용된다. 검정통계량은 일반적으로 확률표본 데이터의 요약된 값으로 귀무가설이 참일 때 얼마나 불일치하는지를 나타내는 역할을 한다. 검정통계량의 값은 귀무가설의 가정과 확률표본 데이터 간의 차이를 측정하며, 이 값을 기반으로 가설 검정의 결과를 판단한다.</p>
<p>예를 들어, 평균값의 차이에 대한 가설 검정을 수행한다고 가정해보자. 두 그룹의 평균을 비교하려면 먼저 평균의 차이를 계산하고, 이 차이를 그룹 간의 변동을 나타내는 표준 오차로 나누어 표준화된 차이를 얻을 수 있는데. 이 표준화된 차이가 검정통계량이 된다.</p>
<p>검정통계량의 값은 주어진 데이터에 따라 달라지며 이 값을 귀무가설에 대한 기대값과 비교하여 가설 검정의 결과를 결정한다. 일반적으로 검정통계량이 특정한 임계값보다 크거나 작으면 귀무가설을 기각하고 대립가설을 지지하는 결론을 내린다. 이 때 임계값은 유의수준에 따라 결정되며, 유의수준은 연구자가 허용하는 오류의 수준을 나타낸다.</p>
<p><strong>【검정통계량】</strong></p>
<p><span class="math inline">\(f(x;\theta)\)</span>에서 확률표본 <span class="math inline">\((X_{1},X_{2},\ldots,X_{n})\)</span>의 함수인 통계량 <span class="math inline">\(t(x_{1},x_{2},\ldots,x_{n})\)</span>이 가설 검정에 사용되면 이를 검정 통계량이라 한다.</p>
<p><strong>【가설 검정 방법】</strong></p>
<ul>
<li><p>채택 영역 acceptance region: 어떤 확률표본 값들에 대하여 귀무가설을 참으로 받아들일지 결정</p></li>
<li><p>기각 영역 rejection region : 어떤 확률표본 값들에 대하여 귀무가설을 기각하고 대립가설을 참으로 받아들일지 결정</p></li>
</ul>
<p>"귀무가설 기각"과 "대립가설 수용" 사이의 차이를 이해하는 것은 쉽지 않다. 첫 번째 경우에는 실험자가 어떤 상태를 수용하는지에 대한 내용은 함축되지 않으며, 오직 <span class="math inline">\(H_{0}\)</span>에 의해 정의된 상태가 기각된다는 것만을 나타낸다. 마찬가지로 "귀무가설 수용"과 "귀무가설 기각하지 않음" 사이에도 차이가 있을 수 있다. 첫 번째 구문은 실험자가 <span class="math inline">\(H_{0}\)</span>로 지정된 상태(단일 모수 값)를 주장하려고 하는 것을 의미하며, 두 번째 구문은 실험자가 실제로 <span class="math inline">\(H_{0}\)</span>를 믿지 않지만 기각할 증거가 없다는 것을 의미한다.</p>
</section>
<section id="기각역" class="level5">
<h5 class="anchored" data-anchor-id="기각역">(4) 기각역</h5>
<p>확률표본 <span class="math inline">\((X_{1},X_{2},\ldots,X_{n})\)</span>의 영역을 <span class="math inline">\(\mathcal{D}\)</span>라 하자. <span class="math inline">\(\mathcal{D}\)</span>의 부분 집합 <span class="math inline">\(RR\)</span> 에 확률표본 값이 포함되면 귀무가설을 기각한다면 <span class="math inline">\(RR\)</span> 영역을 기각역 critical region 이라 한다.</p>
<ul>
<li><p>귀무가설: <span class="math inline">\(H_{0}:\theta \in \omega_{0} = \{\theta;\theta_{0}\}\)</span> – 단일 simple 가설</p></li>
<li><p>대립가설: <span class="math inline">\(H_{1},H_{a}:\theta \in \omega_{1} = \{\theta;{\theta \neq \theta}_{0}\}\)</span> 복합 composite 가설</p></li>
</ul>
<p>만약 <span class="math inline">\(t\left( x_{1},x_{2},\ldots,x_{n} \right) \in RR\)</span>, 귀무가설 기각한다. ⬄ 대립가설 채택한다. 만약 <span class="math inline">\(t\left( x_{1},x_{2},\ldots,x_{n} \right) \in {RR}^{c}\)</span>, 귀무가설 채택한다. ⬄ 대립가설을 기각한다.</p>
<p>귀무가설을 기각하는 검정통계량의 값이 포함된 영역을 기각역 이라 한다. 만약 확률표본으로부터 계산된 검정통계량의 값이 기각역에 포함되면 귀무가설을 기각(대립가설 채택)하고 그렇지 않으면 귀무가설을 채택한다. 빨간 영역 부분이 기각역이다. 영역이 시작되는 값을 기각값, 임계값 critical value 이라 한다.</p>
</section>
<section id="종오류-2종-오류" class="level5">
<h5 class="anchored" data-anchor-id="종오류-2종-오류">(5) 1종오류, 2종 오류</h5>
<p>【1종 오류, 2종 오류】</p>
<ul>
<li><p>1종 오류 : 귀무가설이 사실일 때 귀무가설을 기각할 확률이다. type I error, <span class="math inline">\(\alpha\)</span> 라고 표기한다.</p></li>
<li><p>2종 오류 : 대립가설이 사실일 때 귀무가설을 채택하는 확률이다. type II error, <span class="math inline">\(\beta\)</span>라 표기한다.</p></li>
</ul>
<p>즉 <span class="math inline">\(\alpha,\beta\)</span>는 통계적 가설 검정의 정확도를 측정하는데 매우 유용하다.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;"><p>실제 모집단</p>
<p>가설 판단</p></td>
<td style="text-align: center;">귀무가설(<span class="math inline">\(H_{0}\)</span>) 진실</td>
<td style="text-align: center;">대립가설(<span class="math inline">\(H_{1}\)</span>) 진실</td>
</tr>
<tr class="even">
<td style="text-align: right;">귀무가설 기각</td>
<td style="text-align: center;">1종 오류 <span class="math inline">\(\alpha\)</span></td>
<td style="text-align: center;">옳은 판단</td>
</tr>
<tr class="odd">
<td style="text-align: right;">귀무가설 채택</td>
<td style="text-align: center;">옳은 판단</td>
<td style="text-align: center;">2종 오류 <span class="math inline">\(\beta\)</span></td>
</tr>
</tbody>
</table>
<p>가설 검정의 목표는 모든 가능한 기각 영역 중에서 이러한 오류의 확률을 최소화하는 영역을 선택하는 것이지만 일반적으로 이것은 불가능한다. 이러한 오류의 확률은 종종 풍선 효과를 가지고 있는데 이것은 극단적인 경우에 즉시 볼 수 있다.</p>
<p>단순히 <span class="math inline">\(RR = \phi\)</span>라 가정해 보자. 이 기각 영역에서는 결코 귀무가설을 기각하지 않을 것이므로 제1종 오류의 확률은 0이 될 것이지만, 제2종 오류의 확률은 1이다. 종종 우리는 두 오류 중에서 제1종 오류를 더 나쁜 오류로 간주한다. 따라서 우리는 제1종 오류의 확률을 제한하는 기각 영역을 선택한 다음 이러한 기각 영역 중에서 제2종 오류의 확률을 최소화하는 하나를 선택하려고 노력하게 된다. 검정 시 설정한 1종 오류(검정 크기)을 유의수준 significance level이라 한다.</p>
<p><strong>【검정 크기】</strong></p>
<p>만약 <span class="math inline">\(\alpha = \max_{\theta \in \omega_{0}}{P_{\theta}(t\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR)}\)</span> 이면 기각역의 크기 size는 <span class="math inline">\(\alpha\)</span>라 한다. 크기 <span class="math inline">\(\alpha\)</span>의 모든 기각 영역을 고려할 때, 우리는 제2종 오류의 확률이 더 낮은 영역을 고려한다. 또한 제2종 오류의 여집합을 살펴볼 수 있는데 즉 귀무가설이 참일 때 귀무가설을 기각하는 것이며 이것은 옳은 결정이다. 우리는 이후의 결정의 확률을 최대화하려고 하므로 이 확률이 최대한 크도록 하려고 합니다. 즉, <span class="math inline">\(\theta \in \omega_{1}\)</span>인 경우 우리는 다음을 최대화하고자 한다.</p>
<p><span class="math display">\[1 - P_{\theta}(typeIIerror) = P_{\theta}\left( \left( X_{1},X_{2},\ldots,X_{n} \right) \in RR \right)\]</span></p>
<p><strong>【1종 오류】</strong></p>
<p>1종 오류는 유의수준, 검정 크기와 동일하다. 기각역 <span class="math inline">\(C\)</span>에 검정통계량 값이 속할 확률이다. <span class="math inline">\(P_{\theta_{0}}(t\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR)\)</span></p>
<p><strong>【2종 오류 계산】</strong></p>
<p>귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>, 대립가설 <span class="math inline">\(H_{1}:\theta = \theta_{1} &lt; \theta_{0}\)</span>의 경우 2종 오류을 계산하는 방법을 살펴 보자. 2종 오류를 계산하려면 대립가설에 속한 모수의 하나의 값이 필요하다. 대립가설의 모수 값은 구간이기 때문이다. 대립가설의 하나의 값을 <span class="math inline">\(\theta_{1}\)</span>라 하자.</p>
<ul>
<li><p>2종 오류: <span class="math inline">\(P_{\theta_{1}}(t\left( X_{1},X_{2},\ldots,X_{n} \right) \in CR)\)</span> 검정 통계량이 기각역(<span class="math inline">\(CR\)</span>)에 속하지 않을 확률</p></li>
<li><p>대립가설의 <span class="math inline">\(\theta_{1}\)</span>이 <span class="math inline">\(\theta_{0}\)</span>에 가깝다면 대립가설이 사실임에도 불구하고 귀무가설 받아들일 가능성이 높다. 즉 2종 오류는 커진다.</p></li>
</ul>
</section>
<section id="검정력" class="level5">
<h5 class="anchored" data-anchor-id="검정력">(6) 검정력</h5>
<p><strong>【검정력 함수】</strong></p>
<p>다음은 기각역의 검정력 함수 power function로 정의한다. 검정력 함수는 모수 함수이다.</p>
<p><span class="math inline">\(\gamma_{C}(\theta) = P_{\theta}(t\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR;\theta \in \omega_{1})\)</span></p>
<p>귀무가설 하의 모수 값에서 검정력은 1 종 오류(유의수준)이다.</p>
<p><strong>【예제】</strong> <span class="math inline">\(f(x;\theta) = \frac{1}{\theta},0 &lt; x &lt; \theta \sim U(0,\theta)\)</span>에서 모수 <span class="math inline">\(\theta\)</span>에 대한 다음 가설을 검정하기 위하여 확률표본을 추출하였다.</p>
<ul>
<li><p>귀무가설 : <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span></p></li>
<li><p>대립가설 : <span class="math inline">\(H_{1}:\theta = \theta_{1} &lt; \theta_{0}\)</span> 단측 대립가설</p></li>
<li><p>검정통계량 : MVUE의 함수이며 확률밀도함수가 알려진 통계량을 이용한다. *) 모집단 비율의 MVUE는 <span class="math inline">\(\sum X_{i}/n\)</span>이지만 <span class="math inline">\(\sum X_{i} \sim B(n,p)\)</span> 이므로 <span class="math inline">\(T = \sum X_{i}\)</span>을 검정 통계량으로 사용한다.</p></li>
<li><p>기각역 및 임계값 : 만약 <span class="math inline">\(RR = \{ t;T \leq k\}\)</span>이면 귀무가설 기각한다. 임계값 <span class="math inline">\(\alpha = P_{\theta_{0}}(T \leq k)\)</span>에 의해 결정된다.</p></li>
<li><p>검정력 함수: <span class="math inline">\(\gamma_{C}(\theta) = P_{\theta}(T \leq k),\theta \leq \theta_{0}\)</span>, 대립가설의 참 모수 값이 귀무가설 <span class="math inline">\(\theta_{0}\)</span>에서 멀어질수록 검정력은 커진다.</p></li>
</ul>
<p><strong>【예제】</strong> A 교수는 수리통계학 시험 점수가 평균 70점 수준으로 출제했다고 했다. 수강생이 시험을 보고 나와 어려워 70점 미만이라고 주장했다. 25명 수강생 점수를 확인한 결과 평균 69점, 표준편차 9점이었다. 수강생들의 주장을 유의수준 5%에서 검정하라. 수리통계학 점수는 정규분포를 따른다.</p>
<ul>
<li><p>귀무가설: <span class="math inline">\(H_{0}:\mu_{0} = 70\)</span></p></li>
<li><p>대립가설: <span class="math inline">\(H_{1}:\mu_{1} &lt; 70\)</span> 단측 대립가설</p></li>
<li><p>검정통계량: 모집단 평균 MVUE는 <span class="math inline">\(\overline{X}\)</span>이고 <span class="math inline">\(\frac{\overline{X} - \mu_{0}}{\frac{S}{\sqrt{n}}} = \frac{69 - 70}{\frac{9}{\sqrt{25}}} = - 1.67 \sim t(n - 1 = 24)\)</span>이다.</p></li>
<li><p>기각역 및 임계값: <span class="math inline">\(0.05 = P_{\mu_{0}}(t(24) \leq k)\)</span> 식에서 의해 결정된다. <span class="math inline">\(k = - 1.71\)</span></p></li>
<li><p>검정력 함수: <span class="math inline">\(\gamma_{C}(\theta) = P_{\mu}\left( \frac{69 - \mu}{\frac{9}{\sqrt{25}}} \leq - 1.71 \right)\)</span></p></li>
</ul>
</section>
<section id="유의확률" class="level5">
<h5 class="anchored" data-anchor-id="유의확률">(7) 유의확률</h5>
<p>1종 오류, 2종 오류, 검정력을 계산하는 방법에 대해 다루었다. 가설검정 절차를 보면 ① 가설 설정과 유의수준 <span class="math inline">\(\alpha\)</span>을 설정하고 ② 적절한 검정통계량 계산 ③ 기각역(유의수준과 검정통계량의 분포에 따라 계산된다)을 얻고 이에 따라 귀무가설 채택 여부를 결정한다.</p>
<p>설정된 1종 오류를 유의수준 significant level, test level 이라 하고 <span class="math inline">\((1 - \beta)\)</span>을 검정력 power of test, test power 이라 한다. 유의수준은 일반적으로 1%, 5%, 10% (물론 5%을 가장 많이 사용하지만)을 사용하게 되므로 기각역이 달라진다. 만약 어떤 사람이 유의수준 5%에서 귀무가설을 기각하지 못했다고 발표했다. 그럼? 10%일 때는… 우리는 다시 가설 검정을 해야 한다. why? 기각역이 달라지므로…</p>
<p>이런 문제를 해결할 방법이 없을까? p-값 p-value, 유의확률 significant probability 개념을 도입하자. 검정통계량이 계산되면 귀무가설을 더 기각할 영역의 확률을 p-값이라 한다. 다음은 대립가설이 <span class="math inline">\(H_{1}:\theta &gt; \theta_{0}\)</span>일 경우 유의확률을 계산 방법이다.</p>
<p><strong>【유의확률】</strong></p>
<p>대립가설은 <span class="math inline">\(H_{1}:\theta = \theta_{1} &gt; \theta_{0}\)</span>이고 확률표본에 의해 계산된 검정통계량 값을 <span class="math inline">\(t^{*}\)</span> 하자.</p>
<ul>
<li><p><span class="math inline">\(RR = \{{T &gt; t}^{*}\}\)</span>.</p></li>
<li><p>유의확률: <span class="math inline">\({p - value = P}_{\theta_{0}}(t\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR)\)</span></p></li>
</ul>
<p>계산된 검정통계량이 귀무가설이 진실이라는 가정 하에 귀무가설을 기각할 최소의 확률을 유의확률 혹은 p-값이라 한다. 그러므로 유의확률을 계산된 유의수준이다. 계산된 검정통계량이 귀무가설을 기각할 방향(대립가설을 채택할 방향)의 영역 확률을 유의확률이라 한다.</p>
<p>유의확률이 주어지면 귀무가설 채택 여부를 알 수 있다. 유의확률이 유의수준보다 크다면 검정통계량의 값은 기각역에 속한 것이 아니므로 귀무가설이 채택되고 유의확률이 유의수준보다 적다면 검정통계량의 값이 기각역에 속하므로 귀무가설을 기각한다.</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim N(\mu,\sigma^{2})\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본을 추출하였다. 모분산 <span class="math inline">\(\sigma^{2}\)</span>을 알지 못할 때 nuisance parameter 귀무가설 <span class="math inline">\(H_{0}:\mu = \mu_{0}\)</span>와 대립가설 <span class="math inline">\(H_{1}:\mu = \mu_{1} &gt; \mu_{0}\)</span>을 유의수준 <span class="math inline">\(\alpha\)</span> 에서 우도비 검정방법은 <span class="math inline">\(T(\overline{x}) = \frac{\sqrt{n}(\overset{¯}{x} - \mu_{0})}{S} \sim t(n - 1)\)</span>이다.(자세한 내용은 다음 2절. 우도비 검정을 참고하기 바란다.)</p>
<ul>
<li><p><span class="math inline">\({p - value = P}_{\theta_{0}}\left( t\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR \right) = P(t(n - 1) \geq T(\overline{x}))\)</span></p></li>
<li><p>만약 대립가설 <span class="math inline">\(H_{1}:\mu = \mu_{1} \neq \mu_{0}\)</span> (양측 대립가설)이면 <span class="math inline">\(p - value = 2P(t(n - 1) \geq |T\left( \overline{x} \right)|)\)</span>.</p></li>
</ul>
<p><strong>【유의확률과 대립가설 형태】</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/유의확률.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>유의확률을 계산할 때 계산된 검정 통계량 값이 귀무가설에 설정한 모수 값(확률밀도함수의 중앙)으로부터 멀어지는 구간에 속할 확률을 구하면 된다. 단측 대립가설이면 구한 유의확률을 그대로 사용하면 되지만 양측 대립가설일 경우에는 계산된 유의확률을 2배 하여 유의확률로 사용해야 한다. 그러므로 양측 대립가설이 채택되면 단측 대립가설도 항상 성립한다.</p>
</section>
<section id="가설검정-관련-코멘트" class="level5">
<h5 class="anchored" data-anchor-id="가설검정-관련-코멘트">(8) 가설검정 관련 코멘트</h5>
<ol type="1">
<li><p>양측검정이냐? 단측검정이냐? 우리가 무엇에 관심을 갖느냐 하는데 있다. 불량률과 같이 ~값 미만에 관심이 있다면 왼쪽이 단측 검정, 수익과 같이 ~값 이상에 관심이 있다면 우측이 대립가설이 단측 검정을 실시한다. <span dir="rtl">”</span>차이가 없다” 같이 양쪽 모두에 관심이 있다면 양측검정을 실시한다.</p></li>
<li><p>양측 대립가설이 기각되면 단측 대립가설은 항상 기각된다. 그러므로 “차이가 없다”가 기각되면 “차이가 있다”는 물론 “크다” 혹은 “적다”로 검정 결과를 내려도 된다.</p></li>
<li><p>1종 오류는 기각역이 정해지면 계산 가능하지만 2종 오류는 대립 가설의 값 중 임의의 값이 설정되어야 가능하다. 검정력은 (1-2종 오류) 정의된다. 또한 우리의 관심이 대립가설에 있으므로 1종 오류를 설정하고(이를 유의수준이라 한다) 2종 오류를 최소화 하는 검정 방법을 구하게 된다. (1종, 2종 오류 모두 줄이는 방법은 없다.)</p></li>
<li><p>단측 검정일 때 귀무가설에 대하여 대립가설이 <span class="math inline">\(H_{1}:\theta &lt; \theta_{0}\)</span>라면 귀무가설이 <span class="math inline">\(H_{0}:\theta \geq \theta_{0}\)</span>은 아닌가? 1종 오류는 <span class="math inline">\(\alpha = \max_{\theta \in \omega_{0}}{P_{\theta}(t\left( X_{1},X_{2},\ldots,X_{n} \right) \in CR)}\)</span>에 해당된다. 그러므로 Boundary 값이 <span class="math inline">\(\theta_{0}\)</span>에서 최대화되므로 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>이 적절하다. 그리고 우리의 관심은 귀무가설이 아니므로 귀무가설이 채택된다면 우리는 헛수고 한 것이다.</p></li>
</ol>
</section>
<section id="가설검정과-신뢰수준" class="level5">
<h5 class="anchored" data-anchor-id="가설검정과-신뢰수준">(9) 가설검정과 신뢰수준</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/신뢰구간 가설검정.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>유의수준 <span class="math inline">\(\alpha\)</span>의 양측 가설 검정과 <span class="math inline">\(100(1 - \alpha)\%\)</span>신뢰구간은 일대일 대응관계가 있다. 모집단 <span class="math inline">\(f(x;\theta = \mu)\)</span>, 확률표본, 추정량 <span class="math inline">\(\overset{\hat{}}{\theta} = \overset{¯}{X}\)</span>, 표본분산 <span class="math inline">\(S^{2}\)</span>, 귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>인 경우 대표본 이론에 의해 <span class="math inline">\(T = \frac{\overset{\hat{}}{\theta} - \theta_{0}}{\frac{S}{\sqrt{n}}}\)</span>는 <span class="math inline">\(N(0,1)\)</span>을 따르므로 다음이 성립한다.</p>
<ul>
<li><p><span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간 : <span class="math inline">\(\theta \pm z_{\left( 1 - \frac{\alpha}{2} \right)}\frac{s}{\sqrt{n}}\)</span></p></li>
<li><p>유의수준 <span class="math inline">\(\alpha\)</span>인 경우 기각역 : <span class="math inline">\(C = \{|\frac{\overset{\hat{}}{\theta} - \theta}{\frac{s}{\sqrt{n}}}| &gt; z_{\left( 1 - \frac{\alpha}{2} \right)}\}\)</span></p></li>
<li><p>유의수준 <span class="math inline">\(\alpha\)</span>인 경우 채택역 : <span class="math inline">\(C^{c} = \{\left| \frac{\overset{\hat{}}{\theta} - \theta}{\frac{s}{\sqrt{n}}} \right| \leq z_{\left( 1 - \frac{\alpha}{2} \right)}\}\)</span></p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/신뢰구간.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>즉 신뢰구간과 채택역은 동일함을 알 수 있다. 신뢰구간에 속한 모수 값이 귀무가설에 설정되면 그 귀무가설은 기각되지 않는다. 표본으로부터 통계량이 계산되면 신뢰구간의 식에의해 모수에 대한 구간이 결정된다. 그 부분이 빨간 영역 부분이다.귀무가설에 빨간 영역 안에 있는 모수 값이 설정되면 귀무가설을 기각하지 못한다.</p>
<p>단측 가설 검정과 상한(혹은 하한) 신뢰구간도 일대일 관계가 있다. <span class="math inline">\(100(1 - \alpha)\%\)</span> 하한 신뢰구간은 유의수준 <span class="math inline">\(\alpha\)</span>, 귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>, 대립가설: <span class="math inline">\(H_{0}:\theta_{1} &gt; \theta_{0}\)</span>의 채택역과 동일하다. 또한 상한신뢰구간 대립가설 <span class="math inline">\(H_{0}:\theta_{1} &lt; \theta_{0}\)</span>의 채택역과 동일하다.</p>
<p><strong>【예제】</strong> 정부는 PC 구입 가격이 900$이라고 발표했다. 이를 알아보기 위하여 소비자 55명을 임의 조사하였더니 평균 885$, 표준편차는 50$이었다.</p>
<ul>
<li><p>모집단 평균에 대한 99%(양측)신뢰구간을 구하시오. (<span class="math inline">\(\overset{¯}{X} \pm Z_{0.995}\frac{S}{\sqrt{n}}) \rightarrow (885 \pm 2.58\frac{50}{\sqrt{25}}) \rightarrow (859.2,910.8)\)</span></p></li>
<li><p>정부의 발표가 진실이라고 할 수 있나(유의수준 1%)? 유의수준 1% 검정 통계량 : <span class="math inline">\(\frac{\overset{¯}{X} - \mu_{0}}{\frac{S}{\sqrt{n}}} = \frac{885 - 900}{\frac{50}{\sqrt{25}}} = - 0.5\)</span></p></li>
<li><p>기각역 : <span class="math inline">\(C = \{ t;|t| &lt; 2.58\}\)</span> 검정 통계량 값이 기각역에 속하지 않으므로 귀무가설을 채택한다. 유의수준 1%에서 귀무가설 값이 99% 신뢰구간에 속하므로 귀무가설 채택하게 되므로 신뢰구간을 계산한 경우에는 가설검정을 할 필요가 없다.</p></li>
</ul>
</section>
<section id="랜덤화-검정" class="level5">
<h5 class="anchored" data-anchor-id="랜덤화-검정">(10) 랜덤화 검정</h5>
<p>가설 검정에서 설정한 유의수준에 의해 기각역이 설정되는데 이산형 확률분포의 경우 설정된 유의수준 정확한 값에 대응하는 기각역을 설정하지 못하는 경우가 발생하는 경우 랜덤화 검정을 실시한다. 예제로 이 개념을 설명하기로 한다.</p>
<p><strong>【예제】</strong> <span class="math inline">\(f(x;\theta = \lambda) \sim Poisson(\theta)\)</span>의 모수 <span class="math inline">\(\theta\)</span>에 대한 가설 검정을 위하여 표본크기 <span class="math inline">\(n = 10\)</span>인 확률표본 <span class="math inline">\((X_{1},X_{2},\ldots,X_{10})\)</span>을 추출하였다. 귀무가설 <span class="math inline">\(\theta = 0.1\)</span>, 귀무가설 <span class="math inline">\(\theta &gt; 0.1\)</span>을 유의수준 5%에서 검정하려고 할 때 기각역을 구하라</p>
<ul>
<li><p>검정 통계량: <span class="math inline">\(T = \sum_{i}^{10}X_{i} \sim Poisson(\lambda = 10\theta)\)</span></p></li>
<li><p>기각역: <span class="math inline">\(P_{\theta_{0} = 0.1}(T \geq 3) = 0.08\)</span>, <span class="math inline">\(P_{\theta_{0} = 0.1}(T \geq 4) = 0.019\)</span> 이처럼 유의수준 5%에 해당하는 기각역 얻을 수 없다. 보간법에 의해 <span class="math inline">\(\frac{0.05 - 0.019}{0.08 - 0.019} = \frac{31}{61}\)</span> 이다. 그러므로 유의수준 5% 기각역은 다음과 같다. 만약 <span class="math inline">\((T \geq 4)\)</span> 귀무가설을 기각하고 <span class="math inline">\((T = 3)\)</span>이면 <span class="math inline">\(\frac{31}{61}\)</span> 확률로 기각한다.</p></li>
</ul>
</section>
</section>
<section id="가설검정-방법" class="level4">
<h4 class="anchored" data-anchor-id="가설검정-방법"><span style="color:blue">2. 가설검정 방법</span></h4>
<section id="최강-검정법" class="level5">
<h5 class="anchored" data-anchor-id="최강-검정법">(1) 최강 검정법</h5>
<p>검정방법의 정도 goodness는 1종 오류와 2종 오류로 판단하는데 가설검정 시작 시 1종 오류는 유의수준으로 설정되므로 좋은 검정 방법이란 2종 오류를 최소화 하는 것이다. 즉 (1-2종 오류), 검정력 최대화 하는 것이다. 이를 최강 검정법 most powerful test 이라 한다.</p>
<p>모집단 확률변수 <span class="math inline">\(X \sim f(x;\theta),\theta \in \Omega = \{\omega_{0} \cup \omega_{1}\}\)</span>이고 다음 2개의 단일 귀무가설과 대립가설을 가정하자.</p>
<ul>
<li><p>귀무가설 : <span class="math inline">\(H_{0}:\theta \in \omega_{o}\)</span></p></li>
<li><p>대립가설 : <span class="math inline">\(H_{1}:\theta \in \omega_{1}\)</span></p></li>
</ul>
<p>모집단 확률변수 <span class="math inline">\(X \sim f(x;\theta)\)</span> 에서 확률표본 <span class="math inline">\({\overline{X}}' = (X_{1},X_{2},\ldots,X_{n})\)</span>이라 하고 <span class="math inline">\(\mathcal{S}\)</span>을 확률표본 영역이라 하자.</p>
<p><strong>【유의수준】</strong> 확률표본의 영역을 <span class="math inline">\(\mathcal{S}\)</span>, 확률표본 영역의 부분 집합 <span class="math inline">\(RR \in \mathcal{S}\)</span>이라 하자. 다음 <span class="math inline">\(\alpha\)</span>을 1종 오류 type I error, 유의수준 significant level 이라 한다. <span class="math inline">\(\alpha = \max_{\theta \in \omega_{0}}{P_{\theta}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR \right)}\)</span>.</p>
<p><strong>【검정력】</strong> 다음을 검정력 power function 이라 정의한다.</p>
<p><span class="math inline">\({{P(\theta) = \gamma}_{RR}(\theta) = P}_{\theta}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR \right);\theta \in \omega_{1}\)</span></p>
<p><strong>【예제】</strong> 표본크기 5인 확률표본 <span class="math inline">\(\left( X_{1},X_{2},\ldots,X_{5} \right) \sim B(p)\)</span>을 이용하여 <span class="math inline">\(H_{0}:p = 0.5vs.H_{1}:p &gt; 0.5\)</span> 가설을 검정한다고 하자.</p>
<p>(1) 기각역을 <span class="math inline">\(RR = \{\sum x_{i} = 5\}\)</span></p>
<ul>
<li><p>1종 오류: <span class="math inline">\(\alpha = P(\sum x_{i} = 5,\sum x_{i} \sim B(5,0.5)) = 0.031\)</span></p></li>
<li><p>2종 오류 : <span class="math inline">\(\beta(p) = P(\sum x_{i} \leq 4,\sum x_{i} \sim B(5,p &gt; 0.5))\)</span></p></li>
<li><p>검정력 : <span class="math inline">\(Power(p) = 1 - \beta(p)\)</span>이므로 <span class="math inline">\(p = 0.5\)</span>에서 멀어질수록 검정력은 커진다. <span class="math inline">\(p = 1\)</span>일 때 검정력은 0이다.</p></li>
</ul>
<p>(2) 기각역을 <span class="math inline">\(RR = \{\sum x_{i} \geq 3\}\)</span></p>
<ul>
<li><p>1종 오류 : <span class="math inline">\(\alpha = P(\sum x_{i} \geq 5,\sum x_{i} \sim B(5,0.5)) = 0.5\)</span></p></li>
<li><p>2종 오류 : <span class="math inline">\(\beta(p) = P(\sum x_{i} \leq 4,\sum x_{i} \sim B(5,p &gt; 0.5))\)</span></p></li>
<li><p><span class="math inline">\(RR = \{\sum x_{i} = 5\}\)</span>에 비해 1종 오류는 늘었으나 2종 오류는 줄었다. 검정력은 커졌다. 즉, 1종 오류와 2종 오류를 동시에 줄이는 검정방법은 존재하지 않는다.</p></li>
</ul>
<p><strong>【최강 검정력】</strong> 확률표본의 영역을 <span class="math inline">\(\mathcal{S}\)</span>, 확률표본 영역의 부분 집합 <span class="math inline">\(RR \in \mathcal{S}\)</span>이라 하자. 다음 조건을 만족하는 <span class="math inline">\(RR\)</span>을 검정 크기 <span class="math inline">\(\alpha\)</span>에서 귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>, 대립가설 <span class="math inline">\(H_{1}:\theta = \theta_{1}\)</span>을 검정하는 최량 기각역 best critical region이다. <span class="math inline">\(\max_{\theta \in \omega_{0}}{P_{\theta}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR \right)} = \alpha\)</span></p>
<p>임의의 부분집합 <span class="math inline">\(A \in \mathcal{D}\)</span>에 대하여 다음이 성립한다.</p>
<p><span class="math inline">\(P_{\theta_{0}}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in A \right) = &gt; P_{\theta_{1}}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR \right) \geq P_{\theta_{1}}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in A \right)\)</span></p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(X \sim B(p = \theta)\)</span> 에서 귀무가설 <span class="math inline">\(H_{0}:p = 0.1\)</span>, 대립가설 <span class="math inline">\(H_{0}:p = 0.2\)</span> 가설을 검정하기 위하여 표본크기3인 확률표본을 추출한 결과는 <span class="math inline">\((1,0,0)\)</span> 이다.</p>
<ul>
<li><p>기각역을 <span class="math inline">\(RR = \{ T(\overline{x});\sum X_{i} \geq 1\}\)</span>이라 하자. <span class="math inline">\(\sum X_{i} \sim B(n = 3,p)\)</span>분포를 따른다.</p></li>
<li><p>유의수준: <span class="math inline">\({P_{p = 0.1}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR \right)}{= 0.243 + 0.027 + 0.001 = 0.271}\)</span></p></li>
<li><p>2종 오류: <span class="math inline">\({P_{p = 0.2}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR^{C} \right)}{= 0.5121}\)</span></p></li>
<li><p>검정력 : <span class="math inline">\(1 - 0.5121 = 0.4879\)</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 41%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math display">\[\sum x\]</span></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">\[f(x;p = 0.1)\]</span></td>
<td style="text-align: center;">0.729</td>
<td style="text-align: center;">0.243</td>
<td style="text-align: center;">0.027</td>
<td style="text-align: center;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math display">\[f(x;p = 0.2)\]</span></td>
<td style="text-align: center;">0.512</td>
<td style="text-align: center;">0.384</td>
<td style="text-align: center;">0.096</td>
<td style="text-align: center;">0.008</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">\[\frac{f(x;p = 0.1)}{f(x;p = 0.2)}\]</span></td>
<td style="text-align: center;">1.424</td>
<td style="text-align: center;">0.633</td>
<td style="text-align: center;">0.281</td>
<td style="text-align: center;">0.125</td>
</tr>
</tbody>
</table></li>
</ul>
<p>만약 대립가설의 모수 하나의 값(대립가설은 귀무가설과는 달리 모수의 영역이다)을 <span class="math inline">\(\theta_{1}\)</span>라 한다면 검정력은 <span class="math inline">\({P(\theta) = P}_{\theta}\left( T\left( X_{1},X_{2},\ldots,X_{n} \right) \in RR^{C}|\theta = \theta_{1} \right)\)</span>이고 2종오류는 <span class="math inline">\(\beta(\theta) = 1 - P(\theta)\)</span> 이다. <span class="math inline">\(H_{0}:\theta = \theta_{0}vs.H_{1}:\theta = \theta_{1} \neq \theta_{0}\)</span> 가설검정의 경우 전형적인 검정력 함수는 다음과 같다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/검정력함수.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>검정력은 귀무가설 단일 설정 값 <span class="math inline">\(\theta_{0}\)</span>에서 최저였다가 멀어질수록 증가한다. 그러므로 유의수준 <span class="math inline">\(\alpha\)</span>을 설정하고 2종 오류를 최소화할 수 있는 검정 방법(기각역 찾음)을 찾는다.</p>
<p><strong>【most powerful test 최강력 검정법】</strong></p>
<p>가설에 설정된 모수 값이 하나인 경우 이를 단순가설이라 하고 설정된 모수가 영역인 경우 이를 복합가설이라 한다. 단순 귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>와 단순 대립가설 <span class="math inline">\(H_{1}:\theta = \theta_{1}\)</span>을 검정한다고 하자. 모수 영역은 <span class="math inline">\(\Omega = \{\theta;\theta_{0},\theta_{1}\}\)</span>이고 <span class="math inline">\(P(\theta) = \alpha\)</span>인 기각역을 설정하고 <span class="math inline">\(\beta(\theta) = 1 - p(\theta)\)</span> 을 최소화 하는 기각역을 구한다. 이는 <span class="math inline">\(P(\theta_{1})\)</span>을 최대화 하는 최강 검정력 검정 most powerful test을 찾는 것과 동일하다.</p>
<p><strong>【Neyman-Pearson Lemma】</strong> 단순 귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>와 단순 대립가설 <span class="math inline">\(H_{1}:\theta = \theta_{1}\)</span>을 검정한다고 하자. 가설 검정을 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span>으로부터 구한 통계량을 이용한다. 이 통계량의 확률밀도함수(샘플링 분포)는 모수 <span class="math inline">\(\theta\)</span>의 함수이며 이를 우도 함수 <span class="math inline">\(L(\overline{x};\theta)\)</span>라 한다. 유의수준 <span class="math inline">\(\alpha\)</span> 하에서 검정력을 최대화 하는 기각역 <span class="math inline">\(RR\)</span>은 다음에 의해 정해진다. 이렇게 얻은 검정 방법(기각역)을 최강력 검정법이라 한다.</p>
<p><span class="math inline">\(\frac{L({\overline{x};\theta}_{0})}{L({\overline{x};\theta}_{1})} \leq k,for\overline{x} \in RR\)</span>.</p>
<p><span class="math inline">\(\frac{L({\overline{x};\theta}_{0})}{L({\overline{x};\theta}_{1})} \geq k,for\overline{x} \in RR^{C}\)</span>.</p>
<p><span class="math display">\[{{\alpha = P}_{H}}_{0}(\overline{x} \in RR)\]</span></p>
<p><strong>【불편 검정방법】</strong> 모집단 <span class="math inline">\(X \sim f(x;\theta),\theta \in \Omega\)</span> 에서 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span>, 기각역은 <span class="math inline">\({{\alpha = P}_{H}}_{0}(\overline{x} \in RR)\)</span>이라 하면 다음을 불편 unbiased 검정방법이다. <span class="math inline">\(P_{\theta}\left( \overline{X} \in RR \right) \geq \alpha,forall\theta \in \omega_{1}\)</span></p>
<p><strong>【예제】</strong> 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right) \sim f(x;\theta = \mu)\sim N(\mu,1)\)</span>이고 귀무가설 <span class="math inline">\(H_{0}:\mu = 0\)</span>, 대립가설 <span class="math inline">\(H_{0}:\mu = 1\)</span> 검정하는 최강 기각역을 구하라.</p>
<p>N-P Lemma 의해 최강 기각역 : <span class="math inline">\(\frac{L({\overline{x};\theta}_{0} = 0)}{L({\overline{x};\theta}_{1} = 1)} = \frac{N(0,1)}{N(1,1)} = \exp\left( - \sum x_{i} + \frac{n}{2} \right) \leq k\)</span> <span class="math display">\[\Leftrightarrow - \sum x_{i} + \frac{n}{2} \leq \ln(k) \Leftrightarrow \sum x_{i} &gt; - \frac{n}{2} - \ln{(k) \Leftrightarrow}\frac{\sum x_{i}}{n} &gt; c\]</span></p>
<p>그러므로 최강 기각역은 <span class="math inline">\(RR = \left\{ \left( x_{1},x_{2},\ldots,x_{n} \right);\overline{x} \geq c \right\},\overline{x} \sim N(0,\frac{1}{n})\)</span>.</p>
<p>유의수준 <span class="math inline">\(\alpha\)</span> 임계값 critical value, <span class="math inline">\(c_{1}\)</span> 결정 : <span class="math inline">\({P_{H}}_{0}\left( \overline{x} \geq c \middle| \mu = 0 \right) = \int_{c}^{\infty}{\frac{1}{\sqrt{2\pi}\sqrt{1/n}}\exp\left( - \frac{\left( \overset{¯}{x} - 0 \right)^{2}}{2(1/n)} \right)d\overset{¯}{x}} = \alpha\)</span>을 만족하는 <span class="math inline">\(c\)</span> 값을 기각역의 시작 값인 임계값 <span class="math inline">\(c_{1}\)</span>이다.</p>
<p>검정력: <span class="math inline">\({P_{H}}_{1}\left( \overline{x} \geq c_{1} \middle| \mu = 1 \right) = \int_{c_{1}}^{\infty}{\frac{1}{\sqrt{2\pi}\sqrt{1/n}}\exp\left( - \frac{\left( \overset{¯}{x} - 1 \right)^{2}}{2(1/n)} \right)d\overset{¯}{x}}\)</span></p>
<p><strong>【예제】</strong> 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right) \sim f(x)\)</span>이고 귀무가설, 대립가설이 아래와 같이 확률분포함수인 경우 최강 기각역을 구하라.</p>
<ul>
<li><p>귀무가설: <span class="math inline">\(H_{0}:f_{0}(x) = \frac{e^{- 1}}{x!}\sim Poisson(\lambda = 1),x = 0,1,2,\ldots\)</span></p></li>
<li><p>대립가설: <span class="math inline">\(H_{1}:f_{1}(x) = \left( \frac{1}{2} \right)^{x + 1},x = 0,1,2,\ldots\)</span></p></li>
</ul>
<p>우도비 : <span class="math inline">\(\frac{f_{0}(x)}{f_{1}(x)} = \frac{\left( 2e^{- 1} \right)^{n}2^{\sum x_{i}}}{\Pi x_{i}!}\)</span></p>
<p>최강 기각역 : <span class="math inline">\(\frac{\left( 2e^{- 1} \right)^{n}2^{\sum x_{i}}}{\Pi x_{i}!} \leq k \Leftrightarrow \left( \sum x_{i} \right)\ln(2) - \ln\left( \Pi x_{i}! \right) \leq ln)k) - nln(2e^{- 1}) = c\)</span></p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim B(p),x = 0,1\)</span>에서 모수 <span class="math inline">\(\theta = p\)</span>에 대한 가설 검정을 위하여 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 을 추출하였다. 귀무가설 <span class="math inline">\(H_{0}:p_{0} = 0.5\)</span>, 대립가설 <span class="math inline">\(H_{1}:p_{1} = 0.1\)</span>을 유의수준 0.05에서 검정하는 최강 검정방법을 찾아라.</p>
<p>N-P Lemma에 의해 <span class="math inline">\(\frac{L\left( \overline{x}{;\theta}_{0} \right)}{L\left( \overline{x}{;\theta}_{1} \right)} = \frac{{0.5}^{\sum x_{i}}{0.5}^{n - \sum x_{i}}}{{0.2}^{\sum x_{i}}{0.8}^{n - \sum x_{i}}} \leq k \Leftrightarrow \sum x_{i} \leq c\)</span> 이 일양 최강 기각역이다.</p>
<p><span class="math inline">\(\sum x_{i} \sim B(n,p)\)</span>이므로 <span class="math inline">\(0.05 = P(\sum x_{i} \leq c|\sum x_{i} \sim B(n,0.5))\)</span>을 만족하는 정수 <span class="math inline">\(c\)</span>를 찾을 수 없다. 앞에서 살펴본 랜덤화 검정방법을 이용하여 검정하면 된다.</p>
</section>
<section id="일양-최강-검정" class="level5">
<h5 class="anchored" data-anchor-id="일양-최강-검정">(2) 일양 최강 검정</h5>
<p><strong>【일양 최강 검정법】</strong> 귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>, 단순 대립가설 <span class="math inline">\(H_{1}:\theta = \theta_{1} &lt; \theta_{0}\)</span>의 최강 검정 기각역 <span class="math inline">\(RR\)</span>이 모든 복합 대립가설 <span class="math inline">\(H_{1}:\theta = \theta_{1} &lt; \theta_{0}\)</span>의 최강 기각역이면 <span class="math inline">\(RR\)</span>에 의한 검정방법을 일양 최강 검정법 uniformly most powerful test 이라 한다.</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) = \frac{1}{\theta}e^{- x/\theta},x &gt; 0\)</span>에서 모수 <span class="math inline">\(\theta\)</span>에 대한 가설 검정을 위하여 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 을 추출하였다. 귀무가설 <span class="math inline">\(H_{0}:{\theta = \theta}_{0}\)</span> 대립가설 <span class="math inline">\(H_{1}:{\theta = \theta}_{1} &lt; \theta_{0}\)</span>을 유의수준 <span class="math inline">\(\alpha\)</span>에서 검정하는 일양 최강 검정방법을 찾아라.</p>
<p>N-P Lemma에 의해 <span class="math inline">\(\frac{L\left( \overline{x}{;\theta}_{0} \right)}{L\left( \overline{x}{;\theta}_{1} \right)} = \frac{\frac{1}{\theta_{0}^{n}}e^{- \frac{\sum x}{\theta_{0}}}}{\frac{1}{\theta_{1}^{n}}e^{- \frac{\sum x}{\theta_{1}}}} \leq k \Leftrightarrow \sum x_{i} \leq c\)</span> 이 일양 최강 기각역이다. <span class="math inline">\(RR = \{\sum x_{i} \leq c\}\)</span> 이 UMPT 기각역이다. 항상 기각역에 사용되는 통계량의 분포는 알려져 있어야 가능하다. <span class="math inline">\(\sum x_{i} \sim Gamma(n,\theta)\)</span>. 임계값은 <span class="math inline">\(0.05 = P(\sum x_{i} \geq c|\sum x_{i} \sim Gamma(n,\theta_{0}))\)</span>을 만족하는 <span class="math inline">\(c\)</span>값이다.</p>
<p>동일한 방법으로 귀무가설 <span class="math inline">\(H_{0}:{\theta = \theta}_{0}\)</span> 대립가설 <span class="math inline">\(H_{1}:{\theta = \theta}_{1} &gt; \theta_{0}\)</span>을 유의수준 <span class="math inline">\(\alpha\)</span>에서 검정하는 일양 최강 검정력은 <span class="math inline">\(RR = \{\sum x_{i} \geq c|\sum x_{i} \sim Gamma(n,\theta)\}\)</span>.</p>
<p>그러나 대립가설 <span class="math inline">\(H_{0}:{\theta = \theta}_{1} \neq \theta_{0}\)</span>이면 Uniformly Most Powerful Test는 존재하지 않는다.</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim N(0,\theta)\)</span>에서 모수 <span class="math inline">\(\theta\)</span>(분산)에 대한 가설 검정을 위하여 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 을 추출하였다. 귀무가설 <span class="math inline">\(H_{0}:{\theta = \theta}_{0}\)</span> 대립가설 <span class="math inline">\(H_{1}:{\theta = \theta}_{1} &gt; \theta_{0}\)</span>을 유의수준 <span class="math inline">\(\alpha\)</span>에서 검정하는 일양 최강 검정방법을 찾아라.</p>
<p>N-P Lemma에 의해 <span class="math inline">\(\frac{L\left( \overline{x}{;\theta}_{0} \right)}{L\left( \overline{x}{;\theta}_{1} \right)} = \frac{\left( \frac{1}{2\pi\theta_{0}} \right)^{\frac{n}{2}}exp( - \frac{1}{2\theta_{0}}\sum x_{i}^{2})}{\left( \frac{1}{2\pi\theta_{1}} \right)^{\frac{n}{2}}exp( - \frac{1}{2\theta_{1}}\sum x_{i}^{2})} \leq k \Leftrightarrow \sum x_{i}^{2} \geq c\)</span>이 일양 최강 기각역이다.</p>
<p>그러나 <span class="math inline">\(\sum x_{i}^{2}\)</span>의 확률밀도함수는 알 수 없으므로 기각역에 사용되는 검정 통계량은 <span class="math inline">\(\frac{\sum x_{i}^{2}}{\theta_{0}} \sim \chi^{2}(n - 1)\)</span> 분포를 따르므로 <span class="math inline">\(\frac{\sum x_{i}^{2}}{\theta_{0}}\)</span>을 이용하는데 이 통계량을 주축 pivotal 검정 통계량이라 한다.</p>
<p><strong>【단조우도비】</strong> 만약 우도비 <span class="math inline">\(\frac{L\left( \overline{x}{;\theta}_{0} \right)}{L\left( \overline{x}{;\theta}_{1} \right)},for\theta_{0} &lt; \theta_{1}\)</span>가 <span class="math inline">\(y = u(x)\)</span>의 단조 함수이면 우도함수 <span class="math inline">\(L\left( \overline{x};\theta \right)\)</span>은 통계량 <span class="math inline">\(y = u(x)\)</span>의 단조 우도비 monotone likelihood ratio(mlr)을 갖는다.</p>
<p><span class="math inline">\(\frac{L\left( \overline{x}{;\theta}_{0} \right)}{L\left( \overline{x}{;\theta}_{1} \right)} \leq k \Leftrightarrow t\left( x_{1},x_{2},\ldots,x_{n} \right) \in RR\)</span>. <span class="math inline">\(\alpha = P_{\theta_{0}}(t\left( x_{1},x_{2},\ldots,x_{n} \right) \in RR)\)</span>을 만족하는 <span class="math inline">\(k\)</span>가 임계값이다.</p>
<p><span class="math inline">\(\frac{L\left( \overline{x}{;\theta}_{0} \right)}{L\left( \overline{x}{;\theta}_{1} \right)} = g(Y) \leq k \Leftrightarrow Y \geq g^{- 1}(k)\)</span>. <span class="math inline">\(g^{- 1}(k)\)</span>는 <span class="math inline">\(\alpha = P_{\theta_{0}}(Y \geq g^{- 1}(k))\)</span>을 만족한다.</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim B(\theta = p),0 &lt; \theta &lt; 1\)</span>에서 모수 <span class="math inline">\(\theta\)</span>에 대한 가설 검정을 위하여 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 을 추출하였다. 귀무가설 <span class="math inline">\(H_{0}:{\theta = \theta}_{0}\)</span> 대립가설 <span class="math inline">\(H_{1}:{\theta = \theta}_{1} &gt; \theta_{0}\)</span>을 유의수준 <span class="math inline">\(\alpha\)</span>에서 검정하는 일양 최강 검정방법을 찾아라.</p>
<p><span class="math inline">\(\frac{L\left( \overline{x}{;\theta}_{0} \right)}{L\left( \overline{x}{;\theta}_{1} \right)} = \frac{{\theta_{0}}^{\sum x_{i}}{\theta_{0}}^{n - \sum x_{i}}}{{\theta_{1}}^{\sum x_{i}}{\theta_{1}}^{n - \sum x_{i}}} = \left( \frac{\theta_{0}(1 - \theta_{1})}{\theta_{1}(1 - \theta_{0})} \right)^{\sum x_{i}}\left( \frac{1 - \theta_{0}}{1 - \theta_{1}} \right)^{n}\)</span>이므로 우도비는<span class="math inline">\(y = \sum x_{i}\)</span>의 단조 함수이다. 그러므로 UMPT 기각역은 <span class="math inline">\(RR = \{\sum x_{i} \geq c\}\)</span>이다.</p>
<p><strong>【지수족 UMPT】</strong></p>
<p>모집단 확률밀도함수가 지수족이면 다음 가설의 일양 최강 검정 기각역은 <span class="math inline">\(RR = \{ y = \sum K\left( x_{i} \right) \geq c\}\)</span>이다.</p>
<p>귀무가설 : <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span> vs.&nbsp;대립가설 : <span class="math inline">\(H_{1}:\theta = \theta_{1} &gt; \theta_{0}\)</span></p>
<p>만약 대립가설 : <span class="math inline">\(H_{1}:\theta = \theta_{1} &lt; \theta_{0}\)</span> 이면 일양 최강 검정 기각역은 <span class="math inline">\(RR = \{ y = \sum K\left( x_{i} \right) \leq c\}\)</span>이다.</p>
</section>
<section id="우도비-검정" class="level5">
<h5 class="anchored" data-anchor-id="우도비-검정">(3) 우도비 검정</h5>
<p>단순 귀무가설과 단순 대립가설에 대한 Most powerful test을 얻으려면 Neyman-Pearson 정리를 이용하면 된다. 물론 대립가설이 단측 가설(한 쪽 방향)에 Most powerful 검정을 얻을 수 있지만… 양측 검정이나 Nuisance parameter가 있는 경우에는 N-P 정리를 사용할 수 없다.</p>
<p>모수 θ 영역을 <span class="math inline">\(\Omega\)</span>라 하자. 귀무가설에 설정된 모수 값은 단일 값으로 <span class="math inline">\(\Omega_{0} = \{\theta_{0}\}\)</span>이고 대립가설의 모수 공간은 <span class="math inline">\(\Omega_{1} = \Omega_{0}^{C}\)</span>이다. 전체 모수 공간 <span class="math inline">\(\Omega\)</span>에서 우도함수를 <span class="math inline">\(L\left( \overline{x};\Omega \right)\)</span>라 정의하고 모수에 대한 MLE(최대우도추정량)을 추정치로 사용한 우도함수를 <span class="math inline">\(L\left( \overline{x};\overset{\hat{}}{\Omega} \right)\)</span>라 하자.</p>
<p><strong>【우도비 검정】</strong> 귀무가설 <span class="math inline">\(H_{0}:\theta \in \Omega_{0}\)</span>, 대립가설 <span class="math inline">\(H_{1}:\theta \in \Omega_{0}^{C}\)</span> 검정하는 우도 통계량은 <span class="math inline">\(\lambda\left( \overline{x} \right) = \frac{\max_{\Omega_{0}}{L\left( \overline{x};\Omega_{0} \right)}}{\max_{\Omega}{L\left( \overline{x};\Omega \right)}}\)</span>이다. 우도비 검정 likelihood ratio test 기각역은 <span class="math inline">\(\left\{ \lambda\left( \overline{x} \right) \leq c \right\}\)</span>이다. <span class="math inline">\(c\)</span>는 <span class="math inline">\(0 &lt; c &lt; 1\)</span>의 값을 갖는다.</p>
<p>만약 <span class="math inline">\(\lambda \rightarrow 0\)</span>이면 귀무가설 하의 우도함수 값이 매우 작다는 것을 의미하므로 대립가설에 비해 귀무가설을 기각하는 것이 적절하다. 만약 <span class="math inline">\(\lambda \rightarrow 1\)</span>이면 귀무가설이 진실일 가능성이 높다. 그러므로 기각역이 <span class="math inline">\(\lambda \leq c\)</span> 이다.</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim N(\mu,\sigma^{2})\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 을 추출하였다. 모분산 <span class="math inline">\(\sigma^{2}\)</span>을 알지 못할 때 nuisance parameter 귀무가설 <span class="math inline">\(H_{0}:\mu = \mu_{0}\)</span>와 대립가설 <span class="math inline">\(H_{1}:\mu = \mu_{1} &gt; \mu_{0}\)</span>을 유의수준 <span class="math inline">\(\alpha\)</span>에서 우도비 검정방법을 찾으시오.</p>
<p>귀무가설 하 모수 공간은 <span class="math inline">\(\Omega_{0} = \{\mu,\sigma_{0};\mu = \mu_{0},\sigma^{2} &gt; 0\}\)</span>, 대립가설 하에서 모수 공간은 <span class="math inline">\(\Omega_{1} = \{\mu,\sigma_{1};\mu &gt; \mu_{0},\sigma_{1}^{2} &gt; 0\}\)</span>이므로 모수 전체 공간은 <span class="math inline">\(\Omega = \{\mu,\sigma;\mu \geq \mu_{0},\sigma^{2} &gt; 0\}\)</span>이다.</p>
<p><span class="math inline">\(L\left( \overline{x};\Omega_{0} \right) = \Pi\frac{1}{\sqrt{2\pi}\sigma}exp( - \frac{\left( x_{i} - \mu_{0} \right)^{2}}{2\sigma^{2}})\)</span>이고 귀무가설 모평균은 <span class="math inline">\(\mu_{0}\)</span>로 주어져 있으니 모분산에 대한 MLE 추정치를 구하면 <span class="math inline">\(\overset{\hat{}}{\sigma_{0}^{2}} = \frac{1}{n}\sum\left( x_{i} - \mu_{0} \right)^{2}\)</span>이다.</p>
<p><span class="math inline">\(L\left( \overline{x};\Omega \right)\)</span>에서 <span class="math inline">\(\mu\)</span>의 MLE는 <span class="math inline">\(\overset{\hat{}}{\mu} = max(\overset{¯}{x},\mu_{0})\)</span>이다. 왜냐하면 모수 공간 <span class="math inline">\(\Omega\)</span>의 <span class="math inline">\(\mu \geq \mu_{0}\)</span>이기 때문이다. 모분산에 대한 MLE 추정치는 <span class="math inline">\(\overset{\hat{}}{\sigma} = \frac{1}{n}\sum\left( x_{i} - \overset{\hat{}}{\mu} \right)^{2}\)</span>이다.</p>
<p><span class="math inline">\(\lambda = \frac{L(\overset{\hat{}}{\Omega_{0}})}{L(\overset{\hat{}}{\Omega})} = \left( \frac{\overset{\hat{}}{\sigma_{0}^{2}}}{\overset{\hat{}}{\sigma^{2}}} \right)^{\frac{n}{2}} = \left\{ \begin{array}{r}
\left( \frac{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}{\sum\left( x_{i} - \mu_{0} \right)^{2}} \right)^{\frac{n}{2}} \\
1,if\overline{x} \leq \mu_{0}
\end{array},if\overline{x} &gt; \mu_{0} \right.\ \)</span> .</p>
<p><span class="math inline">\(\sum\left( x_{i} - \mu_{0} \right)^{2} = \sum\left( x_{i} - \overset{¯}{x} \right)^{2} + \sum\left( \overset{¯}{x} - \mu_{0} \right)^{2}\)</span> 이므로 정리하면</p>
<p><span class="math display">\[\lambda = \left( \frac{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}{\sum\left( x_{i} - \mu_{0} \right)^{2}} \right)^{\frac{n}{2}} \leq k \Leftrightarrow \frac{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}{\sum\left( x_{i} - \mu_{0} \right)^{2}} \leq k^{\frac{2}{n}} \Leftrightarrow \frac{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2} + \sum\left( \overset{¯}{x} - \mu_{0} \right)^{2}} \leq k^{\frac{2}{n}}\]</span></p>
<p><span class="math display">\[\Rightarrow \frac{\sqrt{n}(\overset{¯}{x} - \mu_{0})}{S} &gt; c,whereS^{2} = \sum\left( x_{i} - \overset{¯}{x} \right)^{2}/(n - 1)\]</span></p>
<p><span class="math inline">\(\frac{\sqrt{n}(\overset{¯}{x} - \mu_{0})}{S}\)</span>은 t-분포를 따르므로 우도비 검정은 t-검정과 일치한다.</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) = e^{- (x - \theta)},x \geq 0\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span>을 추출하였다. 귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>와 대립가설 <span class="math inline">\(H_{1}:\theta &gt; \theta_{0}\)</span>을 유의수준 <span class="math inline">\(\alpha\)</span>에서 우도비 검정방법을 찾으시오.</p>
<p>우도 함수는 <span class="math inline">\(L\left( \overline{x};\theta \right) = \Pi e^{- (x - \theta)} = e^{- \sum(x_{i} - \theta)},\theta \leq x_{(1)}\)</span>이므로 우도 함수는 모수 <span class="math inline">\(\theta\)</span>의 증가함수이다.</p>
<p><span class="math inline">\(\lambda = \frac{L(\overset{\hat{}}{\Omega_{0}})}{L(\overset{\hat{}}{\Omega})} = \frac{e^{- \sum(x_{i} - \theta_{0})}}{e^{- \sum(x_{i} - x_{(1)})}} = \left\{ \begin{array}{r}
e^{- n\left( x_{(1)} - \theta_{0} \right)},ifx_{(1)} &gt; \theta_{0} \\
1,ifx_{(1)} \leq \theta_{0}
\end{array} \right.\ \)</span></p>
<p>기각역 <span class="math inline">\(\{\lambda \leq k\} \Leftrightarrow \{\overline{x};x_{(1)} \geq \theta_{0} - \frac{ln(c)}{n}\}\)</span></p>
<p>일반적으로 우도비 검정의 경우 검정통계량의 분포를 아는 것은 쉽지 않다. 이런 경우 다음 정리를 이용하여 검정하게 된다.</p>
<p><strong>【정리】</strong> <span class="math inline">\(\lambda = \frac{L(\overset{\hat{}}{\Omega_{0}})}{L(\overset{\hat{}}{\Omega})}\)</span>라 정의하자. 표본의 크기 <span class="math inline">\(n\)</span>이 충분히 크다면 귀무가설 <span class="math inline">\(H_{0}:\theta \in \Omega_{0}\)</span>, 대립가설 <span class="math inline">\(H_{1}:\theta \in \Omega_{1}\)</span>에 대한 우도비(LTR) 검정은 검정통계량 <span class="math inline">\(\lambda\)</span>에 대해 다음이 성립한다.</p>
<p><span class="math inline">\(- 2\ln(\lambda) \sim (app)\chi^{2}(r_{0} - r)\)</span>, <span class="math inline">\(r\)</span>은 모수 공간 <span class="math inline">\(\Omega\)</span>하에서 설정된 모수의 개수이고 <span class="math inline">\(r_{0}\)</span>은 모수 공간 <span class="math inline">\(\Omega_{0}\)</span> 하에서 설정된 모수의 개수이다.</p>
<p><strong>【예제】</strong> 작업 라인이 2개 있다. 각 작업을 일주일 단위로 생산된 제품에 대한 불량 개수를 조사하였더니 작업라인1은 평균 20, 작업라인 2는 22이다(표본의 개수는 각각 100이다). 불량 개수는 포아송 분포를 따르고 작업 라인 1의 평균을 <span class="math inline">\(\lambda_{1}\)</span>, 작업 라인 2의 평균을 <span class="math inline">\(\lambda_{2}\)</span>라 하자. 귀무가설 <span class="math inline">\(H_{0}:\lambda_{1} = \lambda_{2}\)</span>와 대립가설 <span class="math inline">\(H_{0}:\lambda_{1} \neq \lambda_{2}\)</span>을 검정하는 우도비 검정을 유의수준 0.01에서 실시하자.</p>
<p>작업라인 1의 확률표본을 <span class="math inline">\((X_{1},X_{2},...,X_{n})\)</span>, 작업라인 2의 확률표본을 <span class="math inline">\((Y_{1},Y_{2},...,y_{n})\)</span>라 하자.</p>
<p>귀무가설 모수 공간은 <span class="math inline">\(\Omega_{0} = \{\lambda_{1} = \lambda_{2} = \lambda\}\)</span>이고 전체 모수 공간은 <span class="math inline">\(\Omega = \{\lambda_{1} = \lambda_{2} &gt; 0\}\)</span>이다.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/우도비 예제.png" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:70.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/우도비 예제02.png" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:70.0%"></p>
</figure>
</div>
<p>귀무가설에서 설정된 귀무가설의 수는 1이고 전체 모수의 수는 2이다. 그러므로 <span class="math inline">\(- 2ln\lambda \sim \chi^{2}(df = 2 - 1 = 1)\)</span>이 성립한다. 자유도 1이고 유의수준이 0.01인 경우 기각치(임계치)는 <span class="math inline">\(\chi^{2}\)</span>-분포표에 의해 6.635이다. 9.53이 기각역에 속하므로 귀무가설은 기각된다.</p>
</section>
</section>
</section>
<section id="chapter-2.-구간-추정" class="level3">
<h3 class="anchored" data-anchor-id="chapter-2.-구간-추정"><span style="color:green">chapter 2. 구간 추정</span></h3>
<p>앞에서는 모수 <span class="math inline">\(\theta\)</span>의 점 추정에 대해 논의했는데 <span class="math inline">\(\theta\)</span>의 값을 하나의 추정치로 추측하는 것입니다. 여기서는 구간 추정 및 더 일반적으로 집합 추정에 대해 논의한다. 집합 추정 문제에서의 추론은 <span class="math inline">\(\theta\)</span>이 구간 <span class="math inline">\(C(\overline{x})\)</span>에 속한다."라는 추정됩니다. 즉, <span class="math inline">\(P\left( \overset{\hat{}}{\theta} = \theta \right) = 0\)</span>(점 추정차와 모수가 같을 확률은 0이지만 <span class="math inline">\(P(\theta \in C(\overline{x}))\)</span>는 0보다 큰 확률을 가지게 되는데 이를 신뢰수준이라 한다.</p>
<section id="구간추정" class="level4">
<h4 class="anchored" data-anchor-id="구간추정"><span style="color:blue">1. 구간추정</span></h4>
<p><strong>【구간 추정량】</strong></p>
<p>모집단 <span class="math inline">\(f(x;\theta),\overline{x} \in \mathcal{S}\)</span>에서 모수 <span class="math inline">\(\theta\)</span> 추론을 위하여 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span>을 추출하였다. 확률표본의 함수, 통계량 <span class="math inline">\(L\left( \overline{x} \right) \leq U\left( \overline{x} \right)\)</span>을 정의하자. <span class="math inline">\((L\left( \overline{x} \right),U\left( \overline{x} \right))\)</span>을 모수 <span class="math inline">\(\theta\)</span> 구간 추정량 interval estimator 이라 한다.</p>
<p>그리고 <span class="math inline">\(\min_{\theta}{P_{\theta}(\theta \in (L\left( \overline{x} \right),U\left( \overline{x} \right)))}\)</span>을 신뢰수준이라 한다. 좌우 대칭인 분포의 경우에는 양쪽 꼬리 부분에 동일한 확률 값을 배분해야 동일 신뢰수준 하에서 신뢰구간 폭이 가장 작아진다(정도는 높아짐).</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim N(\mu,1)\)</span>에서 모수 <span class="math inline">\(\theta\)</span> 추론을 위하여 표본 크기 2인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2} \right)\)</span> 추출하였다. 모수 <span class="math inline">\(\theta\)</span>에 대한 신뢰구간을 구하라.</p>
<p>모수 <span class="math inline">\(\theta\)</span>의 MVUE가 <span class="math inline">\(\overset{¯}{X}\)</span>이므로 <span class="math inline">\((\overset{¯}{X} - 1,\overset{¯}{X} + 2)\)</span> 신뢰구간 중 하나이다. 신뢰수준 : 91.9% <span class="math inline">\(P\left( \overset{¯}{X} - 1 \leq \mu \leq \overset{¯}{X} + 2 \middle| \overset{¯}{X} \sim N\left( \mu,\frac{1}{2} \right) \right) = P\left( - \frac{2}{\sqrt{1/2}} \leq z = \frac{\overset{¯}{X} - \mu}{\sqrt{1/2}} \leq \frac{1}{\sqrt{1/2}} \right) = P\left( - 2\sqrt{2} \leq z \leq \sqrt{2} \right) = 0.921 - 0.002 = 0.919\)</span></p>
<p><strong>【comment】</strong></p>
<ol type="1">
<li><p>유의수준 <span class="math inline">\(\alpha\)</span>의 양측 대립가설 검정방법과 신뢰수준 <span class="math inline">\(100(1 - \alpha)\%\)</span> 구간 추정은 동일하다.</p></li>
<li><p>앞에서 설명하였듯이 신뢰수준 <span class="math inline">\(100(1 - \alpha)\%\)</span> 구간의 의미는 신뢰수준 <span class="math inline">\(100(1 - \alpha)\%\)</span> 구간 내에 모수 <span class="math inline">\(\theta\)</span>가 있을 확률이 <span class="math inline">\(100(1 - \alpha)\%\)</span>이 아니라 100번의 신뢰구간을 구했을 때 <span class="math inline">\(100(1 - \alpha)\%\)</span>개 신뢰구간이 모수를 포함하고 있다는 것으로 신뢰구간의 모수 커버리지 coverage 확률이다.</p></li>
</ol>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim U(0,\theta)\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 추출하였다. 모수 <span class="math inline">\(\theta\)</span>에 대한 신뢰구간으로 다음 2개를 생각해 보자. 모수 <span class="math inline">\(\theta\)</span>의 MLE는 <span class="math inline">\(Y = x_{(n)}\)</span> 이다.</p>
<p><span class="math inline">\(Y = x_{(n)}\)</span> 확률밀도함수는 <span class="math inline">\(f(y) = ny^{n - 1}\left( \frac{1}{\theta} \right)^{n},0 &lt; y &lt; \theta\)</span> 이므로 변수변환 <span class="math inline">\(T = \frac{Y}{\theta}\)</span> 확률밀도함수는 <span class="math inline">\(f(t) = nt^{n - 1},0 &lt; y &lt; 1\)</span> 이다.</p>
<p>(1) 신뢰구간 <span class="math inline">\((aY,bY)\)</span>의 신뢰수준 : <span class="math inline">\(P_{\theta}(aY \leq \theta \leq bY) = P_{\theta}\left( \frac{1}{a} \leq T = \frac{Y}{\theta} \leq \frac{1}{b} \right) = \int_{\frac{1}{a}}^{\frac{1}{b}}{nt^{n - 1}dt} = \left( \frac{1}{a} \right)^{n} - \left( \frac{1}{b} \right)^{n}\)</span> 신뢰구간은 모수에 의존하지 않는다.</p>
<p>(2) 신뢰구간 <span class="math inline">\((Y + c,Y + d)\)</span>의 신뢰수준 : <span class="math inline">\(P_{\theta}(Y + c \leq \theta \leq Y + d) = P_{\theta}\left( 1 - \frac{d}{\theta} \leq T = \frac{Y}{\theta} \leq 1 - \frac{c}{\theta} \right) = \left( 1 - \frac{c}{\theta} \right)^{n} - \left( 1 - \frac{d}{\theta} \right)^{n}\)</span> 신뢰구간은 모수에 의존한다.</p>
<p><strong>【유의수준 <span class="math inline">\(\alpha\)</span> 가설검정과 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간은 동일하다.】</strong></p>
<p>모집단 <span class="math inline">\(f(x;\theta) \sim N(\mu,\sigma^{2})\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 추출하였다. 귀무가설 <span class="math inline">\(H_{0}:\mu = \mu_{0}\)</span>, 대립가설 <span class="math inline">\(H_{0}:\mu \neq \mu_{0}\)</span> UMPT 기각역은 <span class="math inline">\(RR = \{\overline{x};\left| \overline{x} - \mu_{0} \right| &gt; z_{1 - \frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}}\}\)</span>(유의수준 <span class="math inline">\(\alpha\)</span>)이다. 그러므로 채택역은 <span class="math inline">\(\left| \overline{x} - \mu_{0} \right| \leq z_{1 - \alpha/2}\frac{\sigma}{\sqrt{n}}\)</span>이다. 이것은 모수 <span class="math inline">\(\theta\)</span>에 대한 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간과 동일하다.</p>
<p><span class="math display">\[P\left( \overline{x} - z_{1 - \frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}} \leq \mu \leq \overline{x} + z_{1 - \frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}} \right) = 1 - \alpha\]</span></p>
<p>결론적으로 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간 포함된 모수 값을 (유의수준 <span class="math inline">\(\alpha\)</span>) 설정한 귀무가설은 채택하게 된다. 신뢰구간 밖의 모수를 설정한 귀무가설은 기각된다.</p>
<p><strong>【신뢰구간】</strong></p>
<p>귀무가설 <span class="math inline">\(H_{0}:\theta = \theta_{0}\)</span>에 대한 유의수준 <span class="math inline">\(\alpha\)</span>의 검정의 채택역을 <span class="math inline">\(A(\theta_{0})\)</span> 이라 하자. 모수 공간 <span class="math inline">\(C\left( \overline{x} \right) = \{\theta_{0}:\overline{x} \in A(\theta_{0})\}\)</span>은 <span class="math inline">\((1 - \alpha)\)</span> 신뢰구간이다.</p>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim exponetial(\theta = \lambda)\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 추출하였다. 모수 <span class="math inline">\(\lambda\)</span>(평균)에 대한 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간을 구하라.</p>
<p>귀무가설 : <span class="math inline">\(H_{0}:\lambda = \lambda_{0}\)</span> vs.&nbsp;대립가설 : <span class="math inline">\(H_{0}:\lambda \neq \lambda_{0}\)</span></p>
<p>우도함수 : <span class="math inline">\(L\left( \overline{x};\Omega \right) = \Pi\frac{1}{\lambda}\exp\left( - \frac{x_{i}}{\lambda} \right) = \frac{1}{\lambda^{n}}exp( - \frac{\sum x_{i}}{\lambda})\)</span></p>
<p>우도비 : <span class="math inline">\(\lambda = \frac{L(\overset{\hat{}}{\Omega_{0}})}{L(\overset{\hat{}}{\Omega})} = \frac{\frac{1}{\lambda_{0}^{n}}exp( - \frac{\sum x_{i}}{\lambda_{0}})}{\frac{1}{(\sum x_{i}/n)^{n}}exp( - n)} = \left( \frac{\sum x_{i}}{n\lambda_{0}} \right)^{n}e^{n}e^{- \sum x_{i}/\lambda_{0}}\)</span> (모수 <span class="math inline">\(\lambda\)</span>의 MLE는 <span class="math inline">\(\overset{¯}{x}\)</span> 이기 때문이다)</p>
<p>기각역 : <span class="math inline">\({\lambda = \left( \frac{\sum x_{i}}{n\lambda_{0}} \right)}^{n}e^{n}e^{- \sum x_{i}/\lambda_{0}} \leq k \Leftrightarrow {\lambda = \left( \frac{\sum x_{i}}{\lambda_{0}} \right)}^{n}e^{- \frac{\sum x_{i}}{\lambda_{0}}} \leq k^{*}\)</span>, <span class="math inline">\(RR(\overline{x}) = \{\overline{x};\left( \frac{\sum x_{i}}{\lambda_{0}} \right)^{n}e^{- \frac{\sum x_{i}}{\lambda_{0}}} \leq c\}\)</span></p>
<p>그러므로 채택역은 <span class="math inline">\(A(\theta) = \{\overline{x};\left( \frac{\sum x_{i}}{\lambda} \right)^{n}e^{- \frac{\sum x_{i}}{\lambda}} \geq c\}\)</span> 이고 충분통계량 <span class="math inline">\(\sum x_{i}\)</span>의 함수이므로 신뢰구간은 다음과 같다. <span class="math inline">\(C\left( \sum x_{i} \right) = \{\lambda;L\left( \sum x_{i} \right) &lt; \lambda &lt; U\left( \sum x_{i} \right)\}\)</span></p>
<p><span class="math inline">\(\left( \frac{\sum x_{i}}{L\left( \sum x_{i} \right)} \right)^{n}e^{- \frac{\sum x_{i}}{L\left( \sum x_{i} \right)}}\)</span>, <span class="math inline">\(\left( \frac{\sum x_{i}}{U\left( \sum x_{i} \right)} \right)^{n}e^{- \frac{\sum x_{i}}{U\left( \sum x_{i} \right)}}\)</span> =&gt; 만약 <span class="math inline">\(a = \frac{\sum x_{i}}{L\left( \sum x_{i} \right)},b = \frac{\sum x_{i}}{U\left( \sum x_{i} \right)}\)</span>라 놓으면 <span class="math inline">\(a^{n}e^{- a}\)</span>, <span class="math inline">\(be^{- b}\)</span></p>
<p><span class="math inline">\(\sum x_{i} \sim Gamma(n,\lambda)\)</span> 이므로 <span class="math inline">\(\frac{\sum x_{i}}{\lambda} \sim Gamma(n,1)\)</span> 다음을 만족하는 <span class="math inline">\((a,b)\)</span>를 찾으면 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간이다.</p>
<p><span class="math display">\[P_{\lambda}\left( \frac{\sum x_{i}}{a} \leq \lambda \leq \frac{\sum x_{i}}{b} \right) = P_{\lambda}\left( b \leq \frac{\sum x_{i}}{\lambda} \leq a \right) = 1 - \alpha\]</span></p>
<p><strong>【주축통계량】</strong></p>
<p>통계량 <span class="math inline">\(Q\left( \overline{x},\theta \right)\)</span>의 분포가 모수와 독립이면 이를 주축 pivotal 통계량이라 한다. 즉, <span class="math inline">\(X \sim F(x)\)</span>이면 <span class="math inline">\(Q\left( \overline{x},\theta \right)\)</span> 확률밀도함수는 모수 <span class="math inline">\(\theta\)</span>에 상관없이 동일하다. 일반적으로 주축 통계량은 충분 통계량의 함수이다.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 44%">
<col style="width: 21%">
<col style="width: 32%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">확률분포 형식</td>
<td style="text-align: center;">타입</td>
<td style="text-align: center;">주축 통계량</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math display">\[f(x - \mu)\]</span></td>
<td style="text-align: center;">위치</td>
<td style="text-align: center;"><span class="math display">\[\overline{x} - \mu\]</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math display">\[\frac{1}{\sigma}f(\frac{x}{\sigma})\]</span></td>
<td style="text-align: center;">크기</td>
<td style="text-align: center;"><span class="math display">\[\frac{\overline{x}}{S}\]</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math display">\[\frac{1}{\sigma}f(\frac{x - \mu}{\sigma})\]</span></td>
<td style="text-align: center;">위치-크기</td>
<td style="text-align: center;"><span class="math display">\[\frac{\overline{x} - \mu}{S}\]</span></td>
</tr>
</tbody>
</table>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim exponetial(\theta = \lambda)\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 추출하였다. 모수 <span class="math inline">\(\lambda\)</span>(평균)에 대한 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간을 구하라.</p>
<p>지수분포는 지수족이므로 <span class="math inline">\(T = \sum x_{i}\)</span>는 충분 통계량이고 <span class="math inline">\(T = \sum x_{i} \sim Gamma(n,\lambda))\)</span>이다.<span class="math inline">\(\sum x_{i}/\lambda \sim Gamma(1,\lambda))\)</span>이 주축 통계량이다. 그러므로 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간은 다음을 만족하는 <span class="math inline">\((a,b)\)</span>이다. <span class="math inline">\(P_{\lambda}\left( a \leq \frac{\sum x_{i}}{\lambda} \leq b \right) = 1 - \alpha\)</span>.</p>
<p><strong>【예제】</strong> <span class="math inline">\(f(x;\theta) \sim N\left( \theta = \mu,\sigma^{2} \right),where\sigma^{2}isknown\)</span>에서 표본 크기 <span class="math inline">\(n\)</span>인 확률표본 <span class="math inline">\(\left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 추출하였다. 모수 <span class="math inline">\(\mu\)</span>(평균)에 대한 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간을 구하라.</p>
<p>정규분포는 위치-크기 모수 타입이므로 주축 통계량은 <span class="math inline">\(\frac{\overline{x} - \mu}{S}\)</span> 형태이다. 만약 분산 <span class="math inline">\(\sigma^{2}\)</span>을 알고 있다면 <span class="math inline">\(P\left( a \leq \frac{\overline{x} - \mu}{\frac{\sigma}{\sqrt{n}}} \sim N(0,1) \leq b \right) = 1 - \alpha\)</span> =&gt; <span class="math inline">\((\overline{x} - z_{1 - \frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}},\overline{x} + z_{1 - \frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}})\)</span></p>
<p>만약 분산 <span class="math inline">\(\sigma^{2}\)</span>을 모른다면 <span class="math inline">\(P\left( a \leq \frac{\overline{x} - \mu}{\frac{s}{\sqrt{n}}} \sim t(n - 1) \leq b \right) = 1 - \alpha\)</span></p>
<p>=&gt; <span class="math inline">\((\overline{x} - t_{1 - \frac{\alpha}{2},n - 1}\frac{s}{\sqrt{n}},\overline{x} + t_{1 - \frac{\alpha}{2},n - 1}\frac{s}{\sqrt{n}})\)</span></p>
</section>
<section id="정규분포-가정-모형" class="level4">
<h4 class="anchored" data-anchor-id="정규분포-가정-모형"><span style="color:blue">2. 정규분포 가정 모형</span></h4>
<p>모집단 <span class="math inline">\(f(x;\theta)\)</span>에서 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span>의 제곱 변환 <span class="math inline">\(X_{i}^{2}\)</span>의 확률분포함수에 대하여 살펴보자. 모집단 <span class="math inline">\(f(x;\theta) \sim N(0,1)\)</span>이면 <span class="math inline">\(X^{2}\)</span>의 분포는 <span class="math inline">\(\chi^{2}(1)\)</span>을 따른다.</p>
<p><strong>【cochran theorem】</strong></p>
<p>모집단 <span class="math inline">\(f(x;\theta) \sim N(\mu,\sigma^{2})\)</span>에서의 확률표본 <span class="math inline">\(\overline{X} = \left( X_{1},X_{2},\ldots,X_{n} \right)\)</span> 의 제곱 형태 (이차형식, quadratic form) <span class="math inline">\(Q_{i}^{2},fori = 1,2,\ldots,k\)</span> 확률변수와 <span class="math inline">\({Q = \sum Q}_{i}^{2}\)</span> 확률변수에 대하여 다음이 성립한다.</p>
<ol type="1">
<li><p><span class="math inline">\(Q_{1},Q_{2},\ldots,Q_{k}\)</span>는 서로 독립이다.</p></li>
<li><p><span class="math inline">\(\frac{Q_{k}}{\sigma^{2}} \sim \chi^{2}(r_{k})\)</span>을 갖는다.</p></li>
<li><p><span class="math inline">\(\frac{Q}{\sigma^{2}} \sim \chi^{2}(\sum r_{i})\)</span>을 갖는다.</p></li>
</ol>
<p><strong>【예제】</strong> 모집단 <span class="math inline">\(f(x;\theta) \sim N\left( \mu,\sigma^{2} \right)\)</span>에서 확률표본 <span class="math inline">\(\left( X_{1},X_{2},\ldots,X_{n} \right)\)</span>의 분산 <span class="math inline">\(\sigma^{2}\)</span>의 MVUE 표본 분산 <span class="math inline">\(S^{2} = \frac{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}{n - 1}\)</span> 은 이차형식이다. <span class="math inline">\((n - 1)S^{2} = \sum\left( x_{i} - \overset{¯}{x} \right)^{2} \Leftrightarrow \frac{(n - 1)S^{2}}{\sigma^{2}} = \frac{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}{\sigma^{2}} = \frac{\sum\left( x_{i} - \mu \right)^{2}}{\sigma^{2}} - \frac{\sum\left( \overset{¯}{x} - \mu \right)^{2}}{\sigma^{2}}\)</span></p>
<p><span class="math inline">\(X_{i} \sim N\left( \mu,\sigma^{2} \right)\)</span> 이므로 <span class="math inline">\(Q_{i} = \frac{\left( X_{i} - \mu \right)^{2}}{\sigma^{2}} \sim \chi^{2}(1) = &gt; \sum Q_{i} = \frac{\sum\left( X_{i} - \mu \right)^{2}}{\sigma^{2}} \sim \chi^{2}(n)\)</span> 이다.</p>
<p><span class="math inline">\(\overset{¯}{X} \sim N\left( \mu,\frac{\sigma^{2}}{n} \right)\)</span> 이므로 <span class="math inline">\(Q_{1} = \frac{{n\left( \overset{¯}{X} - \mu \right)}^{2}}{\sigma^{2}} \sim \chi^{2}(1\)</span>) 이다. 그러므로 코크란 정리에 의해 <span class="math inline">\(\frac{(n - 1)S^{2}}{\sigma^{2}} \sim \chi^{2}(n - 1)\)</span>이다.</p>
<section id="분산분석" class="level5">
<h5 class="anchored" data-anchor-id="분산분석">(1) 분산분석</h5>
<ul>
<li><p>모델: <span class="math inline">\(X_{ij} = \mu_{i} + e_{ij};i = 1,2,\ldots,a,j = 1,2,\ldots,n\)</span></p></li>
<li><p>가정: <span class="math inline">\(e_{ij} \sim (iid)N(0,\sigma^{2})\)</span></p></li>
<li><p>모수: <span class="math inline">\(\Omega = \{\left( \mu_{1},\mu_{2},\ldots,\mu_{k},\sigma^{2} \right); - \infty &lt; \mu_{j} &lt; \infty,0 &lt; \sigma^{2} &lt; \infty\)</span></p></li>
<li><p>귀무가설 <span class="math inline">\(H_{0}:\mu_{1} = \mu_{2} = \ldots = \mu_{k} = \mu\)</span></p></li>
<li><p>귀무가설 모수: <span class="math inline">\(\Omega_{0} = \{\left( \mu_{1},\mu_{2},\ldots,\mu_{k},\sigma^{2} \right); - \infty &lt; \mu_{1} = \mu_{2} = \ldots = \mu_{k} = \mu &lt; \infty,0 &lt; \sigma^{2} &lt; \infty\)</span></p></li>
</ul>
<p><strong>【표본분산 분할】</strong></p>
<p>분산분석 모형에서 표본분산 <span class="math inline">\(S^{2} = \frac{1}{(an - 1)}\sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{..} \right)^{2}}\)</span>을 이차형식으로 분할하라. 단, <span class="math inline">\({\overset{¯}{x}}_{..} = \frac{\sum_{i}^{}{\sum_{j}^{}x_{ij}}}{an},{\overset{¯}{x}}_{i.} = \frac{\sum_{j}^{}x_{ij}}{n}\)</span>, <span class="math inline">\({\overset{¯}{x}}_{.j} = \frac{\sum_{i}^{}x_{ij}}{a}\)</span>이다.</p>
<p><span class="math inline">\({(an - 1)S}^{2} = \sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{..} \right)^{2}} = \sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{i.} \right)^{2}} + \sum_{i}^{}{\sum_{j}^{}\left( {\overset{¯}{x}}_{i.} - {\overset{¯}{x}}_{..} \right)^{2}}\)</span></p>
<p><span class="math inline">\(= \sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{i.} \right)^{2}} + n\sum_{i}^{}{\left( {\overset{¯}{x}}_{i.} - {\overset{¯}{x}}_{..} \right)^{2} = Q_{1} + Q_{2}}\)</span></p>
<p><span class="math inline">\({(an - 1)S}^{2} = \sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{..} \right)^{2}} = \sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{.j} \right)^{2}} + \sum_{i}^{}{\sum_{j}^{}\left( {\overset{¯}{x}}_{.j} - {\overset{¯}{x}}_{..} \right)^{2}}\)</span></p>
<p><span class="math inline">\(= \sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{.j} \right)^{2}} + a\sum_{j}^{}{\left( {\overset{¯}{x}}_{.j} - {\overset{¯}{x}}_{..} \right)^{2} = Q_{3} + Q_{4}}\)</span></p>
<p><span class="math display">\[{(an - 1)S}^{2} = a\sum_{j}^{}{\left( {\overset{¯}{x}}_{.j} - {\overset{¯}{x}}_{..} \right)^{2} +}n\sum_{i}^{}{\left( {\overset{¯}{x}}_{i.} - {\overset{¯}{x}}_{..} \right)^{2} +}\sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{i.} - {\overset{¯}{x}}_{.j} + {\overset{¯}{x}}_{..} \right)^{2}} = Q_{2} + Q_{3} + Q_{4}\]</span></p>
<p><strong>【우도비 검정】</strong></p>
<ul>
<li><p>분자 우도함수 : <span class="math inline">\(L\left( \Omega_{0} \right) = \left( \frac{1}{2\pi\sigma} \right)^{an/2}exp( - \frac{1}{2\sigma^{2}}\sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - \mu \right)^{2}})\)</span></p></li>
<li><p><span class="math inline">\(\mu\)</span> &nbsp;MLE : <span class="math inline">\(\frac{\partial L\left( \Omega_{0} \right)}{\partial\mu} = 0 \Rightarrow \overset{\hat{}}{\mu} = \frac{1}{an}\sum_{i}^{}{\sum_{j}^{}x_{ij} = {\overset{¯}{x}}_{..}}\)</span></p></li>
<li><p><span class="math inline">\(\sigma^{2}\)</span> &nbsp;MLE : <span class="math inline">\(\frac{\partial L\left( \Omega_{0} \right)}{\partial\sigma^{2}} = 0 \Rightarrow \overset{\hat{}}{\sigma^{2}} = \frac{1}{an}\sum_{i}^{}{\sum_{j}^{}{{(x}_{ij} - {\overset{¯}{x}}_{..})^{2}} = v}\)</span></p></li>
<li><p>분모 우도함수 : <span class="math inline">\(L(\Omega) = \left( \frac{1}{2\pi\sigma} \right)^{an/2}exp( - \frac{1}{2\sigma^{2}}\sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - \mu_{i} \right)^{2}})\)</span></p></li>
<li><p><span class="math inline">\(\mu_{i}\)</span> &nbsp;MLE : <span class="math inline">\(\frac{\partial L(\Omega)}{\partial\mu_{i}} = 0 \Rightarrow \overset{\hat{}}{\mu_{i}} = \frac{1}{n}\sum_{j}^{}{x_{ij} = {\overset{¯}{x}}_{i.}}\)</span></p></li>
<li><p><span class="math inline">\(\sigma^{2}\)</span> &nbsp;MLE : <span class="math inline">\(\frac{\partial L(\Omega)}{\partial\sigma^{2}} = 0 \Rightarrow \overset{\hat{}}{\sigma^{2}} = \frac{1}{an}\sum_{i}^{}{\sum_{j}^{}{{(x}_{ij} - {\overset{¯}{x}}_{..})^{2}} = w}\)</span></p></li>
<li><p>우도비 : <span class="math inline">\(\lambda = \frac{L\left( {\overset{\hat{}}{\Omega}}_{0} \right)}{L\left( \overset{\hat{}}{\Omega} \right)} = \left( \frac{\sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{i.} \right)^{2}}}{\sum_{i}^{}{\sum_{j}^{}\left( x_{ij} - {\overset{¯}{x}}_{..} \right)^{2}}} \right)^{an/2}\)</span>.</p></li>
<li><p>가정: <span class="math inline">\(e_{ij} \sim (iid)N(0,\sigma^{2})\)</span>에 의해 <span class="math inline">\(X_{ij} \sim (iid)N(\mu_{i},\sigma^{2})\)</span> 이다.</p></li>
</ul>
<p>그러므로 <span class="math inline">\(V = \frac{1}{an}\sum_{i}^{}{\sum_{j}^{}{{(x}_{ij} - {\overset{¯}{x}}_{..})^{2}} = \frac{Q}{an}}\)</span> 이고 <span class="math inline">\(W = \frac{1}{an}\sum_{i}^{}{\sum_{j}^{}{{(x}_{ij} - {\overset{¯}{x}}_{i.})^{2}} = \frac{Q_{3}}{an}}\)</span> 이다.</p>
<p>우도비: <span class="math inline">\(\lambda^{2/an} = \frac{Q_{3}}{Q_{3} + Q_{4}} = \frac{1}{1 + Q_{4}/Q_{3}}\)</span></p>
<p>귀무가설 검정 유의수준: <span class="math inline">\(\alpha = P_{H_{0}}\left( \frac{1}{1 + \frac{Q_{4}}{Q_{3}}} \leq \lambda^{\frac{2}{an}} \right) = P_{H_{0}}\left( \frac{Q_{4}/(a - 1)}{Q_{3}/a(n - 1)} \leq c \right)\)</span></p>
<p><span class="math inline">\(\frac{Q_{4}/(\sigma^{2}(a - 1))}{Q_{3}/(\sigma^{2}a(n - 1))} \sim F(a - 1,a(n - 1))\)</span>이다.</p>
<p>【ANOVA table】</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/anova table.png" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:80.0%"></p>
</figure>
</div>
</section>
<section id="회귀분석" class="level5">
<h5 class="anchored" data-anchor-id="회귀분석">(2) 회귀분석</h5>
<ul>
<li><p>모델 : <span class="math inline">\(Y_{i} = a + bx_{i} + e_{i};i = 1,2,\ldots,n\)</span></p></li>
<li><p>가정 : <span class="math inline">\(e_{i} \sim (iid)N(0,\sigma^{2})\)</span></p></li>
<li><p>귀무가설 <span class="math inline">\(H_{0}:\alpha = \beta = 0\)</span></p></li>
<li><p>대립가설 <span class="math inline">\(H_{1}:\alpha \ne \beta = 0\)</span></p></li>
</ul>
<p><strong>【OLS 최소자승추정법】</strong></p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/OLS추정산점도.png" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>관측점들을 가장 대표하는 직선 (best fit)을 어떻게 구할 것인가? 데이터 <span class="math inline">\((x_{i},y_{i})\)</span>를 활용하여 점들에 가장 적합한 직선의 회귀계수 <span class="math inline">\((a,b)\)</span>를 추정하고 이를 이용하여 목표변수 추정값을 <span class="math inline">\(\overset{\hat{}}{y_{i}} = \overset{\hat{}}{a} + \overset{\hat{}}{b}x_{i}\)</span> fitted value 구한다. 오차항에 대한 추정값으로 &nbsp;<span class="math inline">\({\overset{\hat{}}{e}}_{i} = y_{i} - \overset{\hat{}}{y_{i}}\)</span>을 사용하여 직선의 유의성을 검증한다.</p>
<p><span class="math inline">\(\min_{(a,b)}{Q = \sum_{i}^{}\left( y_{i} - a - bx_{i} \right)}^{2}\)</span>$$<span class="math inline">\(\frac{\partial Q}{\partial a} = - 2\sum\left( y_{i} - a - bx_{i} \right) = 0,\frac{\partial Q}{\partial b} = - 2\sum x_{i}\left( y_{i} - a - bx_{i} \right) = 0\)</span></p>
<p><span class="math inline">\(\overset{\hat{}}{b} = \frac{\sum\left( x_{i} - \overset{¯}{x} \right)\left( y_{i} - \overset{¯}{y} \right)}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}} = \frac{S_{XY}}{S_{XX}}\)</span>, <span class="math inline">\(\overset{\hat{}}{a} = \overset{¯}{y} - \overset{\hat{}}{b}\overset{¯}{x}\)</span></p>
<p><strong>【MLE】</strong></p>
<p><span class="math inline">\(e_{i} \sim (iid)N(0,\sigma^{2})\)</span> 이므로 <span class="math inline">\(y_{i} \sim (iid)N(a + bx_{i},\sigma^{2})\)</span> 이다.</p>
<p>우도함수: <span class="math inline">\(L\left( \overline{x};a,b \right) = \left( \frac{1}{2\pi\sigma} \right)^{\frac{n}{2}}exp( - \frac{{\sum_{i}^{}\left( y_{i} - a - bx_{i} \right)}^{2}}{2\sigma^{2}}) \propto {\sum_{i}^{}\left( y_{i} - a - bx_{i} \right)}^{2}\)</span>우도함수를 최대화 하는 것이나 <span class="math inline">\({\sum_{i}^{}\left( y_{i} - a - bx_{i} \right)}^{2}\)</span>을 최소화 하는 OLS와 동일하다.</p>
<p><strong>【OLS is blue】 markov theorem</strong></p>
<p>회귀계수에 대한 OLS 추정치는 BLUE(Best Linear Unbiased Estimator)이다. 즉 모든 선형, 불편 추정량 중 최소 분산(minimum variance)를 갖는다. 분포함수가 지수족이므로 MLE는 CSS이고 불편추정량이므로 Rao-Blackwell 정리에 의해 MVUE이다.</p>
<p><strong>【오차 분산 MVUE 추정량】</strong></p>
<p><span class="math inline">\(\overset{\hat{}}{\sigma^{2}} = \frac{1}{n - 2}\sum\left( y_{i} - \overset{\hat{}}{a} - \overset{\hat{}}{b}x_{i} \right)^{2} = MSE\)</span>.</p>
<p><strong>【<span class="math inline">\(\overset{\hat{}}{b}\)</span> 샘플링 분포】</strong></p>
<p><span class="math inline">\(\overset{\hat{}}{b} = \frac{\sum\left( x_{i} - \overset{¯}{x} \right)\left( y_{i} - \overset{¯}{y} \right)}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}\)</span> 이므로 <span class="math inline">\(k_{i} = \frac{\left( y_{i} - \overset{¯}{y} \right)}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}\)</span> 이라 하면 <span class="math inline">\(\overset{\hat{}}{b} = \sum k_{i}y_{i}\)</span> 이다. 그리고 <span class="math inline">\(\sum k_{i} = 0,\sum k_{i}x_{i} = 1,\sum k_{i}^{2} = \frac{1}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}\)</span>이다.</p>
<p><span class="math inline">\(y_{i} \sim (iid)N(a + bx_{i},\sigma^{2})\)</span> 이므로 선형 결합 <span class="math inline">\(\overset{\hat{}}{b} = \sum k_{i}y_{i}\)</span>도 정규분포를 따른다.</p>
<p><span class="math display">\[E\left( \overset{\hat{}}{b} \right) = E\left( \sum k_{i}y_{i} \right) = \sum k_{i}{E(y}_{i}) = \sum k_{i}(a + bx_{i}) = b\]</span></p>
<p><span class="math display">\[V\left( \overset{\hat{}}{b} \right) = V\left( \sum k_{i}y_{i} \right) = \sum k_{i}^{2}{V(y}_{i}) = \sum k_{i}^{2}(\sigma^{2}) = \frac{\sigma^{2}}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}\]</span></p>
<p><span class="math inline">\(\overset{\hat{}}{b} \sim N(b,\frac{\sigma^{2}}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}})\)</span>. 만약 <span class="math inline">\(\sigma^{2}\)</span>을 MVUE 추정량 <span class="math inline">\(\frac{(n - 2)\overset{\hat{}}{\sigma^{2}}}{\sigma^{2}} = \frac{\sum\left( y_{i} - \overset{\hat{}}{a} - \overset{\hat{}}{b}x_{i} \right)^{2}}{\sigma^{2}} \sim \chi^{2}(n - 2)\)</span> 성립한다.</p>
<p>그러므로 <span class="math inline">\(\frac{\overset{\hat{}}{b} - b}{s\left( \overset{\hat{}}{b} \right)} \sim t(n - 2)\)</span>, <span class="math inline">\(s^{2}\left( \overset{\hat{}}{b} \right) = \frac{MSE}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}\)</span>이다.</p>
<p><strong>【기울기 <span class="math inline">\(b\)</span>&nbsp;에 대한 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간】</strong></p>
<p><span class="math inline">\((\overset{\hat{}}{b} - t_{1 - \frac{\alpha}{2},(n - 1)}s\left( \overset{\hat{}}{b} \right),\overset{\hat{}}{b} + t_{1 - \frac{\alpha}{2},(n - 1)}s\left( \overset{\hat{}}{b} \right)\)</span>, <span class="math inline">\(s^{2}\left( \overset{\hat{}}{b} \right) = \frac{MSE}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}\)</span>.</p>
<p><strong>【절편 <span class="math inline">\(a\)</span>&nbsp;에 대한 <span class="math inline">\(100(1 - \alpha)\%\)</span> 신뢰구간】</strong></p>
<p><span class="math inline">\((\overset{\hat{}}{a} - t_{1 - \frac{\alpha}{2},(n - 1)}s\left( \overset{\hat{}}{a} \right),\overset{\hat{}}{a} + t_{1 - \frac{\alpha}{2},(n - 1)}s\left( \overset{\hat{}}{a} \right)\)</span>, <span class="math inline">\(s^{2}\left( \overset{\hat{}}{a} \right) = MSE(\frac{1}{n} + \frac{{\overset{¯}{x}}^{2}}{\sum\left( x_{i} - \overset{¯}{x} \right)^{2}}\)</span>)</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "복사완료!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "복사완료!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 Kwon</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with Quarto</p>
</div>
  </div>
</footer>




</body></html>