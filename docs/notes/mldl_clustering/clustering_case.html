<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ: ì‚¬ë¡€ë¶„ì„ â€“ ì„¸ìƒì˜ ëª¨ë“  í†µê³„ ì´ì•¼ê¸°</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-44962e3d41ec9ccc254fd50f1af5efbe.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ì„¸ìƒì˜ ëª¨ë“  í†µê³„ ì´ì•¼ê¸°</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../notes/math_stat/index.html"> 
<span class="menu-text">ê¸°ì´ˆìˆ˜í•™Â·ìˆ˜ë¦¬í†µê³„</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/intro_stat/index.html"> 
<span class="menu-text">ê¸°ì´ˆí†µê³„|ì¡°ì‚¬ë°©ë²•</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/linear_model/index.html"> 
<span class="menu-text">íšŒê·€Â·ë‹¤ë³€ëŸ‰ë¶„ì„</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/mldl_intro/index.html"> 
<span class="menu-text">MLDLê°œë…</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/mldl_prediction/index.html"> 
<span class="menu-text">MLDLì˜ˆì¸¡</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/mldl_classification/index.html"> 
<span class="menu-text">MLDLë¶„ë¥˜</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../notes/data_reduction/index.html" aria-current="page"> 
<span class="menu-text">ì°¨ì›ì¶•ì†Œ|êµ°ì§‘</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cardnews/index.html"> 
<span class="menu-text">ì¹´ë“œë‰´ìŠ¤</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../consult.html"> 
<span class="menu-text">í†µê³„ìƒë‹´</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../notes/mldl_clustering/clustering_case.html">ğŸ“„ êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ ì‚¬ë¡€ë¶„ì„</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/data_reduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ã€ì°¨ì›ì¶•ì†Œã€‘</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/data_reduction/data reduction_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ğŸ“„ ì°¨ì›ì¶•ì†Œ ê°œë…|í•„ìš”ì„±</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/data_reduction/data reduction_statmethod.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ğŸ“„ ì°¨ì›ì¶•ì†Œ í†µê³„ì ë°©ë²•</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/data_reduction/data reduction_unsupervised.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ğŸ“„ ì°¨ì›ì¶•ì†Œ ë¹„ì§€ë„í•™ìŠµ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/data_reduction/data reduction_case.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ğŸ“„ ì°¨ì›ì¶•ì†Œ ì‚¬ë¡€ë¶„ì„</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/mldl_clustering/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ã€êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµã€‘</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/mldl_clustering/clustering_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ğŸ“„ êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ ê°œë…</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/mldl_clustering/clustering_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ğŸ“„ êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ ë°©ë²•ë¡ </span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/mldl_clustering/clustering_case.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ğŸ“„ êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ ì‚¬ë¡€ë¶„ì„</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">ëª©ì°¨</h2>
   
  <ul>
  <li><a href="#êµ°ì§‘ë¹„ì§€ë„í•™ìŠµ-ì‚¬ë¡€ë¶„ì„" id="toc-êµ°ì§‘ë¹„ì§€ë„í•™ìŠµ-ì‚¬ë¡€ë¶„ì„" class="nav-link active" data-scroll-target="#êµ°ì§‘ë¹„ì§€ë„í•™ìŠµ-ì‚¬ë¡€ë¶„ì„">êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ ì‚¬ë¡€ë¶„ì„</a>
  <ul>
  <li><a href="#digits-ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°-ë°-ì„¤ëª…" id="toc-digits-ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°-ë°-ì„¤ëª…" class="nav-link" data-scroll-target="#digits-ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°-ë°-ì„¤ëª…">1. Digits ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì„¤ëª…</a></li>
  <li><a href="#ëª¨ë¸ê¸°ë°˜-êµ°ì§‘gmm" id="toc-ëª¨ë¸ê¸°ë°˜-êµ°ì§‘gmm" class="nav-link" data-scroll-target="#ëª¨ë¸ê¸°ë°˜-êµ°ì§‘gmm">2. ëª¨ë¸ê¸°ë°˜ êµ°ì§‘(GMM)</a></li>
  <li><a href="#ì „í†µì -êµ°ì§‘ë¶„ì„traditional-clustering" id="toc-ì „í†µì -êµ°ì§‘ë¶„ì„traditional-clustering" class="nav-link" data-scroll-target="#ì „í†µì -êµ°ì§‘ë¶„ì„traditional-clustering">3. ì „í†µì  êµ°ì§‘ë¶„ì„(Traditional Clustering)</a></li>
  <li><a href="#í‘œí˜„ê¸°ë°˜-êµ°ì§‘representation-based-clustering" id="toc-í‘œí˜„ê¸°ë°˜-êµ°ì§‘representation-based-clustering" class="nav-link" data-scroll-target="#í‘œí˜„ê¸°ë°˜-êµ°ì§‘representation-based-clustering">4. í‘œí˜„ê¸°ë°˜ êµ°ì§‘(Representation-based Clustering)</a></li>
  <li><a href="#ì˜¤í† ì¸ì½”ë”-ê¸°ë°˜-í‘œí˜„-êµ°ì§‘autoencoder-clustering-deep-clustering-ê°œë…-ì‹¤í—˜" id="toc-ì˜¤í† ì¸ì½”ë”-ê¸°ë°˜-í‘œí˜„-êµ°ì§‘autoencoder-clustering-deep-clustering-ê°œë…-ì‹¤í—˜" class="nav-link" data-scroll-target="#ì˜¤í† ì¸ì½”ë”-ê¸°ë°˜-í‘œí˜„-êµ°ì§‘autoencoder-clustering-deep-clustering-ê°œë…-ì‹¤í—˜">5. ì˜¤í† ì¸ì½”ë” ê¸°ë°˜ í‘œí˜„ êµ°ì§‘(AutoEncoder + Clustering) deep clustering ê°œë… ì‹¤í—˜</a></li>
  <li><a href="#deep-clustering-dec-ê°œë…-ì‹¤í—˜-ae-ì„ë² ë”©-klêµ°ì§‘-ë™ì‹œ-ìµœì í™”" id="toc-deep-clustering-dec-ê°œë…-ì‹¤í—˜-ae-ì„ë² ë”©-klêµ°ì§‘-ë™ì‹œ-ìµœì í™”" class="nav-link" data-scroll-target="#deep-clustering-dec-ê°œë…-ì‹¤í—˜-ae-ì„ë² ë”©-klêµ°ì§‘-ë™ì‹œ-ìµœì í™”">6. Deep clustering (DEC ê°œë… ì‹¤í—˜): AE ì„ë² ë”© + KL(êµ°ì§‘) ë™ì‹œ ìµœì í™”</a></li>
  <li><a href="#ìµœì¢…-ë³´ê³ ì„œ-ìƒì„±-ìƒìœ„-3ê°œ-ë°©ë²•ì˜-êµì°¨í‘œ-ëŒ€í‘œìˆ«ì-ëŒ€í‘œì´ë¯¸ì§€-ì‹œê°í™”" id="toc-ìµœì¢…-ë³´ê³ ì„œ-ìƒì„±-ìƒìœ„-3ê°œ-ë°©ë²•ì˜-êµì°¨í‘œ-ëŒ€í‘œìˆ«ì-ëŒ€í‘œì´ë¯¸ì§€-ì‹œê°í™”" class="nav-link" data-scroll-target="#ìµœì¢…-ë³´ê³ ì„œ-ìƒì„±-ìƒìœ„-3ê°œ-ë°©ë²•ì˜-êµì°¨í‘œ-ëŒ€í‘œìˆ«ì-ëŒ€í‘œì´ë¯¸ì§€-ì‹œê°í™”">7. ìµœì¢… ë³´ê³ ì„œ ìƒì„±: ìƒìœ„ 3ê°œ ë°©ë²•ì˜ êµì°¨í‘œ, ëŒ€í‘œìˆ«ì, ëŒ€í‘œì´ë¯¸ì§€ ì‹œê°í™”</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ: ì‚¬ë¡€ë¶„ì„</h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="êµ°ì§‘ë¹„ì§€ë„í•™ìŠµ-ì‚¬ë¡€ë¶„ì„" class="level3">
<h3 class="anchored" data-anchor-id="êµ°ì§‘ë¹„ì§€ë„í•™ìŠµ-ì‚¬ë¡€ë¶„ì„">êµ°ì§‘ãƒ»ë¹„ì§€ë„í•™ìŠµ ì‚¬ë¡€ë¶„ì„</h3>
<section id="digits-ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°-ë°-ì„¤ëª…" class="level4">
<h4 class="anchored" data-anchor-id="digits-ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°-ë°-ì„¤ëª…">1. Digits ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì„¤ëª…</h4>
<p>Digits ë°ì´í„°ì…‹ì€ UCIì˜ Optical Recognition of Handwritten Digits ìë£Œ(ì›ë˜ 5,620ê°œ ì¤‘ scikit-learnì—ëŠ” í…ŒìŠ¤íŠ¸ì…‹ 1,797ê°œê°€ ìˆ˜ë¡ë¨)ì—ì„œ ê°€ì ¸ì˜¨ ê²ƒìœ¼ë¡œ, ì†ê¸€ì”¨ ìˆ«ìë¥¼ ë¯¸ë¦¬ ì¸ì‡„ëœ ì–‘ì‹ì— ì‘ì„±í•˜ê²Œ í•œ ë’¤ ì´ë¯¸ì§€ë¥¼ ì „ì²˜ë¦¬í•˜ì—¬ êµ¬ì¶•ëœ ê²ƒì´ë‹¤.</p>
<p>êµ¬ì²´ì ìœ¼ë¡œ ê° ì†ê¸€ì”¨ëŠ” NIST ì „ì²˜ë¦¬ í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì •ê·œí™”ëœ 32Ã—32 ë¹„íŠ¸ë§µìœ¼ë¡œ ë§Œë“  ë‹¤ìŒ, ì´ë¥¼ ê²¹ì¹˜ì§€ ì•ŠëŠ” 4Ã—4 ë¸”ë¡ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ê° ë¸”ë¡ì—ì„œ â€˜ì¼œì§„ í”½ì…€(on pixel)â€™ ê°œìˆ˜ë¥¼ ì„¸ì–´ 0~16 ë²”ìœ„ì˜ ê°’ì„ ì–»ê³ , ì´ë ‡ê²Œ ê³„ì‚°ëœ 8Ã—8(=64ê°œ) ê°’ì´ í•œ ê´€ì¸¡ì¹˜ì˜ íŠ¹ì§•ë²¡í„°ê°€ ëœë‹¤.</p>
<p>ë”°ë¼ì„œ Digitsì˜ â€œí”½ì…€ê°’â€ì€ ì¼ë°˜ íšŒìƒ‰ì¡° ë°ê¸°ë¼ê¸°ë³´ë‹¤, í•´ë‹¹ ì˜ì—­ì—ì„œ ê¸€ì”¨ê°€ ì°¨ì§€í•˜ëŠ” ì •ë„ë¥¼ ìš”ì•½í•œ ë¸”ë¡ ë‹¨ìœ„ ë°€ë„(density) ì§€í‘œì´ë©°, ì´ íŠ¹ì„± ë•Œë¬¸ì— ê±°ë¦¬ ê¸°ë°˜ êµ°ì§‘, í˜¼í•©ëª¨í˜•(GMM), PCA/ë”¥ ì„ë² ë”© ê¸°ë°˜ êµ°ì§‘ ë¹„êµ ì‹¤ìŠµì— ì ì ˆí•œ í‘œì¤€ ì‚¬ë¡€ë¡œ ì‚¬ìš©ëœë‹¤.</p>
<p>scikit-learnì˜ Digits ë°ì´í„°ì…‹ì€ 0~9 ì†ê¸€ì”¨ ìˆ«ìë¥¼ 8Ã—8 í‘ë°± ì´ë¯¸ì§€ë¡œ í‘œí˜„í•œ ìë£Œì´ë‹¤. ê° ê´€ì¸¡ì¹˜ëŠ” 64ê°œì˜ í”½ì…€ ê°•ë„(feature)ë¡œ êµ¬ì„±ëœ ë²¡í„°ì´ë©°, í”½ì…€ ê°’ì˜ ë²”ìœ„ëŠ” ëŒ€ëµ 0~16ì´ë‹¤. í‘œë³¸ í¬ê¸°ëŠ” 1,797ê°œì´ë©°, ë¹„ì§€ë„í•™ìŠµ êµ°ì§‘ ì‚¬ë¡€ì— ì ì ˆí•œ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
<li>ì°¨ì›ì´ 64ë¡œ ì ì ˆí•˜ì—¬(ê³ ì°¨ì› íš¨ê³¼ê°€ ìˆìœ¼ë‚˜ ê³¼ë„í•˜ì§€ ì•ŠìŒ) êµ°ì§‘ ê¸°ë²• ë¹„êµê°€ ìš©ì´í•˜ë‹¤.</li>
<li>ì›ìë£Œ ê³µê°„(í”½ì…€)ì—ì„œì˜ êµ°ì§‘, í™•ë¥ ëª¨í˜• ê¸°ë°˜(GMM) êµ°ì§‘, PCA/ë”¥ ì„ë² ë”© ê¸°ë°˜ êµ°ì§‘ì„ ëª¨ë‘ ì ìš©í•˜ê¸° ì‰½ë‹¤.</li>
<li>ì •ë‹µ ë¼ë²¨(ìˆ«ì 0~9)ì´ ì¡´ì¬í•˜ë¯€ë¡œ, í•™ìŠµì—ëŠ” ìˆ¨ê¸°ê³  ìµœì¢… ë¹„êµì—ì„œë§Œ ì™¸ë¶€í‰ê°€(ARI, NMI ë“±)ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<p>ì´í›„ ë¶„ì„ì—ì„œëŠ” ì…ë ¥ ë°ì´í„°ëŠ” <span class="math inline">\(X \in \mathbb{R}^{n\times p}\)</span> ë¡œ ë‘ê³ (<span class="math inline">\(n=1797, p=64\)</span>), ë¼ë²¨ <span class="math inline">\(y\)</span> ëŠ” í‰ê°€ìš© ë³´ì¡°ì •ë³´ë¡œë§Œ ì‚¬ìš©í•œë‹¤.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_digits</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ì¬í˜„ì„±</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>RANDOM_STATE <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_STATE)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ë°ì´í„° ë¡œë“œ</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>digits <span class="op">=</span> load_digits()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> digits.data          <span class="co"># (n, 64) : 8x8 ì´ë¯¸ì§€ë¥¼ 1ì°¨ì› ë²¡í„°ë¡œ í¼ì¹œ ê²ƒ</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> digits.target        <span class="co"># (n,)     : ì‹¤ì œ ìˆ«ì ë¼ë²¨(í‰ê°€ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©í•  ê²ƒ)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>images <span class="op">=</span> digits.images   <span class="co"># (n, 8, 8) : ì›ë˜ ì´ë¯¸ì§€ í˜•íƒœ</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> X.shape</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"n = </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">, p = </span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"pixel value range: min=</span><span class="sc">{</span>X<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.1f}</span><span class="ss">, max=</span><span class="sc">{</span>X<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"classes:"</span>, np.unique(y), <span class="st">" (ì´"</span>, <span class="bu">len</span>(np.unique(y)), <span class="st">"ê°œ)"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># í´ë˜ìŠ¤ ë¶„í¬ í™•ì¸(í‰ê°€ìš© ì°¸ê³ )</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> pd.Series(y).value_counts().sort_index()</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>display(pd.DataFrame({<span class="st">"count"</span>: counts, <span class="st">"proportion"</span>: counts <span class="op">/</span> counts.<span class="bu">sum</span>()}))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ìƒ˜í”Œ ì´ë¯¸ì§€ ì‹œê°í™” (ê° ìˆ«ìë³„ 1ê°œì”©)</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> digit_label <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> np.where(y <span class="op">==</span> digit_label)[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    axes[digit_label].imshow(images[idx], cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    axes[digit_label].set_title(<span class="ss">f"label=</span><span class="sc">{</span>digit_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    axes[digit_label].axis(<span class="st">"off"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ë°ì´í„° í–‰ë ¬ì˜ ê°„ë‹¨ ìš”ì•½(í‰ê· /í‘œì¤€í¸ì°¨)</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>X_df <span class="op">=</span> pd.DataFrame(X)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean"</span>: X_df.mean(),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"std"</span>: X_df.std(),</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"min"</span>: X_df.<span class="bu">min</span>(),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max"</span>: X_df.<span class="bu">max</span>()</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>display(summary.head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>ë°ì´í„° X.shape = (1797, 64)</strong></p>
<pre class="text"><code>array([[ 0.,  0.,  5., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ..., 10.,  0.,  0.],
       [ 0.,  0.,  0., ..., 16.,  9.,  0.],
       ...,
       [ 0.,  0.,  1., ...,  6.,  0.,  0.],
       [ 0.,  0.,  2., ..., 12.,  0.,  0.],
       [ 0.,  0., 10., ..., 12.,  1.,  0.]])</code></pre>
<pre class="text"><code>n = 1797, p = 64
pixel value range: min=0.0, max=16.0
classes: [0 1 2 3 4 5 6 7 8 9]  (ì´ 10 ê°œ)
count   proportion
0   178 0.099054
1   182 0.101280
2   177 0.098497
3   183 0.101836
4   181 0.100723
5   182 0.101280
6   181 0.100723
7   179 0.099610
8   174 0.096828
9   180 0.100167</code></pre>
<p>ì´ ê·¸ë¦¼ì€ Digits ë°ì´í„°ì…‹ì´ ì–´ë–¤ í˜•íƒœì˜ ì…ë ¥ X ë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€ë¥¼ â€œëˆˆìœ¼ë¡œ í™•ì¸â€í•˜ê¸° ìœ„í•œ ëŒ€í‘œ ìƒ˜í”Œ ì‹œê°í™”ì´ë‹¤.</p>
<p>ê° ì‘ì€ íŒ¨ë„(ì˜ˆ: label=0, label=1, â€¦, label=9)ì€ ìˆ«ì í´ë˜ìŠ¤ë³„ë¡œ ê´€ì¸¡ì¹˜ 1ê°œì”©ì„ ê³¨ë¼ ë³´ì—¬ì¤€ ê²ƒì´ë‹¤. (ì½”ë“œì—ì„œ idx = np.where(y==digit_label)[0][0]ë¡œ í•´ë‹¹ ìˆ«ì ë¼ë²¨ ì¤‘ â€™ì²« ë²ˆì§¸ ìƒ˜í”Œâ€™ì„ ì„ íƒí•œ ê²°ê³¼ì´ë‹¤.)</p>
<p>í•œ ì¥ì˜ ì´ë¯¸ì§€ëŠ” 8Ã—8 ê²©ìì´ë©°, ì¦‰ í•œ ê´€ì¸¡ì¹˜ê°€ 64ê°œì˜ ë³€ìˆ˜(í”½ì…€/ë¸”ë¡ ê°’) ë¡œ ì´ë£¨ì–´ì§„ë‹¤ëŠ” ëœ»ì´ë‹¤. ìƒ‰ì˜ ì˜ë¯¸ëŠ” ë°ì„ìˆ˜ë¡ ê°’ì´ í¬ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. Digitsì˜ ê°’ì€ ë³´í†µ 0~16 ë²”ìœ„ì´ë©°, ê°’ì´ í´ìˆ˜ë¡ ê·¸ ìœ„ì¹˜(ë¸”ë¡)ì— ê¸€ì”¨ íšì´ ë§ì´ í¬í•¨ë˜ì–´ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤. ë”°ë¼ì„œ í°ìƒ‰ì— ê°€ê¹Œìš´ ì¹¸ì€ ê¸€ì”¨ê°€ ë§ì´ ì§€ë‚˜ê°„ ì˜ì—­, ê²€ì€ ì¹¸ì€ ê±°ì˜ ë¹„ì–´ ìˆëŠ” ì˜ì—­ì´ë‹¤.</p>
<p>ì´ ê·¸ë¦¼ì€ â€œê° ìˆ«ìê°€ ëŒ€ëµ ì–´ë–¤ íš êµ¬ì¡°ë¥¼ ê°–ëŠ”ê°€â€ë¥¼ ë³´ì—¬ì£¼ëŠ” ë™ì‹œì—, ì˜ˆë¥¼ ë“¤ì–´ 3ê³¼ 8, 4ì™€ 9ì²˜ëŸ¼ ëª¨ì–‘ì´ ë¹„ìŠ·í•´ ë³´ì´ëŠ” í´ë˜ìŠ¤ê°€ ì¡´ì¬í•¨ì„ ë³´ì—¬ì£¼ë¯€ë¡œ, ì´í›„ êµ°ì§‘ì—ì„œ êµ°ì§‘ ê°„ ë¶„ë¦¬ê°€ ì™„ë²½í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒì„ ë¯¸ë¦¬ ì‹œì‚¬í•˜ëŠ” ì—­í• ë„ í•œë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_case_dataimage.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<pre class="text"><code>    mean    std min max
0   0.000000    0.000000    0.0 0.0
1   0.303840    0.907192    0.0 8.0
2   5.204786    4.754826    0.0 16.0
3   11.835838   4.248842    0.0 16.0
4   11.848080   4.287388    0.0 16.0</code></pre>
<section id="ì „ì²˜ë¦¬-í‘œì¤€í™”" class="level5">
<h5 class="anchored" data-anchor-id="ì „ì²˜ë¦¬-í‘œì¤€í™”">ì „ì²˜ë¦¬: í‘œì¤€í™”</h5>
<p>Digits ë°ì´í„°ëŠ” í”½ì…€ ê°’ì´ 0~16 ë²”ìœ„ë¡œ ì œí•œë˜ì–´ ìˆê³ , ê° í”½ì…€ì˜ ë¶„í¬ë„ ìœ ì‚¬í•œ í˜•íƒœë¥¼ ë ë¯€ë¡œ, í‘œì¤€í™”(í‰ê·  0, í‘œì¤€í¸ì°¨ 1)ì™€ ê°™ì€ ìŠ¤ì¼€ì¼ë§ì´ ë°˜ë“œì‹œ í•„ìš”í•œ ê²ƒì€ ì•„ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´í›„ êµ°ì§‘ ê¸°ë²•ì—ì„œ ê±°ë¦¬ ê³„ì‚°ì´ í¬í•¨ë˜ëŠ” ê²½ìš°(ì˜ˆ: K-means, GMM)ì—ëŠ” ìŠ¤ì¼€ì¼ë§ì´ ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í‘œì¤€í™”ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ê¶Œì¥ë˜ëŠ” ì „ì²˜ë¦¬ ë‹¨ê³„ì´ë‹¤. í‘œì¤€í™”ë¥¼ ì ìš©í•˜ë©´ ê° í”½ì…€ì˜ í‰ê· ì´ 0, í‘œì¤€í¸ì°¨ê°€ 1ì´ ë˜ì–´, ëª¨ë“  í”½ì…€ì´ ë™ì¼í•œ ìŠ¤ì¼€ì¼ë¡œ ë¹„êµë  ìˆ˜ ìˆë‹¤.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(ì„ íƒ) í‘œì¤€í™” ë°ì´í„°ë„ í•¨ê»˜ ì¤€ë¹„(2ë‹¨ê³„ë¶€í„° ë¹„êµìš©ìœ¼ë¡œ ìœ ìš©)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>X_std <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"X_std summary:"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"mean (approx):"</span>, X_std.mean(axis<span class="op">=</span><span class="dv">0</span>)[:<span class="dv">5</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"std  (approx):"</span>, X_std.std(axis<span class="op">=</span><span class="dv">0</span>)[:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="ëª¨ë¸ê¸°ë°˜-êµ°ì§‘gmm" class="level4">
<h4 class="anchored" data-anchor-id="ëª¨ë¸ê¸°ë°˜-êµ°ì§‘gmm">2. ëª¨ë¸ê¸°ë°˜ êµ°ì§‘(GMM)</h4>
<p>ì´ ì½”ë“œëŠ” Digits ë°ì´í„°ì— ëŒ€í•´ Gaussian Mixture Model(GMM)ì„ ì í•©í•˜ì—¬ êµ°ì§‘ì„ ìˆ˜í–‰í•˜ê³ , êµ°ì§‘ ìˆ˜ (K)ì™€ ê³µë¶„ì‚° í˜•íƒœ(covariance type)ë¥¼ ë°”ê¿”ê°€ë©° AIC/BICë¡œ ìµœì  ì¡°í•©ì„ ì„ íƒí•œ ë’¤, ì„ íƒëœ ëª¨í˜•ì˜ êµ°ì§‘ ì„±ëŠ¥ì„ ì™¸ë¶€ì§€í‘œ(ARI/NMI)ë¡œ ìš”ì•½í•˜ê³  AIC/BIC ê³¡ì„ ì„ ì‹œê°í™”í•˜ëŠ” ì ˆì°¨ì´ë‹¤.</p>
<section id="ì„¤ì •ë°ì´í„°-k-í›„ë³´-ê³µë¶„ì‚°-í˜•íƒœ-ìˆ˜ì¹˜-ì•ˆì •í™”-íŒŒë¼ë¯¸í„°ì´ë‹¤" class="level5">
<h5 class="anchored" data-anchor-id="ì„¤ì •ë°ì´í„°-k-í›„ë³´-ê³µë¶„ì‚°-í˜•íƒœ-ìˆ˜ì¹˜-ì•ˆì •í™”-íŒŒë¼ë¯¸í„°ì´ë‹¤">ì„¤ì •(ë°ì´í„°, K í›„ë³´, ê³µë¶„ì‚° í˜•íƒœ, ìˆ˜ì¹˜ ì•ˆì •í™” íŒŒë¼ë¯¸í„°)ì´ë‹¤</h5>
<ul>
<li><code>X_use = X_std</code>ëŠ” í‘œì¤€í™”ëœ ë°ì´í„°ë¥¼ ë¶„ì„ ëŒ€ìƒìœ¼ë¡œ ì„ íƒí•˜ëŠ” ë¶€ë¶„ì´ë‹¤. GMMì€ ê³µë¶„ì‚°ì„ ì¶”ì •í•˜ë¯€ë¡œ ìŠ¤ì¼€ì¼ ì°¨ì´ê°€ í¬ë©´ ìˆ˜ì¹˜ì ìœ¼ë¡œ ë¶ˆì•ˆì •í•´ì§ˆ ìˆ˜ ìˆì–´ í‘œì¤€í™”ê°€ ì¼ë°˜ì ìœ¼ë¡œ ì•ˆì •ì ì´ë‹¤.</li>
<li><code>K_list = range(2, 21)</code>ì€ êµ°ì§‘ ìˆ˜ í›„ë³´ (K)ë¥¼ 2ë¶€í„° 20ê¹Œì§€ë¡œ ë‘ëŠ” ì„¤ì •ì´ë‹¤.</li>
<li><code>cov_types = ["spherical","diag","tied","full"]</code>ì€ ê³µë¶„ì‚° í˜•íƒœë¥¼ ë„¤ ê°€ì§€ë¡œ ë¹„êµí•˜ëŠ” ì„¤ì •ì´ë‹¤. ì´ëŠ” êµ°ì§‘ì˜ ëª¨ì–‘(êµ¬í˜•/ì¶•ì •ë ¬/ê³µìœ ê³µë¶„ì‚°/ììœ ê³µë¶„ì‚°)ì„ ë‹¬ë¦¬ ê°€ì •í•˜ëŠ” ê²ƒì´ë‹¤.</li>
<li><code>N_INIT=10</code>ì€ ì´ˆê¸°ê°’ì„ ì—¬ëŸ¬ ë²ˆ ë‹¬ë¦¬í•˜ì—¬ EMì„ ë°˜ë³µ ì‹¤í–‰í•˜ê³ , ê·¸ ì¤‘ ë” ì¢‹ì€ í•´ë¥¼ ì„ íƒí•˜ê¸° ìœ„í•œ ì„¤ì •ì´ë‹¤.</li>
<li><code>MAX_ITER=500</code>ì€ EM ë°˜ë³µ íšŸìˆ˜ ìƒí•œì´ë‹¤.</li>
<li><code>REG_COVAR=1e-6</code>ì€ ê³µë¶„ì‚° íŠ¹ì´(singularity) ë¬¸ì œë¥¼ ì™„í™”í•˜ê¸° ìœ„í•œ ì •ê·œí™” í•­ì´ë‹¤.</li>
</ul>
</section>
<section id="k-ê³µë¶„ì‚°-í˜•íƒœ-ì¡°í•©ë³„ë¡œ-gmmì„-ì í•©í•˜ê³ -aicbicë¥¼-ê³„ì‚°í•œë‹¤" class="level5">
<h5 class="anchored" data-anchor-id="k-ê³µë¶„ì‚°-í˜•íƒœ-ì¡°í•©ë³„ë¡œ-gmmì„-ì í•©í•˜ê³ -aicbicë¥¼-ê³„ì‚°í•œë‹¤">(K, ê³µë¶„ì‚° í˜•íƒœ) ì¡°í•©ë³„ë¡œ GMMì„ ì í•©í•˜ê³  AIC/BICë¥¼ ê³„ì‚°í•œë‹¤</h5>
<ul>
<li>ì´ì¤‘ ë°˜ë³µë¬¸ì€ ëª¨ë“  ì¡°í•© ((K, ))ì— ëŒ€í•´ <code>GaussianMixture(...).fit(X_use)</code>ë¥¼ ìˆ˜í–‰í•œë‹¤.</li>
<li>ì í•© ì´í›„ <code>gmm.aic(X_use)</code>ì™€ <code>gmm.bic(X_use)</code>ë¥¼ ê³„ì‚°í•˜ì—¬ <code>records</code>ì— ì €ì¥í•œë‹¤.</li>
<li><code>log_likelihood = gmm.score(X_use) * n</code>ì€ ê´€ì¸¡ì¹˜ë‹¹ í‰ê·  ë¡œê·¸ìš°ë„(score)ì— í‘œë³¸ ìˆ˜ë¥¼ ê³±í•´ ì „ì²´ ë¡œê·¸ìš°ë„ë¥¼ ê¸°ë¡í•œ ê²ƒì´ë‹¤.</li>
<li><code>converged</code>ëŠ” EMì´ ìˆ˜ë ´í–ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§„ë‹¨ê°’ì´ë‹¤.</li>
<li>ìµœì¢…ì ìœ¼ë¡œ <code>results</code> ë°ì´í„°í”„ë ˆì„ì€ (ê³µë¶„ì‚° í˜•íƒœ, K)ë³„ AIC/BIC/ë¡œê·¸ìš°ë„/ìˆ˜ë ´ì—¬ë¶€ë¥¼ ì •ë¦¬í•œ í‘œì´ë‹¤.</li>
</ul>
</section>
<section id="aicbic-ê¸°ì¤€ìœ¼ë¡œ-ìµœì -ì¡°í•©ì„-ì„ íƒí•œë‹¤" class="level5">
<h5 class="anchored" data-anchor-id="aicbic-ê¸°ì¤€ìœ¼ë¡œ-ìµœì -ì¡°í•©ì„-ì„ íƒí•œë‹¤">AIC/BIC ê¸°ì¤€ìœ¼ë¡œ ìµœì  ì¡°í•©ì„ ì„ íƒí•œë‹¤</h5>
<ul>
<li><code>best_bic_row</code>ëŠ” <code>results</code>ì—ì„œ BICê°€ ìµœì†Œì¸ í–‰ì„ ì„ íƒí•œ ê²ƒì´ë‹¤. ì´ëŠ” BIC ê¸°ì¤€ ìµœì ì˜ ((K,)) ì¡°í•©ì´ë‹¤.</li>
<li><code>best_aic_row</code>ëŠ” AICê°€ ìµœì†Œì¸ í–‰ì„ ì„ íƒí•œ ê²ƒì´ë‹¤.</li>
<li>ì¼ë°˜ì ìœ¼ë¡œ BICëŠ” ë³µì¡ë„ íŒ¨ë„í‹°ê°€ ë” ê°•í•˜ì—¬(AICë³´ë‹¤) ë” ë³´ìˆ˜ì ì¸ (K)ë¥¼ ì„ íƒí•˜ëŠ” ê²½í–¥ì´ ìˆë‹¤.</li>
</ul>
</section>
<section id="ì„ íƒëœ-ìµœì -ëª¨í˜•ìœ¼ë¡œ-ì¬í•™ìŠµí•˜ì—¬-êµ°ì§‘-ë¼ë²¨ê³¼-ì†Œì†í™•ë¥ ì„-ë§Œë“ ë‹¤" class="level5">
<h5 class="anchored" data-anchor-id="ì„ íƒëœ-ìµœì -ëª¨í˜•ìœ¼ë¡œ-ì¬í•™ìŠµí•˜ì—¬-êµ°ì§‘-ë¼ë²¨ê³¼-ì†Œì†í™•ë¥ ì„-ë§Œë“ ë‹¤">ì„ íƒëœ ìµœì  ëª¨í˜•ìœ¼ë¡œ ì¬í•™ìŠµí•˜ì—¬ êµ°ì§‘ ë¼ë²¨ê³¼ ì†Œì†í™•ë¥ ì„ ë§Œë“ ë‹¤</h5>
<ul>
<li><code>fit_best_gmm(row)</code> í•¨ìˆ˜ëŠ” ì„ íƒëœ ì„¤ì •(í–‰ì— ë“¤ì–´ ìˆëŠ” (K), ê³µë¶„ì‚° í˜•íƒœ)ìœ¼ë¡œ GMMì„ ë‹¤ì‹œ ì í•©í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.</li>
<li><code>z_hat = gmm.predict(X_use)</code>ëŠ” ê° ê´€ì¸¡ì¹˜ë¥¼ ì‚¬í›„í™•ë¥ ì´ ê°€ì¥ í° ì„±ë¶„ì— ë°°ì •í•œ hard assignment êµ°ì§‘ ë¼ë²¨ì´ë‹¤.</li>
<li><code>resp = gmm.predict_proba(X_use)</code>ëŠ” ê° ê´€ì¸¡ì¹˜ê°€ ê° êµ°ì§‘ì— ì†í•  í™•ë¥ (ì±…ì„ë„, responsibility) í–‰ë ¬ì´ë‹¤.</li>
<li>ì½”ë“œì—ì„œëŠ” BIC-best, AIC-best ê°ê°ì— ëŒ€í•´ <code>z_bic</code>, <code>z_aic</code>ì™€ ì±…ì„ë„ <code>resp_bic</code>, <code>resp_aic</code>ë¥¼ ìƒì„±í•œë‹¤.</li>
</ul>
</section>
<section id="ì™¸ë¶€í‰ê°€arinmië¡œ-ë°©ë²•-ë¹„êµë¥¼-ì •ë¦¬í•œë‹¤" class="level5">
<h5 class="anchored" data-anchor-id="ì™¸ë¶€í‰ê°€arinmië¡œ-ë°©ë²•-ë¹„êµë¥¼-ì •ë¦¬í•œë‹¤">ì™¸ë¶€í‰ê°€(ARI/NMI)ë¡œ ë°©ë²• ë¹„êµë¥¼ ì •ë¦¬í•œë‹¤</h5>
<ul>
<li><code>adjusted_rand_score(y, z_*)</code>ì™€ <code>normalized_mutual_info_score(y, z_*)</code>ëŠ” ì‹¤ì œ ìˆ«ì ë¼ë²¨ (y)ì™€ êµ°ì§‘ ê²°ê³¼ (z)ì˜ ì¼ì¹˜ë„ë¥¼ ê³„ì‚°í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.</li>
<li>ì´ëŠ” êµ°ì§‘ í•™ìŠµì— ë¼ë²¨ì„ ì‚¬ìš©í•œ ê²ƒì´ ì•„ë‹ˆë¼, ë™ì¼ ë°ì´í„°ì—ì„œ ë°©ë²•ì„ ë¹„êµí•˜ê¸° ìœ„í•œ ì‚¬í›„ í‰ê°€ ì§€í‘œë¡œ ì‚¬ìš©í•œ ê²ƒì´ë‹¤.</li>
</ul>
</section>
<section id="ê³µë¶„ì‚°-í˜•íƒœë³„-aicbic-ê³¡ì„ ì„-ì‹œê°í™”í•œë‹¤" class="level5">
<h5 class="anchored" data-anchor-id="ê³µë¶„ì‚°-í˜•íƒœë³„-aicbic-ê³¡ì„ ì„-ì‹œê°í™”í•œë‹¤">ê³µë¶„ì‚° í˜•íƒœë³„ AIC/BIC ê³¡ì„ ì„ ì‹œê°í™”í•œë‹¤</h5>
<ul>
<li><code>pivot_bic</code>, <code>pivot_aic</code>ëŠ” K(í–‰) Ã— ê³µë¶„ì‚° í˜•íƒœ(ì—´) êµ¬ì¡°ë¡œ BIC/AICë¥¼ ì¬ë°°ì—´í•œ í‘œì´ë‹¤.</li>
<li>ë§ˆì§€ë§‰ ë‘ ê·¸ë˜í”„ëŠ” (K)ì— ë”°ë¥¸ BIC/AIC ë³€í™”ê°€ ê³µë¶„ì‚° í˜•íƒœë³„ë¡œ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤.</li>
<li>ì´ ì‹œê°í™”ëŠ” (i) ì–´ë–¤ ê³µë¶„ì‚° êµ¬ì¡°ê°€ ìœ ë¦¬í•œì§€, (ii) ì„ íƒë˜ëŠ” (K)ê°€ ì–´ë””ì¸ì§€, (iii) AICì™€ BICê°€ ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ ì„ íƒì„ í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ì§„ë‹¨ ë‹¨ê³„ì´ë‹¤.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans, AgglomerativeClustering</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score, adjusted_rand_score, normalized_mutual_info_score</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 0) ê³µí†µ ì„¤ì •</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>RANDOM_STATE <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ë™ì¼ ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ ë¹„êµ (ê¶Œì¥: í‘œì¤€í™”)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>X_use <span class="op">=</span> X_std   <span class="co"># í•„ìš”í•˜ë©´ Xë¡œ ë³€ê²½ ê°€ëŠ¥</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>K_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">21</span>))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) ë³´ì¡° í•¨ìˆ˜: WSS(Within SS) ê³„ì‚° (ëª¨ë“  ì•Œê³ ë¦¬ì¦˜ ê³µí†µ)</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#    - k-meansëŠ” inertia_ê°€ WSSì™€ ë™ì¼</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#    - ê³„ì¸µêµ°ì§‘ë„ ë¼ë²¨ë§Œ ìˆìœ¼ë©´ centroid ê¸°ë°˜ WSS ê³„ì‚° ê°€ëŠ¥</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_wss(X, labels):</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""ê° êµ°ì§‘ì˜ ì¤‘ì‹¬(í‰ê· ) ê¸°ì¤€ìœ¼ë¡œ WSS = sum ||x - mu_k||^2 ê³„ì‚°"""</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> np.unique(labels):</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        Xk <span class="op">=</span> X[labels <span class="op">==</span> k]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> Xk.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        wss <span class="op">+=</span> ((Xk <span class="op">-</span> mu) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(wss)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> elbow_k_by_second_diff(Ks, wss_values):</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co">    ê°„ë‹¨í•œ Elbow ìë™í™”:</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co">    - WSSë¥¼ 0~1ë¡œ ì •ê·œí™”í•œ ë’¤</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">    - 2ì°¨ ì°¨ë¶„(ê³¡ë¥ )ì´ ê°€ì¥ í° Kë¥¼ elbowë¡œ ì„ íƒ</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    Ks <span class="op">=</span> np.array(Ks, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> np.array(wss_values, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ë‹¨ì¡°ê°ì†Œê°€ ì•„ë‹ ìˆ˜ë„ ìˆëŠ” ìˆ˜ì¹˜ì˜¤ì°¨ ëŒ€ë¹„</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> np.maximum(wss, <span class="dv">0</span>)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ì •ê·œí™” (í° ê°’/ì‘ì€ ê°’ ìŠ¤ì¼€ì¼ ì˜í–¥ ì œê±°)</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    wss_norm <span class="op">=</span> (wss <span class="op">-</span> wss.<span class="bu">min</span>()) <span class="op">/</span> (wss.<span class="bu">max</span>() <span class="op">-</span> wss.<span class="bu">min</span>() <span class="op">+</span> <span class="fl">1e-12</span>)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2ì°¨ ì°¨ë¶„</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    d1 <span class="op">=</span> np.diff(wss_norm)</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    d2 <span class="op">=</span> np.diff(d1)  <span class="co"># ê¸¸ì´: len(Ks)-2</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(d2) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(Ks[<span class="dv">0</span>])</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ê³¡ë¥ ì´ ê°€ì¥ í° ì§€ì (ì ˆëŒ€ê°’ í¬ê²Œ)</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> np.argmax(np.<span class="bu">abs</span>(d2))</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># d2ëŠ” K[0..] ê¸°ì¤€ìœ¼ë¡œ (K[idx+1]) ìœ„ì¹˜ì— í•´ë‹¹</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(Ks[idx <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) (4.2) ì „í†µì  êµ°ì§‘: k-means / ê³„ì¸µêµ°ì§‘(Ward, Complete)</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="co">#    - ê° Kì—ì„œ silhouette, WSS, ARI, NMI ê³„ì‚°</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>records <span class="op">=</span> []</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- (A) k-means ----</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>K, random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> km.fit_predict(X_use)</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    sil <span class="op">=</span> silhouette_score(X_use, z, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="bu">float</span>(km.inertia_)  <span class="co"># = WSS</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    records.append({</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="st">"KMeans"</span>,</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K,</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil,</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss,</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z),</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z)</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- (B) Hierarchical: Ward / Complete ----</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> agglomerative_fit_predict(X, K, linkage):</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sklearn ë²„ì „ í˜¸í™˜(affinity vs metric)</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span>K, linkage<span class="op">=</span>linkage, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">TypeError</span>:</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span>K, linkage<span class="op">=</span>linkage, affinity<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model.fit_predict(X)</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ward</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>    z_ward <span class="op">=</span> agglomerative_fit_predict(X_use, K, linkage<span class="op">=</span><span class="st">"ward"</span>)</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>    sil_ward <span class="op">=</span> silhouette_score(X_use, z_ward, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>    wss_ward <span class="op">=</span> compute_wss(X_use, z_ward)</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>    records.append({</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="st">"Hierarchical(Ward)"</span>,</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K,</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil_ward,</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss_ward,</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_ward),</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_ward)</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Complete</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>    z_comp <span class="op">=</span> agglomerative_fit_predict(X_use, K, linkage<span class="op">=</span><span class="st">"complete"</span>)</span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>    sil_comp <span class="op">=</span> silhouette_score(X_use, z_comp, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>    wss_comp <span class="op">=</span> compute_wss(X_use, z_comp)</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>    records.append({</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="st">"Hierarchical(Complete)"</span>,</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K,</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil_comp,</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss_comp,</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_comp),</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_comp)</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>trad_results <span class="op">=</span> pd.DataFrame(records).sort_values([<span class="st">"method"</span>, <span class="st">"K"</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>display(trad_results.head(<span class="dv">10</span>))</span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) K ì„ íƒ: Silhouette-best + Elbow-best(ìë™) ê°ê° êµ¬í•˜ê¸°</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>best_rows <span class="op">=</span> []</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> trad_results[<span class="st">"method"</span>].unique():</span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>    dfm <span class="op">=</span> trad_results[trad_results[<span class="st">"method"</span>] <span class="op">==</span> m].copy()</span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (i) Silhouette-best</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>    sil_best <span class="op">=</span> dfm.loc[dfm[<span class="st">"silhouette"</span>].idxmax()]</span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (ii) Elbow-best (WSS ê³¡ë¥  ê¸°ë°˜)</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>    elbowK <span class="op">=</span> elbow_k_by_second_diff(dfm[<span class="st">"K"</span>].values, dfm[<span class="st">"wss"</span>].values)</span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>    elbow_row <span class="op">=</span> dfm[dfm[<span class="st">"K"</span>] <span class="op">==</span> elbowK].iloc[<span class="dv">0</span>]</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>    best_rows.append({</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: m,</span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K_sil_best"</span>: <span class="bu">int</span>(sil_best[<span class="st">"K"</span>]),</span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"silhouette"</span>]),</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"wss"</span>]),</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"ARI"</span>]),</span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"NMI"</span>]),</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K_elbow"</span>: <span class="bu">int</span>(elbow_row[<span class="st">"K"</span>]),</span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"silhouette"</span>]),</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"wss"</span>]),</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"ARI"</span>]),</span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"NMI"</span>]),</span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>selection_table <span class="op">=</span> pd.DataFrame(best_rows).sort_values(<span class="st">"method"</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>display(selection_table)</span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) ê·¸ë˜í”„: Elbow(WSS) / Silhouette ê³¡ì„  (ë°©ë²•ë³„)</span></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> trad_results[<span class="st">"method"</span>].unique()</span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a><span class="co"># (A) WSS Elbow</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> methods:</span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>    dfm <span class="op">=</span> trad_results[trad_results[<span class="st">"method"</span>] <span class="op">==</span> m]</span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>    plt.plot(dfm[<span class="st">"K"</span>], dfm[<span class="st">"wss"</span>], marker<span class="op">=</span><span class="st">"o"</span>, label<span class="op">=</span>m)</span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"K"</span>)</span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"WSS (lower is better)"</span>)</span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Elbow Curve (WSS) - Traditional Clustering"</span>)</span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a><span class="co"># (B) Silhouette</span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> methods:</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>    dfm <span class="op">=</span> trad_results[trad_results[<span class="st">"method"</span>] <span class="op">==</span> m]</span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>    plt.plot(dfm[<span class="st">"K"</span>], dfm[<span class="st">"silhouette"</span>], marker<span class="op">=</span><span class="st">"o"</span>, label<span class="op">=</span>m)</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"K"</span>)</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Silhouette (higher is better)"</span>)</span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Silhouette Curve - Traditional Clustering"</span>)</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) GMM(BIC-best)ì™€ ë™ì¼ í˜•ì‹ ë¹„êµí‘œ ë§Œë“¤ê¸°</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a><span class="co">#    - ê¸°ì¡´ ì…€ì—ì„œ best_bic_row, z_bic, results(GMM AIC/BIC table)ê°€ ì¡´ì¬í•œë‹¤ê³  ê°€ì •</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>comparison_rows <span class="op">=</span> []</span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a><span class="co"># (A) GMM(BIC-best) í¬í•¨ (ìˆì„ ë•Œë§Œ)</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"best_bic_row"</span> <span class="kw">in</span> <span class="bu">globals</span>() <span class="kw">and</span> <span class="st">"z_bic"</span> <span class="kw">in</span> <span class="bu">globals</span>():</span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>    K_gmm <span class="op">=</span> <span class="bu">int</span>(best_bic_row[<span class="st">"K"</span>])</span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>    cov_gmm <span class="op">=</span> <span class="bu">str</span>(best_bic_row[<span class="st">"covariance_type"</span>])</span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># silhouette/WSSë„ ê°™ì´ ê³„ì‚°(ë‚´ë¶€ì§€í‘œ í†µì¼)</span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>    sil_gmm <span class="op">=</span> silhouette_score(X_use, z_bic, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>    wss_gmm <span class="op">=</span> compute_wss(X_use, z_bic)</span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AIC/BIC ê°’ë„ ê°™ì´ ì ì–´ë‘ë©´ ë³´ê³ ì„œê°€ ê¹”ë”í•¨</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>    aic_gmm <span class="op">=</span> <span class="bu">float</span>(best_bic_row[<span class="st">"aic"</span>]) <span class="cf">if</span> <span class="st">"aic"</span> <span class="kw">in</span> best_bic_row <span class="cf">else</span> np.nan</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>    bic_gmm <span class="op">=</span> <span class="bu">float</span>(best_bic_row[<span class="st">"bic"</span>]) <span class="cf">if</span> <span class="st">"bic"</span> <span class="kw">in</span> best_bic_row <span class="cf">else</span> np.nan</span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>    comparison_rows.append({</span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="ss">f"GMM(BIC-best, </span><span class="sc">{</span>cov_gmm<span class="sc">}</span><span class="ss">)"</span>,</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K_gmm,</span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil_gmm,</span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss_gmm,</span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_bic),</span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_bic),</span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AIC"</span>: aic_gmm,</span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BIC"</span>: bic_gmm</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"âš ï¸ best_bic_row ë˜ëŠ” z_bicê°€ ì—†ìŠµë‹ˆë‹¤. (GMM ì…€ ì‹¤í–‰ í›„ ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”.)"</span>)</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a><span class="co"># (B) ì „í†µì  êµ°ì§‘: silhouette-best ê¸°ì¤€ìœ¼ë¡œ í•œ ì¤„ì”© ìš”ì•½</span></span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> selection_table.iterrows():</span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a>    comparison_rows.append({</span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: row[<span class="st">"method"</span>] <span class="op">+</span> <span class="st">" (Sil-best)"</span>,</span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: <span class="bu">int</span>(row[<span class="st">"K_sil_best"</span>]),</span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: <span class="bu">float</span>(row[<span class="st">"silhouette_sil_best"</span>]),</span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: <span class="bu">float</span>(row[<span class="st">"wss_sil_best"</span>]),</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: <span class="bu">float</span>(row[<span class="st">"ARI_sil_best"</span>]),</span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: <span class="bu">float</span>(row[<span class="st">"NMI_sil_best"</span>]),</span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AIC"</span>: np.nan,</span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BIC"</span>: np.nan</span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame(comparison_rows)</span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a><span class="co"># ë³´ê¸° ì¢‹ê²Œ ì •ë ¬: ë‚´ë¶€ì§€í‘œ(ì‹¤ë£¨ì—£ ë†’ì€ ìˆœ) ë˜ëŠ” ARI ë†’ì€ ìˆœ</span></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a>comparison_sorted <span class="op">=</span> comparison.sort_values([<span class="st">"ARI"</span>, <span class="st">"silhouette"</span>], ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a>display(comparison_sorted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>BIC ê¸°ì¤€ìœ¼ë¡œ ì„ íƒëœ GMMì€ ëŒ€ê° ê³µë¶„ì‚°(diag)ê³¼ K=20ì„ íƒí•˜ì—¬ ìˆ«ì 10ì¢…ì„ ì§ì ‘ ì¬í˜„í•˜ê¸°ë³´ë‹¤ ìˆ«ì ë‚´ë¶€ì˜ í•„ê¸°ì²´ ë³€ì´ë¥¼ í¬í•¨í•œ ë” ì„¸ë¶„í™”ëœ ì ì¬ì§‘ë‹¨ êµ¬ì¡°ë¥¼ ì œì•ˆí•˜ì˜€ìœ¼ë©°, ê·¸ ê²°ê³¼ ARI/NMIëŠ” ì¤‘ê°„ ìˆ˜ì¤€ì˜ ì™¸ë¶€ ì¼ì¹˜ë„ë¥¼ ë³´ì´ëŠ” ë°˜ë©´ êµ°ì§‘ ê°„ ê±°ë¦¬ ë¶„ë¦¬ë„(silhouette)ëŠ” ë‚®ê²Œ ë‚˜íƒ€ë‚˜ êµ°ì§‘ë“¤ì´ ê³µê°„ìƒìœ¼ë¡œ ê²¹ì¹˜ëŠ” ê²½í–¥ì´ ìˆìŒì„ ì‹œì‚¬í•œë‹¤.</p>
<p>ë°˜ë©´, ì „í†µì  êµ°ì§‘ì—ì„œëŠ” ì‹¤ë£¨ì—£ ì§€í‘œê°€ ê°€ì¥ ë†’ì€ ê³„ì¸µêµ°ì§‘(Complete, K=2)ì´ ê°€ì¥ ë‚®ì€ ARI/NMIë¥¼ ë³´ì´ëŠ” ë°˜ë©´, ì‹¤ë£¨ì—£ì´ ë‚®ì€ Ward êµ°ì§‘(K=20)ì´ ê°€ì¥ ë†’ì€ ARI/NMIë¥¼ ë³´ì—¬, ì‹¤ë£¨ì—£ê³¼ ì™¸ë¶€ ì¼ì¹˜ë„ ê°„ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ê°€ ì¡´ì¬í•¨ì„ ë³´ì—¬ì¤€ë‹¤.</p>
<p><strong>ì™œ K=20ì´ â€œìˆ«ì 10ì¢…â€ì´ ì•„ë‹ˆë¼ â€œë” ì˜ê²Œ ìª¼ê°  êµ¬ì¡°â€ë¼ëŠ” ëœ»ì¸ê°€?</strong></p>
<p>Digitsì˜ ì§„ì§œ ìˆ«ì ë¼ë²¨ì€ 0~9, ì´ 10ê°œì…ë‹ˆë‹¤. ê·¸ëŸ°ë° GMMì´ BICë¡œ ê³ ë¥¸ êµ°ì§‘ ìˆ˜ëŠ” K=20 ì´ë‹¤.</p>
<p>ì´ ë§ì€ GMMì´ â€œ0,1,2,â€¦,9ë¥¼ í•˜ë‚˜ì”© êµ°ì§‘ìœ¼ë¡œ ë§Œë“¤ê² ë‹¤â€ê°€ ì•„ë‹ˆë¼ ì˜ˆë¥¼ ë“¤ì–´ â€˜0ì„ ë‘ ë¶€ë¥˜(ë‘¥ê·¼ 0 / ì°Œê·¸ëŸ¬ì§„ 0)â€™, â€˜1ì„ ë‘ ë¶€ë¥˜(ê°€ëŠë‹¤ë€ 1 / êµµì€ 1)â€™ ì²˜ëŸ¼ ê°™ì€ ìˆ«ì ì•ˆì—ì„œë„ í•„ê¸° ìŠ¤íƒ€ì¼ ì°¨ì´ë¥¼ ë”°ë¡œ êµ°ì§‘ìœ¼ë¡œ ë¶„ë¦¬í–ˆì„ ê°€ëŠ¥ì„±ì´ í¬ë‹¤ëŠ” ëœ»ì´ë‹¤. ì¦‰, ìˆ«ì(10ê°œ) ë³´ë‹¤ ë” ì„¸ë¶„í™”ëœ ì ì¬ì§‘ë‹¨(20ê°œ) ì„ ì œì•ˆí•œ ê²ƒì…ë‹ˆë‹¤.</p>
<p><strong>ARI/NMIê°€ â€œì¤‘ê°„â€ì´ë¼ëŠ” ëœ»ì€?</strong></p>
<p>ARI/NMIëŠ” êµ°ì§‘ ê²°ê³¼ê°€ ì‹¤ì œ ìˆ«ì ë¼ë²¨(0~9)ê³¼ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ë¥¼ ë³´ëŠ” ì ìˆ˜ì´ë‹¤. ê·¸ëŸ°ë° GMMì€ K=20ìœ¼ë¡œ ìˆ«ì í•˜ë‚˜ë¥¼ ì—¬ëŸ¬ êµ°ì§‘ìœ¼ë¡œ ìª¼ê°¤ ìˆ˜ ìˆìœ¼ë‹ˆ, â€œìˆ«ì 10ê°œì™€ 1:1ë¡œ ë”± ë§ëŠ” êµ°ì§‘â€ì´ ë˜ê¸° ì–´ë µë‹¤.</p>
<p>ê·¸ë˜ì„œ ARI/NMIê°€ ì™„ë²½(1ì— ê°€ê¹Œì›€)í•˜ê²Œ ë‚˜ì˜¤ê¸°ë³´ë‹¤ëŠ”, ê·¸ë˜ë„ ìˆ«ì êµ¬ë¶„ì„ ì–´ëŠ ì •ë„ ë°˜ì˜í•˜ë©´ ì¤‘ê°„ ì •ë„ ì ìˆ˜ê°€ ë‚˜ì˜¨ë‹¤.</p>
<p>ì¦‰ â€œì™„ì „í•œ ìˆ«ì ë¶„ë¥˜ëŠ” ì•„ë‹ˆì§€ë§Œ, ìˆ«ì êµ¬ì¡°ì™€ ì–´ëŠ ì •ë„ ê´€ë ¨ì€ ìˆë‹¤â€ëŠ” ì˜ë¯¸ì´ë‹¤.</p>
<p><strong>ê·¸ëŸ°ë° ì™œ silhouetteëŠ” ë‚®ê²Œ ë‚˜ì˜¤ë‚˜?</strong></p>
<p>silhouetteëŠ” â€œêµ°ì§‘ë¼ë¦¬ ê±°ë¦¬ìƒìœ¼ë¡œ ì–¼ë§ˆë‚˜ ë¶„ë¦¬ë˜ì–´ ìˆë‚˜â€ ë¥¼ ë³´ëŠ” ì§€í‘œì´ë‹¤. silhouetteê°€ ë†’ë‹¤ â†’ êµ°ì§‘ë“¤ì´ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆê³  ì„œë¡œ ì˜ êµ¬ë¶„ë¨ silhouetteê°€ ë‚®ë‹¤ â†’ êµ°ì§‘ë“¤ì´ ì„œë¡œ ê°€ê¹Œì´ ì„ì—¬ ìˆìŒ(ê²¹ì¹¨)</p>
<p>DigitsëŠ” ì• ì´ˆì— 3ê³¼ 8, 4ì™€ 9ì²˜ëŸ¼ ëª¨ì–‘ì´ ë¹„ìŠ·í•œ ìˆ«ìë„ ìˆê³ , ë˜ ê°™ì€ ìˆ«ì ì•ˆì—ì„œë„ ë‹¤ì–‘í•œ í•„ê¸°ì²´ê°€ ìˆì–´ì„œ ë°ì´í„°ê°€ ê³µê°„ìƒ ê²¹ì¹˜ê¸° ì‰½ë‹¤. ê·¸ë˜ì„œ GMMì´ 20ê°œë¡œ ì˜ê²Œ ìª¼ê°œë„ ê° êµ°ì§‘ì´ â€œë©€ë¦¬ ë–¨ì–´ì§„ ì„¬â€ì²˜ëŸ¼ ë¶„ë¦¬ë˜ì§€ ì•Šê³ , ê°€ê¹Œìš´ ê³³ì— ê²¹ì³ ìˆëŠ” ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤ â†’ silhouetteê°€ ë‚®ê²Œ ë‚˜ì˜¨ë‹¤.</p>
<p>í•œ ì¤„ë¡œ ë‹¤ì‹œ ë§í•˜ë©´ GMM(BIC-best)ì€ ìˆ«ì 10ê°œë¥¼ ê·¸ëŒ€ë¡œ ë§ì¶”ë ¤ í•˜ê¸°ë³´ë‹¤, ìˆ«ì ì•ˆì˜ ìŠ¤íƒ€ì¼ ì°¨ì´ê¹Œì§€ ë°˜ì˜í•´ 20ê°œë¡œ ì„¸ë¶„í™”í–ˆëŠ”ë°, ê·¸ ì„¸ë¶„í™”ëœ êµ°ì§‘ë“¤ì´ ê±°ë¦¬ ê³µê°„ì—ì„œëŠ” ì„œë¡œ ë§ì´ ê²¹ì³ ë³´ì—¬ silhouetteê°€ ë‚®ê²Œ ë‚˜ì˜¨ë‹¤ëŠ” ëœ»ì´ë‹¤.</p>
<pre class="text"><code>method  K   silhouette  wss ARI NMI
0   Hierarchical(Complete)  2   0.784424    106721.094913   0.000002    0.001556
1   Hierarchical(Complete)  3   0.779755    105134.196220   0.000002    0.002223
2   Hierarchical(Complete)  4   0.733223    102725.043083   -0.000002   0.003753
3   Hierarchical(Complete)  5   0.430919    98680.223906    0.000290    0.020400
4   Hierarchical(Complete)  6   0.432321    97196.179621    0.000353    0.023599
5   Hierarchical(Complete)  7   0.433767    95458.376649    0.000352    0.026290
6   Hierarchical(Complete)  8   0.433629    94923.776923    0.000353    0.026916
7   Hierarchical(Complete)  9   0.384715    93599.700879    0.000311    0.027731
8   Hierarchical(Complete)  10  0.385738    91939.649024    0.000298    0.031561
9   Hierarchical(Complete)  11  0.386541    91283.712892    0.000289    0.032888
method  K_sil_best  silhouette_sil_best wss_sil_best    ARI_sil_best    NMI_sil_best    K_elbow silhouette_elbow    wss_elbow   ARI_elbow   NMI_elbow
0   Hierarchical(Complete)  2   0.784424    106721.094913   0.000002    0.001556    13  0.317344    89979.315231    0.000289    0.036864
1   Hierarchical(Ward)  20  0.152754    54003.237083    0.688082    0.794962    3   0.091561    95529.286988    0.276093    0.493419
2   KMeans  15  0.158307    59534.498937    0.568326    0.688241    18  0.155479    57000.786005    0.524090    0.683195</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_gmm_wss.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_gmm_silhouette.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<pre class="text"><code>method  K   silhouette  wss ARI NMI AIC BIC
0   Hierarchical(Ward) (Sil-best)   20  0.152754    54003.237083    0.688082    0.794962    NaN NaN
1   KMeans (Sil-best)   15  0.158307    59534.498937    0.568326    0.688241    NaN NaN
2   GMM(BIC-best, diag) 20  0.093540    62457.729652    0.437694    0.596951    -232769.805429  -218601.104675
3   Hierarchical(Complete) (Sil-best)   2   0.784424    106721.094913   0.000002    0.001556    NaN NaN</code></pre>
</section>
<section id="gmmbic-best-êµ°ì§‘-ê²°ê³¼-í•´ì„-ìˆ«ì-10ê°œê°€-ì–¼ë§ˆë‚˜-ìª¼ê°œì¡ŒëŠ”ê°€" class="level5">
<h5 class="anchored" data-anchor-id="gmmbic-best-êµ°ì§‘-ê²°ê³¼-í•´ì„-ìˆ«ì-10ê°œê°€-ì–¼ë§ˆë‚˜-ìª¼ê°œì¡ŒëŠ”ê°€">GMM(BIC-best) êµ°ì§‘ ê²°ê³¼ í•´ì„: â€œìˆ«ì 10ê°œê°€ ì–¼ë§ˆë‚˜ ìª¼ê°œì¡ŒëŠ”ê°€?â€</h5>
<p>ì—¬ê¸°ì„œëŠ” GMM(BIC-best) ë¡œ ì–»ì€ êµ°ì§‘ ë¼ë²¨ <code>z_bic</code>ì´ ì‹¤ì œ ìˆ«ì ë¼ë²¨ <code>y(0~9)</code>ì™€ ì–´ë–»ê²Œ ëŒ€ì‘ë˜ëŠ”ì§€ë¥¼ í•´ì„í•œë‹¤. ë¶„ì„ì˜ ì´ˆì ì€ â€œêµ°ì§‘ ìˆ˜ê°€ 10ê°œì¸ê°€?â€ê°€ ì•„ë‹ˆë¼, ê° êµ°ì§‘ì´ ì–¼ë§ˆë‚˜ í•œ ìˆ«ìì— â€˜ìˆœìˆ˜í•˜ê²Œâ€™ ëŒ€ì‘í•˜ëŠ”ê°€(ì„ì„/í˜¼í•©), ê° ìˆ«ìê°€ ëª‡ ê°œì˜ êµ°ì§‘ìœ¼ë¡œ â€™ë¶„í•´â€™ë˜ëŠ”ê°€(ìª¼ê°œì§/ë¶„í• )ë¥¼ ë™ì‹œì— íŒŒì•…í•˜ëŠ” ë° ìˆë‹¤.</p>
</section>
<section id="êµ°ì§‘-ì‹¤ì œ-ìˆ«ì-êµì°¨í‘œ-ë§Œë“¤ê¸°" class="level5">
<h5 class="anchored" data-anchor-id="êµ°ì§‘-ì‹¤ì œ-ìˆ«ì-êµì°¨í‘œ-ë§Œë“¤ê¸°">êµ°ì§‘ Ã— ì‹¤ì œ ìˆ«ì êµì°¨í‘œ ë§Œë“¤ê¸°</h5>
<p>ë¨¼ì € ë‹¤ìŒ êµì°¨í‘œë¥¼ ë§Œë“ ë‹¤. <span class="math inline">\(ct = \text{crosstab}(z_{\text{bic}}, y)\)</span></p>
<ul>
<li>í–‰(row): GMMì´ ë§Œë“  cluster</li>
<li>ì—´(column): ì‹¤ì œ ìˆ«ì digit(0~9)</li>
<li>ì›ì†Œ (ct_{k,d}): â€œêµ°ì§‘ (k)ì— ì†í•œ í‘œë³¸ ì¤‘ ì‹¤ì œ ìˆ«ìê°€ (d)ì¸ ê°œìˆ˜â€</li>
</ul>
<p>ì´ í‘œëŠ” í•œëˆˆì— ë‘ ê°€ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤.</p>
<ul>
<li>êµ°ì§‘ í˜¼í•©(mixing): í•œ êµ°ì§‘ì´ ì—¬ëŸ¬ ìˆ«ìë¥¼ ë™ì‹œì— í¬í•¨í•˜ëŠ”ê°€?</li>
<li>ìˆ«ì ë¶„í• (splitting): í•œ ìˆ«ìê°€ ì—¬ëŸ¬ êµ°ì§‘ì— í©ì–´ì ¸ ìˆëŠ”ê°€?</li>
</ul>
</section>
<section id="êµ°ì§‘ë³„-ëŒ€í‘œ-ìˆ«ìì™€-ìˆœë„purity" class="level5">
<h5 class="anchored" data-anchor-id="êµ°ì§‘ë³„-ëŒ€í‘œ-ìˆ«ìì™€-ìˆœë„purity">êµ°ì§‘ë³„ ëŒ€í‘œ ìˆ«ìì™€ ìˆœë„(purity)</h5>
<p>êµ°ì§‘ (k)ì— ëŒ€í•´ ë‹¤ìŒì„ ê³„ì‚°í•œë‹¤.</p>
<ul>
<li>êµ°ì§‘ í¬ê¸°(í‘œë³¸ ìˆ˜): <span class="math inline">\(n_k = \sum_{d=0}^{9} ct_{k,d}\)</span></li>
<li>ëŒ€í‘œ ìˆ«ì(ë‹¤ìˆ˜ê²°): <span class="math inline">\(d_k^* = \arg\max_d ct_{k,d}\)</span></li>
<li>ëŒ€í‘œ ìˆ«ìì˜ ê°œìˆ˜: <span class="math inline">\(m_k = \max_d ct_{k,d}\)</span></li>
<li>êµ°ì§‘ ìˆœë„(purity): <span class="math inline">\(\text{purity}_k = \frac{m_k}{n_k}\)</span></li>
</ul>
<p><strong>í•´ì„</strong></p>
<ul>
<li><span class="math inline">\(\text{purity}_k \approx 1\)</span> ì´ë©´ â†’ êµ°ì§‘ (k)ëŠ” ê±°ì˜ í•˜ë‚˜ì˜ ìˆ«ìì— ëŒ€ì‘í•˜ëŠ” ìˆœìˆ˜ êµ°ì§‘ì´ë‹¤.</li>
<li><span class="math inline">\(\text{purity}_k\)</span> ê°€ ë‚®ìœ¼ë©´ â†’ êµ°ì§‘ (k)ëŠ” ì—¬ëŸ¬ ìˆ«ìê°€ ì„ì¸ í˜¼í•© êµ°ì§‘ì´ë‹¤.</li>
</ul>
<p>ì‹¤ì œ ì½”ë“œì—ì„œëŠ” <code>cluster_summary</code> í‘œë¡œ (êµ°ì§‘ í¬ê¸°, ëŒ€í‘œ ìˆ«ì, ìˆœë„)ë¥¼ ì •ë¦¬í•´ êµ°ì§‘ í•´ì„ì˜ ì¶œë°œì ìœ¼ë¡œ ì‚¼ëŠ”ë‹¤.</p>
</section>
<section id="ì „ì²´-ìˆœë„overall-purity-ë‹¤ìˆ˜ê²°-ê¸°ì¤€-ë‹¨ì¼-ìš”ì•½-ì§€í‘œ" class="level5">
<h5 class="anchored" data-anchor-id="ì „ì²´-ìˆœë„overall-purity-ë‹¤ìˆ˜ê²°-ê¸°ì¤€-ë‹¨ì¼-ìš”ì•½-ì§€í‘œ">ì „ì²´ ìˆœë„(Overall Purity): ë‹¤ìˆ˜ê²° ê¸°ì¤€ ë‹¨ì¼ ìš”ì•½ ì§€í‘œ</h5>
<p>êµ°ì§‘ë³„ ìˆœë„ë¥¼ í•œ ì¤„ë¡œ ìš”ì•½í•œ ì§€í‘œê°€ overall purity(majority-vote overall purity)ì´ë‹¤.</p>
<p><span class="math inline">\(\frac{\sum_k m_k}{n}\)</span></p>
<ul>
<li><span class="math inline">\(\sum_k m_k\)</span> : ê° êµ°ì§‘ì—ì„œ ê°€ì¥ ë§ì´ ë“±ì¥í•œ ìˆ«ìì˜ ê°œìˆ˜ë¥¼ ëª¨ë‘ í•©í•œ ê°’</li>
<li>n: ì „ì²´ í‘œë³¸ ìˆ˜</li>
</ul>
<p><strong>ì˜ë¯¸(ê°•ì˜ìš© ì§ê´€)</strong></p>
<p>â€œê° êµ°ì§‘ì— ëŒ€í‘œ ìˆ«ì ë¼ë²¨ì„ í•˜ë‚˜ ë¶™ì´ê³ (ë‹¤ìˆ˜ê²°), ê·¸ë ‡ê²Œ ë¶„ë¥˜í–ˆë‹¤ê³  ìƒê°í•˜ë©´ ì „ì²´ì ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ë§ëŠ”ê°€?â€ ì¦‰, êµ°ì§‘ ê²°ê³¼ë¥¼ ê°€ì¥ ë‹¨ìˆœí•œ ë°©ì‹ìœ¼ë¡œ ìˆ«ìì™€ ë§¤í•‘í–ˆì„ ë•Œì˜ ì „ì²´ ì •í™•ë„ì— í•´ë‹¹í•˜ëŠ” ìš”ì•½ê°’ì´ë‹¤.</p>
</section>
<section id="ìˆ«ìë³„-ìª¼ê°œì§ë¶„í• ì„-ì •ëŸ‰í™”í•˜ê¸°" class="level5">
<h5 class="anchored" data-anchor-id="ìˆ«ìë³„-ìª¼ê°œì§ë¶„í• ì„-ì •ëŸ‰í™”í•˜ê¸°">ìˆ«ìë³„ â€œìª¼ê°œì§(ë¶„í• )â€ì„ ì •ëŸ‰í™”í•˜ê¸°</h5>
<p>ì´ë²ˆì—ëŠ” êµ°ì§‘ ê´€ì ì´ ì•„ë‹ˆë¼ ìˆ«ì ê´€ì ìœ¼ë¡œ ë³¸ë‹¤. ê° ìˆ«ì (d)ê°€ êµ°ì§‘ë“¤ì— ì–´ë–»ê²Œ ë¶„í¬í•˜ëŠ”ì§€ë¥¼ ë³´ê³ , â€œëª‡ ê°œ êµ°ì§‘ìœ¼ë¡œ ë¶„í•´ë˜ëŠ”ê°€?â€ë¥¼ ê³„ì‚°í•œë‹¤.</p>
<p><strong>(A) 80%ë¥¼ ì„¤ëª…í•˜ëŠ” ìµœì†Œ êµ°ì§‘ ìˆ˜</strong></p>
<p>ìˆ«ì (d) í‘œë³¸ì„ ë§ì´ ë‹´ê³  ìˆëŠ” êµ°ì§‘ë¶€í„° ì •ë ¬í•œ ë’¤, ëˆ„ì  ë¹„ìœ¨ì´ 80%ë¥¼ ë„˜ëŠ” ë° í•„ìš”í•œ êµ°ì§‘ ê°œìˆ˜ë¥¼ ê³„ì‚°í•œë‹¤. <span class="math inline">\(k_{80\%}(d)\)</span></p>
<ul>
<li>ê°’ì´ 1ì´ë©´ â†’ ê±°ì˜ í•œ êµ°ì§‘ì— ì§‘ì¤‘(ìª¼ê°œì§ì´ ì‘ìŒ)</li>
<li>ê°’ì´ í¬ë©´ â†’ ì—¬ëŸ¬ êµ°ì§‘ìœ¼ë¡œ ë¶„ì‚°(ìª¼ê°œì§ì´ í¼)</li>
</ul>
<p><strong>(B) ìœ ì˜ë¯¸í•œ ë¶„í•  êµ°ì§‘ ìˆ˜(ì˜ˆ: 10ê°œ ì´ìƒ í¬í•¨)</strong></p>
<p>ì•„ì£¼ ì†ŒëŸ‰(ëª‡ ê°œ) í©ì–´ì§„ ê²ƒì€ ë…¸ì´ì¦ˆì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì˜ˆë¥¼ ë“¤ì–´ â€œí•´ë‹¹ ìˆ«ìê°€ 10ê°œ ì´ìƒ ë“¤ì–´ìˆëŠ” êµ°ì§‘ì´ ëª‡ ê°œì¸ê°€â€ë¥¼ í•¨ê»˜ ë³¸ë‹¤.</p>
</section>
<section id="íˆíŠ¸ë§µìœ¼ë¡œ-ì„ì„ìª¼ê°œì§ì„-í•œ-ë²ˆì—-ë³´ê¸°" class="level5">
<h5 class="anchored" data-anchor-id="íˆíŠ¸ë§µìœ¼ë¡œ-ì„ì„ìª¼ê°œì§ì„-í•œ-ë²ˆì—-ë³´ê¸°">íˆíŠ¸ë§µìœ¼ë¡œ â€œì„ì„/ìª¼ê°œì§â€ì„ í•œ ë²ˆì— ë³´ê¸°</h5>
<p>êµì°¨í‘œ (ct)ë¥¼ íˆíŠ¸ë§µìœ¼ë¡œ ê·¸ë¦¬ë©´,</p>
<ul>
<li>íŠ¹ì • ìˆ«ì ì—´(column)ì´ ì—¬ëŸ¬ êµ°ì§‘ í–‰(row)ìœ¼ë¡œ í¼ì ¸ ìˆìœ¼ë©´ â†’ ê·¸ ìˆ«ìëŠ” ìª¼ê°œì§</li>
<li>íŠ¹ì • êµ°ì§‘ í–‰(row)ì´ ì—¬ëŸ¬ ìˆ«ì ì—´(column)ì— ê±¸ì³ ìˆìœ¼ë©´ â†’ ê·¸ êµ°ì§‘ì€ ì„ì„</li>
</ul>
<p>ë˜í•œ êµ°ì§‘ ë²ˆí˜¸ëŠ” ì„ì˜ì´ë¯€ë¡œ, ë³´ê¸° ì¢‹ê²Œ ëŒ€í‘œ ìˆ«ì â†’ ìˆœë„ â†’ í¬ê¸° ìˆœìœ¼ë¡œ êµ°ì§‘ì„ ì •ë ¬í•´ ì‹œê°í™”í•˜ë©´ í•´ì„ì´ í›¨ì”¬ ì‰¬ì›Œì§„ë‹¤.</p>
</section>
<section id="ìˆ«ìë³„-ìƒìœ„-êµ°ì§‘-ë¹„ì¤‘top3-share-ì¶œë ¥ì˜-ì˜ë¯¸" class="level5">
<h5 class="anchored" data-anchor-id="ìˆ«ìë³„-ìƒìœ„-êµ°ì§‘-ë¹„ì¤‘top3-share-ì¶œë ¥ì˜-ì˜ë¯¸">ìˆ«ìë³„ ìƒìœ„ êµ°ì§‘ ë¹„ì¤‘(top3 share) ì¶œë ¥ì˜ ì˜ë¯¸</h5>
<p>ê° ìˆ«ì (d)ì— ëŒ€í•´, ê·¸ ìˆ«ì í‘œë³¸ì„ ê°€ì¥ ë§ì´ ë‹´ëŠ” ìƒìœ„ 3ê°œ êµ°ì§‘ì˜ ë¹„ìœ¨ì„ ì¶œë ¥í•œë‹¤.</p>
<ul>
<li>ìƒìœ„ 1~3ê°œ ë¹„ì¤‘ì´ ë§¤ìš° ë†’ë‹¤ â†’ í•´ë‹¹ ìˆ«ìëŠ” ì†Œìˆ˜ êµ°ì§‘ì— ì§‘ì¤‘(ìª¼ê°œì§ì´ ì‘ìŒ)</li>
<li>ìƒìœ„ 3ê°œ ë¹„ì¤‘ì´ ë‚®ê³  êµ°ì§‘ì´ ë§ì´ ë“±ì¥í•œë‹¤ â†’ í•´ë‹¹ ìˆ«ìëŠ” ë‹¤ì–‘í•œ í˜•íƒœë¡œ ì—¬ëŸ¬ êµ°ì§‘ì— ë¶„í•´(ìª¼ê°œì§ì´ í¼)</li>
</ul>
</section>
<section id="í•µì‹¬-ì •ë¦¬í•œ-ë¬¸ë‹¨" class="level5">
<h5 class="anchored" data-anchor-id="í•µì‹¬-ì •ë¦¬í•œ-ë¬¸ë‹¨">í•µì‹¬ ì •ë¦¬(í•œ ë¬¸ë‹¨)</h5>
<p>GMM(BIC-best) êµ°ì§‘ ê²°ê³¼ëŠ” ë‹¨ìˆœíˆ â€œ10ê°œ ìˆ«ìë¥¼ 10ê°œ êµ°ì§‘ìœ¼ë¡œ ë§ì·„ëŠ”ê°€â€ë³´ë‹¤, ìˆ«ìë³„ í˜•íƒœ ë‹¤ì–‘ì„± ë•Œë¬¸ì— í•˜ë‚˜ì˜ ìˆ«ìê°€ ì—¬ëŸ¬ êµ°ì§‘ìœ¼ë¡œ ë¶„í•´ë˜ëŠ” í˜„ìƒê³¼ êµ°ì§‘ ë‚´ë¶€ì— ì—¬ëŸ¬ ìˆ«ìê°€ ì„ì´ëŠ” í˜„ìƒì„ í•¨ê»˜ ë³´ì—¬ì¤€ë‹¤. ì´ë•Œ êµ°ì§‘ë³„ ìˆœë„ëŠ” â€œêµ°ì§‘ì´ ì–¼ë§ˆë‚˜ ìˆœìˆ˜í•œê°€â€ë¥¼, ìˆ«ìë³„ ë¶„í•  ì§€í‘œëŠ” â€œìˆ«ìê°€ ì–¼ë§ˆë‚˜ ìª¼ê°œì¡ŒëŠ”ê°€â€ë¥¼ ë‚˜íƒ€ë‚´ë©°, overall purity(majority vote) ëŠ” ì „ì²´ì ì¸ êµ¬ì¡° ëŒ€ì‘ ìˆ˜ì¤€ì„ í•œ ì¤„ë¡œ ìš”ì•½í•œë‹¤.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== 0) êµì°¨í‘œ(í´ëŸ¬ìŠ¤í„° x ì‹¤ì œ ìˆ«ì) =====</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ct <span class="op">=</span> pd.crosstab(z_bic, y, rownames<span class="op">=</span>[<span class="st">"cluster"</span>], colnames<span class="op">=</span>[<span class="st">"digit"</span>])</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>display(ct)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== 1) ê° í´ëŸ¬ìŠ¤í„°ì˜ ëŒ€í‘œ ìˆ«ì(ë‹¤ìˆ˜ê²°)ì™€ ìˆœë„(purity) =====</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>cluster_size <span class="op">=</span> ct.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>major_digit <span class="op">=</span> ct.idxmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>major_count <span class="op">=</span> ct.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>cluster_purity <span class="op">=</span> (major_count <span class="op">/</span> cluster_size)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>cluster_summary <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"size"</span>: cluster_size,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"major_digit"</span>: major_digit,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"major_count"</span>: major_count,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"purity"</span>: cluster_purity</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>}).sort_values([<span class="st">"purity"</span>,<span class="st">"size"</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Cluster summary (major digit &amp; purity) ==="</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>display(cluster_summary)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== 2) â€œí•œ ìˆ«ì(digit)ê°€ ëª‡ ê°œ í´ëŸ¬ìŠ¤í„°ë¡œ ìª¼ê°œì¡ŒëŠ”ê°€?â€ =====</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ê¸°ì¤€ A: ê·¸ ìˆ«ì ìƒ˜í”Œ ì¤‘ 80%ë¥¼ ì„¤ëª…í•˜ëŠ” ë° í•„ìš”í•œ í´ëŸ¬ìŠ¤í„° ê°œìˆ˜</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ê¸°ì¤€ B: ê·¸ ìˆ«ìì—ì„œ í‘œë³¸ì´ ì¼ì • ì´ìƒ(ì˜ˆ: &gt;=10ê°œ) ë“¤ì–´ìˆëŠ” í´ëŸ¬ìŠ¤í„° ê°œìˆ˜</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>cover_rate <span class="op">=</span> <span class="fl">0.80</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>digit_rows <span class="op">=</span> []</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> d <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    col <span class="op">=</span> ct[d]</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="bu">int</span>(col.<span class="bu">sum</span>())</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> total <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># í´ëŸ¬ìŠ¤í„°ë³„ë¡œ í•´ë‹¹ ìˆ«ì count ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    counts_sorted <span class="op">=</span> col.sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (A) ìƒìœ„ ëª‡ ê°œ í´ëŸ¬ìŠ¤í„°ê°€ cover_rate(ì˜ˆ: 80%)ë¥¼ ì»¤ë²„í•˜ëŠ”ê°€</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    cum <span class="op">=</span> counts_sorted.cumsum() <span class="op">/</span> total</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    k_cover <span class="op">=</span> <span class="bu">int</span>((cum <span class="op">&lt;</span> cover_rate).<span class="bu">sum</span>() <span class="op">+</span> <span class="dv">1</span>)  <span class="co"># 80% ë„˜ê¸°ëŠ” ìµœì†Œ ê°œìˆ˜</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (B) í‘œë³¸ì´ threshold ì´ìƒ ë“¤ì–´ìˆëŠ” í´ëŸ¬ìŠ¤í„° ê°œìˆ˜(ìœ ì˜ë¯¸í•œ ë¶„í•  ìˆ˜)</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    k_ge_thr <span class="op">=</span> <span class="bu">int</span>((counts_sorted <span class="op">&gt;=</span> threshold).<span class="bu">sum</span>())</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ìƒìœ„ 5ê°œ í´ëŸ¬ìŠ¤í„° ë¹„ì¤‘(ì–´ë””ì— ëª°ë ¤ ìˆëŠ”ì§€)</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    top5 <span class="op">=</span> (counts_sorted.head(<span class="dv">5</span>) <span class="op">/</span> total).values</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    digit_rows.append({</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">"digit"</span>: d,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"n_samples"</span>: total,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"clusters_to_cover_</span><span class="sc">{</span><span class="bu">int</span>(cover_rate<span class="op">*</span><span class="dv">100</span>)<span class="sc">}</span><span class="ss">%"</span>: k_cover,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"clusters_with_&gt;=_</span><span class="sc">{</span>threshold<span class="sc">}</span><span class="ss">"</span>: k_ge_thr,</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"top1_share"</span>: top5[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(top5)<span class="op">&gt;</span><span class="dv">0</span> <span class="cf">else</span> np.nan,</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"top2_share"</span>: (top5[<span class="dv">0</span>]<span class="op">+</span>top5[<span class="dv">1</span>]) <span class="cf">if</span> <span class="bu">len</span>(top5)<span class="op">&gt;</span><span class="dv">1</span> <span class="cf">else</span> np.nan,</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"top5_share"</span>: np.<span class="bu">sum</span>(top5) <span class="cf">if</span> <span class="bu">len</span>(top5)<span class="op">&gt;</span><span class="dv">0</span> <span class="cf">else</span> np.nan,</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>digit_split <span class="op">=</span> pd.DataFrame(digit_rows).sort_values(<span class="st">"digit"</span>)</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Digit split summary ==="</span>)</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>display(digit_split)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== 3) íˆíŠ¸ë§µ(í´ëŸ¬ìŠ¤í„° x ìˆ«ì)ë¡œ â€œìª¼ê°œì§/ì„ì„â€ ì‹œê°í™” =====</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="co"># ë³´ê¸° ì¢‹ê²Œ: í´ëŸ¬ìŠ¤í„°ë¥¼ ëŒ€í‘œìˆ«ìâ†’ìˆœë„â†’í¬ê¸° ìˆœìœ¼ë¡œ ì •ë ¬</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> cluster_summary.sort_values([<span class="st">"major_digit"</span>,<span class="st">"purity"</span>,<span class="st">"size"</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]).index</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>ct_ordered <span class="op">=</span> ct.loc[order]</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>plt.imshow(ct_ordered.values, aspect<span class="op">=</span><span class="st">"auto"</span>)</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>plt.colorbar(label<span class="op">=</span><span class="st">"count"</span>)</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"digit (0~9)"</span>)</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"cluster (ordered)"</span>)</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GMM(BIC-best) cluster x digit counts"</span>)</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>np.arange(<span class="dv">10</span>), labels<span class="op">=</span>np.arange(<span class="dv">10</span>))</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>plt.yticks([])  <span class="co"># í´ëŸ¬ìŠ¤í„°ê°€ ë§ìœ¼ë‹ˆ yì¶• ë¼ë²¨ì€ ìƒëµ</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== 4) (ì„ íƒ) â€œìˆ«ìë³„ë¡œ ìƒìœ„ í´ëŸ¬ìŠ¤í„° 3ê°œâ€ ì¶œë ¥ =====</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> d <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> ct[d].sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> s.<span class="bu">sum</span>()</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    top3 <span class="op">=</span> (s.head(<span class="dv">3</span>) <span class="op">/</span> total).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"digit </span><span class="sc">{</span>d<span class="sc">}</span><span class="ss">: top3 clusters shares -&gt; </span><span class="sc">{</span>top3<span class="sc">.</span>to_dict()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>digit   0   1   2   3   4   5   6   7   8   9
cluster                                     
0   2   84  4   10  2   7   7   6   19  2
1   0   0   0   0   0   92  0   0   0   0
2   0   0   0   0   87  0   0   0   0   0
3   0   0   0   103 0   0   0   0   1   0
4   0   0   0   0   3   0   0   19  0   2
5   0   0   0   0   2   1   131 0   0   0
6   0   26  2   14  3   16  1   1   84  21
7   3   2   3   10  1   24  3   0   36  38
8   0   0   0   2   2   11  0   99  0   3
9   2   0   0   20  0   23  0   0   0   66
10  0   0   0   0   30  0   0   4   0   11
11  0   0   0   0   43  0   0   0   0   0
12  0   0   0   0   0   0   0   50  0   0
13  0   1   81  4   0   0   0   0   3   0
14  0   4   65  19  0   6   0   0   18  15
15  0   1   0   0   0   0   0   0   0   0
16  0   0   1   0   0   0   0   0   0   0
17  168 0   0   0   1   0   0   0   0   0
18  2   41  8   0   7   0   1   0   9   6
19  1   23  13  1   0   2   38  0   4   16
=== Cluster summary (major digit &amp; purity) ===
size    major_digit major_count purity
cluster             
1   92  5   92  1.000000
2   87  4   87  1.000000
12  50  7   50  1.000000
11  43  4   43  1.000000
15  1   1   1   1.000000
16  1   2   1   1.000000
17  169 0   168 0.994083
3   104 3   103 0.990385
5   134 6   131 0.977612
13  89  2   81  0.910112
8   117 7   99  0.846154
4   24  7   19  0.791667
10  45  4   30  0.666667
9   111 9   66  0.594595
0   143 1   84  0.587413
18  74  1   41  0.554054
14  127 2   65  0.511811
6   168 8   84  0.500000
19  98  6   38  0.387755
7   120 9   38  0.316667
=== Digit split summary ===
digit   n_samples   clusters_to_cover_80%   clusters_with_&gt;=_10 top1_share  top2_share  top5_share
0   0   178 1   1   0.943820    0.960674    0.994382
1   1   182 3   4   0.461538    0.686813    0.978022
2   2   177 2   3   0.457627    0.824859    0.966102
3   3   183 4   6   0.562842    0.672131    0.907104
4   4   181 3   3   0.480663    0.718232    0.939227
5   5   182 4   5   0.505495    0.637363    0.912088
6   6   181 2   2   0.723757    0.933702    0.994475
7   7   179 2   3   0.553073    0.832402    0.994413
8   8   174 4   4   0.482759    0.689655    0.954023
9   9   180 5   6   0.366667    0.577778    0.866667</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_gmm_heatmap.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<pre class="text"><code>digit 0: top3 clusters shares -&gt; {17: 0.944, 7: 0.017, 0: 0.011}
digit 1: top3 clusters shares -&gt; {0: 0.462, 18: 0.225, 6: 0.143}
digit 2: top3 clusters shares -&gt; {13: 0.458, 14: 0.367, 19: 0.073}
digit 3: top3 clusters shares -&gt; {3: 0.563, 9: 0.109, 14: 0.104}
digit 4: top3 clusters shares -&gt; {2: 0.481, 11: 0.238, 10: 0.166}
digit 5: top3 clusters shares -&gt; {1: 0.505, 7: 0.132, 9: 0.126}
digit 6: top3 clusters shares -&gt; {5: 0.724, 19: 0.21, 0: 0.039}
digit 7: top3 clusters shares -&gt; {8: 0.553, 12: 0.279, 4: 0.106}
digit 8: top3 clusters shares -&gt; {6: 0.483, 7: 0.207, 0: 0.109}
digit 9: top3 clusters shares -&gt; {9: 0.367, 7: 0.211, 6: 0.117}</code></pre>
</section>
</section>
<section id="ì „í†µì -êµ°ì§‘ë¶„ì„traditional-clustering" class="level4">
<h4 class="anchored" data-anchor-id="ì „í†µì -êµ°ì§‘ë¶„ì„traditional-clustering">3. ì „í†µì  êµ°ì§‘ë¶„ì„(Traditional Clustering)</h4>
<p>ì´ ì ˆì˜ ì½”ë“œëŠ” ê±°ë¦¬ ê¸°ë°˜ ì „í†µì  êµ°ì§‘ë°©ë²•ì¸ K-meansì™€ ê³„ì¸µì  êµ°ì§‘(Agglomerative Clustering: Ward, Complete)ì„ ë™ì¼ ë°ì´í„°ì—ì„œ ë¹„êµí•œë‹¤. ë¹„êµ ê¸°ì¤€ì€ ë‚´ë¶€ í‰ê°€ ì§€í‘œì¸ Silhouetteì™€ WSS(Within-cluster Sum of Squares), ê·¸ë¦¬ê³  ì‹¤ì œ ë¼ë²¨ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë§Œ ê³„ì‚° ê°€ëŠ¥í•œ ì™¸ë¶€ í‰ê°€ ì§€í‘œ ARIì™€ NMIì´ë‹¤. ì™¸ë¶€ ì§€í‘œëŠ” ë¹„ì§€ë„ í•™ìŠµì˜ ì¼ë°˜ì  ìƒí™©ì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë©°, ì—¬ê¸°ì„œëŠ” í‰ê°€ ëª©ì ìœ¼ë¡œë§Œ í™œìš©ëœë‹¤.</p>
<section id="ê¸°ë³¸-ì„¤ì •ê³¼-ë°ì´í„°-ì¤€ë¹„" class="level5">
<h5 class="anchored" data-anchor-id="ê¸°ë³¸-ì„¤ì •ê³¼-ë°ì´í„°-ì¤€ë¹„">ê¸°ë³¸ ì„¤ì •ê³¼ ë°ì´í„° ì¤€ë¹„</h5>
<p>ì½”ë“œëŠ” numpy, pandas, matplotlibì„ ë¶ˆëŸ¬ì˜¤ê³  êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ê³¼ í‰ê°€ ì§€í‘œë¥¼ importí•œë‹¤.</p>
<ul>
<li>êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜: KMeans, AgglomerativeClustering</li>
<li>í‰ê°€ ì§€í‘œ: silhouette_score, adjusted_rand_score, normalized_mutual_info_score</li>
</ul>
<p>ë‚œìˆ˜ ê³ ì •ê°’ RANDOM_STATE=42ë¥¼ ì„¤ì •í•˜ì—¬ ê²°ê³¼ ì¬í˜„ì„±ì„ í™•ë³´í•œë‹¤.</p>
<p>ê±°ë¦¬ ê¸°ë°˜ êµ°ì§‘ì€ ë³€ìˆ˜ ìŠ¤ì¼€ì¼ì˜ ì˜í–¥ì„ í¬ê²Œ ë°›ìœ¼ë¯€ë¡œ, ë¶„ì„ì—ëŠ” í‘œì¤€í™”ëœ ë°ì´í„° X_stdë¥¼ ì‚¬ìš©í•œë‹¤. ë˜í•œ êµ°ì§‘ ìˆ˜ í›„ë³´ëŠ” K=2ë¶€í„° K=20ê¹Œì§€ ì„¤ì •í•˜ì—¬ ìµœì  Kë¥¼ íƒìƒ‰í•œë‹¤.</p>
</section>
<section id="wss-ê³„ì‚°-í•¨ìˆ˜ì˜-ì˜ë¯¸" class="level5">
<h5 class="anchored" data-anchor-id="wss-ê³„ì‚°-í•¨ìˆ˜ì˜-ì˜ë¯¸">WSS ê³„ì‚° í•¨ìˆ˜ì˜ ì˜ë¯¸</h5>
<p>WSSëŠ” êµ°ì§‘ ë‚´ë¶€ ì‘ì§‘ë„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ëŒ€í‘œì ì¸ ì§€í‘œì´ë‹¤. <span class="math inline">\(WSS = \sum_{k=1}^{K}\sum_{i \in C_k} |x_i - \mu_k|^2\)</span>. ì—¬ê¸°ì„œ <span class="math inline">\(\mu_k\)</span> ëŠ” êµ°ì§‘ kì˜ ì¤‘ì‹¬ì´ë‹¤.</p>
<p>K-meansëŠ” inertia_ë¡œ WSSë¥¼ ì§ì ‘ ì œê³µí•˜ì§€ë§Œ, ê³„ì¸µêµ°ì§‘ì€ ê·¸ë ‡ì§€ ì•Šë‹¤. ë”°ë¼ì„œ compute_wss(X, labels) í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ëª¨ë“  ë°©ë²•ì— ë™ì¼í•œ ì •ì˜ì˜ WSSë¥¼ ì ìš©í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì„œë¡œ ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ì„ ê³µì •í•˜ê²Œ ë¹„êµí•  ìˆ˜ ìˆë‹¤.</p>
</section>
<section id="elbow-ìë™-ì„ íƒ-í•¨ìˆ˜" class="level5">
<h5 class="anchored" data-anchor-id="elbow-ìë™-ì„ íƒ-í•¨ìˆ˜">Elbow ìë™ ì„ íƒ í•¨ìˆ˜</h5>
<p>Elbow ë°©ë²•ì€ WSS ê°ì†Œ ê³¡ì„ ì—ì„œ êº¾ì´ëŠ” ì§€ì ì„ ì°¾ì•„ ì ì ˆí•œ Kë¥¼ ì„ íƒí•˜ëŠ” ë°©ì‹ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œëŠ” ê·¸ë˜í”„ë¥¼ ë³´ê³  ì‚¬ëŒì´ íŒë‹¨í•˜ì§€ë§Œ, ì½”ë“œì—ì„œëŠ” 2ì°¨ ì°¨ë¶„ì„ ì´ìš©í•´ ìë™ìœ¼ë¡œ êº¾ì„ì´ í° ì§€ì ì„ ì°¾ëŠ”ë‹¤.</p>
<p>ì ˆì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
<li>WSS ê°’ì„ 0~1 ë²”ìœ„ë¡œ ì •ê·œí™”</li>
<li>1ì°¨ ì°¨ë¶„ê³¼ 2ì°¨ ì°¨ë¶„ ê³„ì‚°</li>
<li>2ì°¨ ì°¨ë¶„ ì ˆëŒ“ê°’ì´ ê°€ì¥ í° ì§€ì ì„ Elbowë¡œ ì„ íƒ</li>
</ul>
<p>ì´ëŠ” WSS ê°ì†Œ ì†ë„ê°€ ê¸‰ê²©íˆ ì™„ë§Œí•´ì§€ëŠ” ì§€ì ì„ ìˆ˜ì¹˜ì ìœ¼ë¡œ íƒì§€í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>
</section>
<section id="kë³„-êµ°ì§‘-ìˆ˜í–‰-ë°-ì§€í‘œ-ê³„ì‚°" class="level5">
<h5 class="anchored" data-anchor-id="kë³„-êµ°ì§‘-ìˆ˜í–‰-ë°-ì§€í‘œ-ê³„ì‚°">Kë³„ êµ°ì§‘ ìˆ˜í–‰ ë° ì§€í‘œ ê³„ì‚°</h5>
<p>ê° K(2~20)ì— ëŒ€í•´ ë‹¤ìŒ ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤.</p>
<p><strong>(1) K-means</strong></p>
<p>ê° Kì— ëŒ€í•´ KMeansë¥¼ ì‹¤í–‰í•˜ê³  êµ°ì§‘ ë¼ë²¨ zë¥¼ ì–»ëŠ”ë‹¤.</p>
<ul>
<li>Silhouette ê³„ì‚°</li>
<li>WSSëŠ” inertia_ ì‚¬ìš©</li>
<li>ARI, NMIëŠ” ì‹¤ì œ ë¼ë²¨ yì™€ ë¹„êµí•˜ì—¬ ê³„ì‚°</li>
</ul>
<p>SilhouetteëŠ” êµ°ì§‘ ë‚´ë¶€ ì‘ì§‘ë„ì™€ êµ°ì§‘ ê°„ ë¶„ë¦¬ë„ë¥¼ ë™ì‹œì— ë°˜ì˜í•˜ë©° ê°’ì´ í´ìˆ˜ë¡ ì¢‹ë‹¤. WSSëŠ” ì‘ì„ìˆ˜ë¡ ì¢‹ë‹¤. ARIì™€ NMIëŠ” ì‹¤ì œ êµ¬ì¡°ì™€ì˜ ì¼ì¹˜ë„ë¥¼ ë‚˜íƒ€ë‚´ë©° í´ìˆ˜ë¡ ì¢‹ë‹¤.</p>
<p><strong>(2) ê³„ì¸µêµ°ì§‘: Ward, Complete</strong></p>
<p>AgglomerativeClusteringì„ ì‚¬ìš©í•˜ì—¬ êµ°ì§‘ì„ ìƒì„±í•œë‹¤. WardëŠ” ë¶„ì‚° ì¦ê°€ë¥¼ ìµœì†Œí™”í•˜ëŠ” ë°©ì‹ì´ë©°, CompleteëŠ” ìµœëŒ€ ê±°ë¦¬ ê¸°ì¤€ìœ¼ë¡œ êµ°ì§‘ì„ ë³‘í•©í•œë‹¤.</p>
<p>ê³„ì¸µêµ°ì§‘ì€ inertiaê°€ ì—†ìœ¼ë¯€ë¡œ compute_wssë¡œ WSSë¥¼ ê³„ì‚°í•œë‹¤. Silhouetteì™€ ì™¸ë¶€ ì§€í‘œ ì—­ì‹œ ë™ì¼í•˜ê²Œ ê³„ì‚°í•œë‹¤.</p>
<p>ì´ ê³¼ì •ì„ í†µí•´ ë°©ë²• Ã— K ì¡°í•©ë³„ ì„±ëŠ¥ì´ trad_resultsì— ì €ì¥ëœë‹¤.</p>
</section>
<section id="k-ì„ íƒ-ê¸°ì¤€-ë¹„êµ" class="level5">
<h5 class="anchored" data-anchor-id="k-ì„ íƒ-ê¸°ì¤€-ë¹„êµ">K ì„ íƒ ê¸°ì¤€ ë¹„êµ</h5>
<p>ë°©ë²•ë³„ë¡œ ë‘ ê°€ì§€ ê¸°ì¤€ì„ ì ìš©í•œë‹¤.</p>
<ul>
<li>Silhouetteê°€ ìµœëŒ€ê°€ ë˜ëŠ” K ì„ íƒ: <span class="math inline">\(K^*_{sil} = \arg\max_K silhouette(K)\)</span></li>
<li>Elbow ìë™ ì„ íƒ K: ì´ ë‘ ê¸°ì¤€ìœ¼ë¡œ ì„ íƒëœ Kì™€ ê·¸ë•Œì˜ ì§€í‘œë¥¼ selection_tableì— ì •ë¦¬í•œë‹¤.</li>
</ul>
<p>Silhouette ê¸°ì¤€ì€ ë¶„ë¦¬ë„ ì¤‘ì‹¬ì˜ ì„ íƒì´ë©°, Elbow ê¸°ì¤€ì€ ì‘ì§‘ë„ ê°ì†Œ íŒ¨í„´ ì¤‘ì‹¬ì˜ ì„ íƒì´ë‹¤.</p>
</section>
<section id="ì‹œê°í™”-í•´ì„" class="level5">
<h5 class="anchored" data-anchor-id="ì‹œê°í™”-í•´ì„">ì‹œê°í™” í•´ì„</h5>
<p>ì½”ë“œëŠ” ë°©ë²•ë³„ë¡œ ë‹¤ìŒ ë‘ ê³¡ì„ ì„ ê·¸ë¦°ë‹¤.</p>
<ul>
<li>WSS Elbow curve</li>
<li>Silhouette curve</li>
</ul>
<p>WSSëŠ” K ì¦ê°€ì— ë”°ë¼ í•­ìƒ ê°ì†Œí•œë‹¤. ë”°ë¼ì„œ ê°ì†Œ ì†ë„ê°€ ë‘”í™”ë˜ëŠ” ì§€ì ì´ ì¤‘ìš”í•˜ë‹¤. SilhouetteëŠ” ë°˜ë“œì‹œ ë‹¨ì¡° ì¦ê°€í•˜ì§€ ì•Šìœ¼ë©°, ë°ì´í„° êµ¬ì¡°ì— ë”°ë¼ íŠ¹ì • Kì—ì„œ ìµœëŒ€ê°’ì„ ê°€ì§„ë‹¤. ë‘ ê¸°ì¤€ì´ ë™ì¼í•œ Kë¥¼ ì œì‹œí•˜ë©´ ì„ íƒì´ ëª…í™•í•˜ì§€ë§Œ, ë‹¤ë¥¼ ê²½ìš° í•´ì„ê³¼ ë¶„ì„ ëª©ì ì„ ê³ ë ¤í•´ì•¼ í•œë‹¤.</p>
</section>
<section id="ë¶„ì„ì -ì˜ë¯¸" class="level5">
<h5 class="anchored" data-anchor-id="ë¶„ì„ì -ì˜ë¯¸">ë¶„ì„ì  ì˜ë¯¸</h5>
<p>ì´ ì „í†µì  êµ°ì§‘ ë¶„ì„ ì½”ë“œëŠ” ë‹¨ìˆœíˆ ì•Œê³ ë¦¬ì¦˜ì„ ì‹¤í–‰í•˜ëŠ” ë° ëª©ì ì´ ìˆì§€ ì•Šë‹¤.</p>
<ul>
<li>ë™ì¼í•œ ë°ì´í„°ì—ì„œ ì—¬ëŸ¬ ë°©ë²•ì„ ë¹„êµí•œë‹¤.</li>
<li>ë‚´ë¶€ ì§€í‘œì™€ ì™¸ë¶€ ì§€í‘œì˜ ì°¨ì´ë¥¼ ì´í•´í•œë‹¤.</li>
<li>K ì„ íƒì´ ë‹¨ì¼ ê¸°ì¤€ìœ¼ë¡œ ê²°ì •ë˜ì§€ ì•ŠìŒì„ ë³´ì—¬ì¤€ë‹¤.</li>
<li>ì´í›„ GMMê³¼ ê°™ì€ í™•ë¥ ëª¨í˜• ê¸°ë°˜ êµ°ì§‘ê³¼ êµ¬ì¡°ì ìœ¼ë¡œ ë¹„êµí•  ì¤€ë¹„ë¥¼ í•œë‹¤.</li>
</ul>
<p>ì¦‰, ì´ ì½”ë“œëŠ” êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ì˜ ì„±ëŠ¥ ë¹„êµë¥¼ ë„˜ì–´, â€œêµ°ì§‘ ìˆ˜ ì„ íƒâ€ê³¼ â€œì§€í‘œ í•´ì„â€ì´ë¼ëŠ” êµ°ì§‘ë¶„ì„ì˜ í•µì‹¬ ë¬¸ì œë¥¼ í•™ìŠµí•˜ê¸° ìœ„í•œ êµ¬ì¡°ë¥¼ ê°–ê³  ìˆë‹¤.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans, AgglomerativeClustering</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score, adjusted_rand_score, normalized_mutual_info_score</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 0) ê³µí†µ ì„¤ì •</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>RANDOM_STATE <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ë™ì¼ ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ ë¹„êµ (ê¶Œì¥: í‘œì¤€í™”)</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>X_use <span class="op">=</span> X_std   <span class="co"># í•„ìš”í•˜ë©´ Xë¡œ ë³€ê²½ ê°€ëŠ¥</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>K_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">21</span>))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) ë³´ì¡° í•¨ìˆ˜: WSS(Within SS) ê³„ì‚° (ëª¨ë“  ì•Œê³ ë¦¬ì¦˜ ê³µí†µ)</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#    - k-meansëŠ” inertia_ê°€ WSSì™€ ë™ì¼</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#    - ê³„ì¸µêµ°ì§‘ë„ ë¼ë²¨ë§Œ ìˆìœ¼ë©´ centroid ê¸°ë°˜ WSS ê³„ì‚° ê°€ëŠ¥</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_wss(X, labels):</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""ê° êµ°ì§‘ì˜ ì¤‘ì‹¬(í‰ê· ) ê¸°ì¤€ìœ¼ë¡œ WSS = sum ||x - mu_k||^2 ê³„ì‚°"""</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> np.unique(labels):</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        Xk <span class="op">=</span> X[labels <span class="op">==</span> k]</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> Xk.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        wss <span class="op">+=</span> ((Xk <span class="op">-</span> mu) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(wss)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> elbow_k_by_second_diff(Ks, wss_values):</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co">    ê°„ë‹¨í•œ Elbow ìë™í™”:</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">    - WSSë¥¼ 0~1ë¡œ ì •ê·œí™”í•œ ë’¤</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co">    - 2ì°¨ ì°¨ë¶„(ê³¡ë¥ )ì´ ê°€ì¥ í° Kë¥¼ elbowë¡œ ì„ íƒ</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    Ks <span class="op">=</span> np.array(Ks, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> np.array(wss_values, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ë‹¨ì¡°ê°ì†Œê°€ ì•„ë‹ ìˆ˜ë„ ìˆëŠ” ìˆ˜ì¹˜ì˜¤ì°¨ ëŒ€ë¹„</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> np.maximum(wss, <span class="dv">0</span>)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ì •ê·œí™” (í° ê°’/ì‘ì€ ê°’ ìŠ¤ì¼€ì¼ ì˜í–¥ ì œê±°)</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    wss_norm <span class="op">=</span> (wss <span class="op">-</span> wss.<span class="bu">min</span>()) <span class="op">/</span> (wss.<span class="bu">max</span>() <span class="op">-</span> wss.<span class="bu">min</span>() <span class="op">+</span> <span class="fl">1e-12</span>)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2ì°¨ ì°¨ë¶„</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    d1 <span class="op">=</span> np.diff(wss_norm)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    d2 <span class="op">=</span> np.diff(d1)  <span class="co"># ê¸¸ì´: len(Ks)-2</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(d2) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(Ks[<span class="dv">0</span>])</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ê³¡ë¥ ì´ ê°€ì¥ í° ì§€ì (ì ˆëŒ€ê°’ í¬ê²Œ)</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> np.argmax(np.<span class="bu">abs</span>(d2))</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># d2ëŠ” K[0..] ê¸°ì¤€ìœ¼ë¡œ (K[idx+1]) ìœ„ì¹˜ì— í•´ë‹¹</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(Ks[idx <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) (4.2) ì „í†µì  êµ°ì§‘: k-means / ê³„ì¸µêµ°ì§‘(Ward, Complete)</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="co">#    - ê° Kì—ì„œ silhouette, WSS, ARI, NMI ê³„ì‚°</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>records <span class="op">=</span> []</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- (A) k-means ----</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>K, random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> km.fit_predict(X_use)</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    sil <span class="op">=</span> silhouette_score(X_use, z, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="bu">float</span>(km.inertia_)  <span class="co"># = WSS</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    records.append({</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="st">"KMeans"</span>,</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil,</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss,</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z),</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z)</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- (B) Hierarchical: Ward / Complete ----</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> agglomerative_fit_predict(X, K, linkage):</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sklearn ë²„ì „ í˜¸í™˜(affinity vs metric)</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span>K, linkage<span class="op">=</span>linkage, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">TypeError</span>:</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span>K, linkage<span class="op">=</span>linkage, affinity<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model.fit_predict(X)</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ward</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>    z_ward <span class="op">=</span> agglomerative_fit_predict(X_use, K, linkage<span class="op">=</span><span class="st">"ward"</span>)</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>    sil_ward <span class="op">=</span> silhouette_score(X_use, z_ward, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>    wss_ward <span class="op">=</span> compute_wss(X_use, z_ward)</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>    records.append({</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="st">"Hierarchical(Ward)"</span>,</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K,</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil_ward,</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss_ward,</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_ward),</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_ward)</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Complete</span></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>    z_comp <span class="op">=</span> agglomerative_fit_predict(X_use, K, linkage<span class="op">=</span><span class="st">"complete"</span>)</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>    sil_comp <span class="op">=</span> silhouette_score(X_use, z_comp, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>    wss_comp <span class="op">=</span> compute_wss(X_use, z_comp)</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>    records.append({</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="st">"Hierarchical(Complete)"</span>,</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K,</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil_comp,</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss_comp,</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_comp),</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_comp)</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>trad_results <span class="op">=</span> pd.DataFrame(records).sort_values([<span class="st">"method"</span>, <span class="st">"K"</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>display(trad_results.head(<span class="dv">10</span>))</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) K ì„ íƒ: Silhouette-best + Elbow-best(ìë™) ê°ê° êµ¬í•˜ê¸°</span></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>best_rows <span class="op">=</span> []</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> trad_results[<span class="st">"method"</span>].unique():</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>    dfm <span class="op">=</span> trad_results[trad_results[<span class="st">"method"</span>] <span class="op">==</span> m].copy()</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (i) Silhouette-best</span></span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>    sil_best <span class="op">=</span> dfm.loc[dfm[<span class="st">"silhouette"</span>].idxmax()]</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (ii) Elbow-best (WSS ê³¡ë¥  ê¸°ë°˜)</span></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>    elbowK <span class="op">=</span> elbow_k_by_second_diff(dfm[<span class="st">"K"</span>].values, dfm[<span class="st">"wss"</span>].values)</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>    elbow_row <span class="op">=</span> dfm[dfm[<span class="st">"K"</span>] <span class="op">==</span> elbowK].iloc[<span class="dv">0</span>]</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>    best_rows.append({</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: m,</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K_sil_best"</span>: <span class="bu">int</span>(sil_best[<span class="st">"K"</span>]),</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"silhouette"</span>]),</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"wss"</span>]),</span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"ARI"</span>]),</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI_sil_best"</span>: <span class="bu">float</span>(sil_best[<span class="st">"NMI"</span>]),</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K_elbow"</span>: <span class="bu">int</span>(elbow_row[<span class="st">"K"</span>]),</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"silhouette"</span>]),</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"wss"</span>]),</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"ARI"</span>]),</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI_elbow"</span>: <span class="bu">float</span>(elbow_row[<span class="st">"NMI"</span>]),</span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>selection_table <span class="op">=</span> pd.DataFrame(best_rows).sort_values(<span class="st">"method"</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>display(selection_table)</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) ê·¸ë˜í”„: Elbow(WSS) / Silhouette ê³¡ì„  (ë°©ë²•ë³„)</span></span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> trad_results[<span class="st">"method"</span>].unique()</span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a><span class="co"># (A) WSS Elbow</span></span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> methods:</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>    dfm <span class="op">=</span> trad_results[trad_results[<span class="st">"method"</span>] <span class="op">==</span> m]</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>    plt.plot(dfm[<span class="st">"K"</span>], dfm[<span class="st">"wss"</span>], marker<span class="op">=</span><span class="st">"o"</span>, label<span class="op">=</span>m)</span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"K"</span>)</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"WSS (lower is better)"</span>)</span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Elbow Curve (WSS) - Traditional Clustering"</span>)</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a><span class="co"># (B) Silhouette</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> methods:</span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>    dfm <span class="op">=</span> trad_results[trad_results[<span class="st">"method"</span>] <span class="op">==</span> m]</span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>    plt.plot(dfm[<span class="st">"K"</span>], dfm[<span class="st">"silhouette"</span>], marker<span class="op">=</span><span class="st">"o"</span>, label<span class="op">=</span>m)</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"K"</span>)</span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Silhouette (higher is better)"</span>)</span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Silhouette Curve - Traditional Clustering"</span>)</span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) GMM(BIC-best)ì™€ ë™ì¼ í˜•ì‹ ë¹„êµí‘œ ë§Œë“¤ê¸°</span></span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a><span class="co">#    - ê¸°ì¡´ ì…€ì—ì„œ best_bic_row, z_bic, results(GMM AIC/BIC table)ê°€ ì¡´ì¬í•œë‹¤ê³  ê°€ì •</span></span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a>comparison_rows <span class="op">=</span> []</span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a><span class="co"># (A) GMM(BIC-best) í¬í•¨ (ìˆì„ ë•Œë§Œ)</span></span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"best_bic_row"</span> <span class="kw">in</span> <span class="bu">globals</span>() <span class="kw">and</span> <span class="st">"z_bic"</span> <span class="kw">in</span> <span class="bu">globals</span>():</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>    K_gmm <span class="op">=</span> <span class="bu">int</span>(best_bic_row[<span class="st">"K"</span>])</span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a>    cov_gmm <span class="op">=</span> <span class="bu">str</span>(best_bic_row[<span class="st">"covariance_type"</span>])</span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># silhouette/WSSë„ ê°™ì´ ê³„ì‚°(ë‚´ë¶€ì§€í‘œ í†µì¼)</span></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>    sil_gmm <span class="op">=</span> silhouette_score(X_use, z_bic, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a>    wss_gmm <span class="op">=</span> compute_wss(X_use, z_bic)</span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AIC/BIC ê°’ë„ ê°™ì´ ì ì–´ë‘ë©´ ë³´ê³ ì„œê°€ ê¹”ë”í•¨</span></span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>    aic_gmm <span class="op">=</span> <span class="bu">float</span>(best_bic_row[<span class="st">"aic"</span>]) <span class="cf">if</span> <span class="st">"aic"</span> <span class="kw">in</span> best_bic_row <span class="cf">else</span> np.nan</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>    bic_gmm <span class="op">=</span> <span class="bu">float</span>(best_bic_row[<span class="st">"bic"</span>]) <span class="cf">if</span> <span class="st">"bic"</span> <span class="kw">in</span> best_bic_row <span class="cf">else</span> np.nan</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a>    comparison_rows.append({</span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="ss">f"GMM(BIC-best, </span><span class="sc">{</span>cov_gmm<span class="sc">}</span><span class="ss">)"</span>,</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K_gmm,</span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil_gmm,</span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: wss_gmm,</span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_bic),</span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_bic),</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AIC"</span>: aic_gmm,</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BIC"</span>: bic_gmm</span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"âš ï¸ best_bic_row ë˜ëŠ” z_bicê°€ ì—†ìŠµë‹ˆë‹¤. (GMM ì…€ ì‹¤í–‰ í›„ ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”.)"</span>)</span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a><span class="co"># (B) ì „í†µì  êµ°ì§‘: silhouette-best ê¸°ì¤€ìœ¼ë¡œ í•œ ì¤„ì”© ìš”ì•½</span></span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> selection_table.iterrows():</span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a>    comparison_rows.append({</span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: row[<span class="st">"method"</span>] <span class="op">+</span> <span class="st">" (Sil-best)"</span>,</span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: <span class="bu">int</span>(row[<span class="st">"K_sil_best"</span>]),</span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: <span class="bu">float</span>(row[<span class="st">"silhouette_sil_best"</span>]),</span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: <span class="bu">float</span>(row[<span class="st">"wss_sil_best"</span>]),</span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: <span class="bu">float</span>(row[<span class="st">"ARI_sil_best"</span>]),</span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: <span class="bu">float</span>(row[<span class="st">"NMI_sil_best"</span>]),</span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AIC"</span>: np.nan,</span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BIC"</span>: np.nan</span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame(comparison_rows)</span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a><span class="co"># ë³´ê¸° ì¢‹ê²Œ ì •ë ¬: ë‚´ë¶€ì§€í‘œ(ì‹¤ë£¨ì—£ ë†’ì€ ìˆœ) ë˜ëŠ” ARI ë†’ì€ ìˆœ</span></span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a>comparison_sorted <span class="op">=</span> comparison.sort_values([<span class="st">"ARI"</span>, <span class="st">"silhouette"</span>], ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a>display(comparison_sorted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>ì´ ì ˆì—ì„œëŠ” í‘œì¤€í™”ëœ digits ë°ì´í„°(X_std)ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì „í†µì  êµ°ì§‘ë°©ë²• ì„¸ ê°€ì§€(KMeans, Hierarchical(Ward), Hierarchical(Complete))ë¥¼ ì ìš©í–ˆì„ ë•Œì˜ ì„±ëŠ¥ ì§€í‘œë¥¼ í•´ì„í•œë‹¤. ë¹„êµëŠ” ë‚´ë¶€ ì§€í‘œ(silhouette, WSS)ì™€ ì™¸ë¶€ ì§€í‘œ(ARI, NMI)ë¥¼ í•¨ê»˜ ì‚¬ìš©í•œë‹¤. ë‚´ë¶€ ì§€í‘œëŠ” ì‹¤ì œ ë¼ë²¨ì´ ì—†ëŠ” ì¼ë°˜ì  êµ°ì§‘ ìƒí™©ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥í•œ ë°˜ë©´, ì™¸ë¶€ ì§€í‘œëŠ” digitsì²˜ëŸ¼ ì •ë‹µ ë¼ë²¨ì´ ì¡´ì¬í•˜ëŠ” ë°ì´í„°ì—ì„œë§Œ ê³„ì‚° ê°€ëŠ¥í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” í‰ê°€ ëª©ì ì˜ ì°¸ê³ ê°’ìœ¼ë¡œ ì´í•´í•œë‹¤.</p>
</section>
<section id="hierarchicalcompleteì˜-íŠ¹ì§•ì -ê²°ê³¼-í•´ì„" class="level5">
<h5 class="anchored" data-anchor-id="hierarchicalcompleteì˜-íŠ¹ì§•ì -ê²°ê³¼-í•´ì„">Hierarchical(Complete)ì˜ íŠ¹ì§•ì  ê²°ê³¼ í•´ì„</h5>
<p>Hierarchical(Complete)ëŠ” silhouette ê°’ì´ K=2ì—ì„œ 0.7844ë¡œ ë§¤ìš° í¬ê²Œ ë‚˜íƒ€ë‚œë‹¤. ì´ëŠ” êµ°ì§‘ ê°„ ë¶„ë¦¬ê°€ ë§¤ìš° ëª…í™•í•˜ë‹¤ëŠ” ëœ»ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, digits ë°ì´í„°ì—ì„œ ì´ ê°’ì€ ì‹¤ì œ ì˜ë¯¸ ìˆëŠ” â€œìˆ«ì 10ê°œ ë¶„ë¥˜â€ì™€ëŠ” ê±°ì˜ ë¬´ê´€í•œ í˜•íƒœë¡œ ì–»ì–´ì¡Œë‹¤ê³  í•´ì„í•´ì•¼ í•œë‹¤. ì‹¤ì œë¡œ ARIëŠ” 0.000002, NMIëŠ” 0.001556ìœ¼ë¡œ ê±°ì˜ 0ì— ê°€ê¹ë‹¤. ì¦‰, complete linkageëŠ” ë‘ ê°œ êµ°ì§‘ìœ¼ë¡œ ë‚˜ëˆŒ ë•Œ ë°ì´í„°ì˜ ì–´ë–¤ ê±°ì¹œ êµ¬ì¡°(ì˜ˆ: ì „ì²´ ë°ê¸°, íšì˜ ì–‘, íŠ¹ì • í”½ì…€ì˜ ì´í•© ë“±)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í¬ê²Œ ë¶„ë¦¬í•  ìˆ˜ëŠ” ìˆìœ¼ë‚˜, ê·¸ ë¶„ë¦¬ê°€ ìˆ«ì ë¼ë²¨(0~9)ê³¼ëŠ” ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<p>Kë¥¼ ëŠ˜ë ¤ë„ ì´ ê²½í–¥ì€ í¬ê²Œ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ K=3ì—ì„œë„ silhouette 0.7798ë¡œ ë§¤ìš° ë†’ì§€ë§Œ ARI/NMIëŠ” ì—¬ì „íˆ ê±°ì˜ 0ì´ë‹¤. Kê°€ 5~11ë¡œ ì¦ê°€í•˜ë©´ silhouetteëŠ” 0.43 ìˆ˜ì¤€ ë˜ëŠ” 0.38 ìˆ˜ì¤€ê¹Œì§€ ë‚´ë ¤ê°€ì§€ë§Œ, ARI/NMIê°€ ì˜ë¯¸ ìˆê²Œ ì˜¬ë¼ê°€ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ì´ ê²°ê³¼ëŠ” complete linkageê°€ ë‚´ë¶€ ë¶„ë¦¬ë„(silhouette) ê´€ì ì—ì„œëŠ” â€œí° ë©ì–´ë¦¬ ë¶„ë¦¬â€ë¥¼ ì˜ ë§Œë“¤ ìˆ˜ ìˆìœ¼ë‚˜, digitsì˜ ì‹¤ì œ í´ë˜ìŠ¤ êµ¬ì¡°ë¥¼ ë³µì›í•˜ëŠ” êµ°ì§‘ìœ¼ë¡œëŠ” ë¶€ì í•©í•˜ë‹¤ëŠ” ì ì„ ë³´ì—¬ì¤€ë‹¤.</p>
<p>ìš”ì•½í•˜ë©´, complete linkageì—ì„œëŠ” silhouetteê°€ ë§¤ìš° ë†’ê²Œ ë‚˜ì˜¤ëŠ” êµ¬ê°„ì´ ì¡´ì¬í•˜ë”ë¼ë„ ê·¸ê²ƒë§Œìœ¼ë¡œ êµ°ì§‘ì´ â€œì˜ ë˜ì—ˆë‹¤â€ê³  ê²°ë¡ ë‚´ë¦¬ë©´ ì•ˆ ëœë‹¤. íŠ¹íˆ ì‹¤ì œ ë¼ë²¨ êµ¬ì¡°ê°€ ì¡´ì¬í•˜ëŠ” ë²¤ì¹˜ë§ˆí¬ì—ì„œëŠ” ARI/NMI ê°™ì€ ì™¸ë¶€ ì§€í‘œë¥¼ í•¨ê»˜ í™•ì¸í•´ì•¼ í•˜ë©°, ë‚´ë¶€ ì§€í‘œê°€ ë†’ì§€ë§Œ ì™¸ë¶€ ì§€í‘œê°€ 0ì— ê°€ê¹Œìš´ ê²½ìš°ëŠ” ë°ì´í„°ì˜ ë‹¤ë¥¸ ìš”ì¸(í¬ê¸°/ê°•ë„/ë°€ë„ ë“±)ì— ì˜í•´ ë‹¨ìˆœ ë¶„ë¦¬ë§Œ ëœ ìƒí™©ìœ¼ë¡œ í•´ì„í•˜ëŠ” ê²ƒì´ íƒ€ë‹¹í•˜ë‹¤.</p>
</section>
<section id="hierarchicalwardì˜-ê²°ê³¼-í•´ì„" class="level5">
<h5 class="anchored" data-anchor-id="hierarchicalwardì˜-ê²°ê³¼-í•´ì„">Hierarchical(Ward)ì˜ ê²°ê³¼ í•´ì„</h5>
<p>Hierarchical(Ward)ëŠ” silhouetteê°€ ê°€ì¥ í° Kê°€ 20ì´ë©°, ì´ë•Œ silhouetteëŠ” 0.1528ë¡œ í¬ì§€ ì•Šë‹¤. ê·¸ëŸ¬ë‚˜ ARIëŠ” 0.6881, NMIëŠ” 0.7950ìœ¼ë¡œ ë§¤ìš° ë†’ë‹¤. ì´ëŠ” Ward ë°©ì‹ì´ digitsì˜ ì‹¤ì œ ìˆ«ì êµ¬ì¡°ë¥¼ ìƒë‹¹íˆ ì˜ ë°˜ì˜í•˜ëŠ” êµ°ì§‘ì„ ë§Œë“¤ì—ˆìŒì„ ì˜ë¯¸í•œë‹¤. ì—¬ê¸°ì—ì„œ silhouetteê°€ ë‚®ê²Œ ë‚˜ì˜¤ëŠ” ì´ìœ ëŠ” digits ë°ì´í„°ê°€ ë³¸ì§ˆì ìœ¼ë¡œ ê³ ì°¨ì›(64ì°¨ì›)ì´ê³  í´ë˜ìŠ¤ ê°„ ê²½ê³„ê°€ ë‹¨ìˆœíˆ â€œê°€ê¹Œìš´ ê±°ë¦¬ë¡œ ë­‰ì³ì§€ëŠ” í˜•íƒœâ€ë§Œìœ¼ë¡œ ì„¤ëª…ë˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, ì‹¤ì œ í´ë˜ìŠ¤ì™€ì˜ ëŒ€ì‘ì´ ì¢‹ë”ë¼ë„ êµ°ì§‘ ê°„ ë¶„ë¦¬ë„ê°€ ë‹¨ìˆœ ê±°ë¦¬ ê¸°ë°˜ìœ¼ë¡œ í¬ê²Œ ë²Œì–´ì§€ì§€ ì•Šìœ¼ë©´ silhouetteëŠ” ë†’ê²Œ ë‚˜ì˜¤ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.</p>
<p>ë˜í•œ Wardì˜ elbow ì„ íƒ ê²°ê³¼ëŠ” K=3ì¸ë°, ì´ë•Œ silhouette 0.0916, ARI 0.2761, NMI 0.4934ë¡œ ì„±ëŠ¥ì´ Silhouette-best(K=20) ëŒ€ë¹„ í¬ê²Œ ë–¨ì–´ì§„ë‹¤. ì´ëŠ” WSSì˜ êº¾ì„(ì‘ì§‘ë„ ê°ì†Œ íŒ¨í„´)ì„ ê¸°ì¤€ìœ¼ë¡œ ì„ íƒí•œ Kê°€ digitsì˜ í´ë˜ìŠ¤ êµ¬ì¡°(10ê°œ)ë¥¼ ë°˜ì˜í•˜ëŠ”ë° ì¶©ë¶„íˆ ì„¸ë¶„í™”ë˜ì§€ ëª»í–ˆìŒì„ ì˜ë¯¸í•œë‹¤. ë”°ë¼ì„œ ì´ ë°ì´í„°ì—ì„œëŠ” elbow ìë™ ì„ íƒì´ ì§€ë‚˜ì¹˜ê²Œ ì‘ì€ Kë¥¼ ì œì•ˆí•  ìˆ˜ ìˆê³ , ê·¸ ê²°ê³¼ ì™¸ë¶€ ì§€í‘œ ê´€ì ì—ì„œ ì„±ëŠ¥ì´ í¬ê²Œ ì €í•˜ë  ìˆ˜ ìˆìŒì„ ë³´ì—¬ì¤€ë‹¤.</p>
<p>ì •ë¦¬í•˜ë©´ Ward ê²°ê³¼ëŠ” ë‚´ë¶€ ì§€í‘œë§Œ ë³´ë©´ ê·¸ë‹¤ì§€ ì¸ìƒì ì´ì§€ ì•Šì§€ë§Œ, ì™¸ë¶€ ì§€í‘œ ê´€ì ì—ì„œëŠ” ê°€ì¥ ê°•ë ¥í•œ ì „í†µì  ë°©ë²•ìœ¼ë¡œ ë‚˜íƒ€ë‚œë‹¤. ì´ëŠ” â€œêµ°ì§‘ í’ˆì§ˆì„ ë¬´ì—‡ìœ¼ë¡œ ì •ì˜í•˜ëŠëƒâ€ì— ë”°ë¼ í•´ì„ì´ ë‹¬ë¼ì§€ëŠ” ì „í˜•ì ì¸ ì‚¬ë¡€ì´ë‹¤.</p>
</section>
<section id="kmeansì˜-ê²°ê³¼-í•´ì„" class="level5">
<h5 class="anchored" data-anchor-id="kmeansì˜-ê²°ê³¼-í•´ì„">KMeansì˜ ê²°ê³¼ í•´ì„</h5>
<p>KMeansëŠ” silhouette ê¸°ì¤€ ìµœì  Kê°€ 15ì´ë©°, ì´ë•Œ silhouetteëŠ” 0.1583ìœ¼ë¡œ Ward(K=20)ì˜ silhouette 0.1528ê³¼ ë¹„ìŠ·í•œ ìˆ˜ì¤€ì´ë‹¤. ê·¸ëŸ¬ë‚˜ ì™¸ë¶€ ì§€í‘œëŠ” ARI 0.5683, NMI 0.6882ë¡œ Wardë³´ë‹¤ ë‚®ë‹¤. ì´ëŠ” KMeansê°€ digits êµ¬ì¡°ë¥¼ ì–´ëŠ ì •ë„ ë°˜ì˜í•˜ê¸´ í•˜ì§€ë§Œ, êµ°ì§‘ì˜ ëª¨ì–‘ì´ êµ¬í˜•(spherical)ì´ê³  ë¶„ì‚°ì´ ë¹„ìŠ·í•˜ë‹¤ëŠ” ê°€ì •ì— ê°€ê¹Œìš´ í˜•íƒœë¡œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— digitsì˜ ë³µì¡í•œ ë³€í˜•(í•„ê¸°ì²´ ë‹¤ì–‘ì„±, íŠ¹ì • ìˆ«ì ê°„ ëª¨ì–‘ ìœ ì‚¬ì„±)ì„ ì™„ì „íˆ ë°˜ì˜í•˜ê¸°ëŠ” ì–´ë µë‹¤ëŠ” ì ì„ ì‹œì‚¬í•œë‹¤.</p>
<p>KMeansì˜ elbow ì„ íƒ ê²°ê³¼ëŠ” K=18ì´ë©°, ì´ë•Œ silhouette 0.1555, ARI 0.5241, NMI 0.6832ë¡œ silhouette-best(K=15)ì™€ í° ì°¨ì´ê°€ ì—†ë‹¤. ì¦‰, KMeansì—ì„œëŠ” Silhouette-bestì™€ Elbow-bestê°€ ë¹„êµì  ê°€ê¹Œìš´ Kë¥¼ ì œì•ˆí•˜ê³ , ì™¸ë¶€ ì§€í‘œë„ í° í­ìœ¼ë¡œ í”ë“¤ë¦¬ì§€ ì•ŠëŠ”ë‹¤. ì´ëŠ” KMeansê°€ WSS ê¸°ë°˜ì˜ ëª©ì í•¨ìˆ˜(inertia)ë¥¼ ì§ì ‘ ìµœì†Œí™”í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ì–´ì„œ WSS ê¸°ë°˜ ì„ íƒê³¼ì˜ ì •í•©ì„±ì´ ìƒëŒ€ì ìœ¼ë¡œ ë” ë†’ì€ í¸ì´ê¸° ë•Œë¬¸ì´ë‹¤.</p>
</section>
<section id="ì „í†µì -ë°©ë²•-ê°„-ì¢…í•©-ë¹„êµìš”ì•½" class="level5">
<h5 class="anchored" data-anchor-id="ì „í†µì -ë°©ë²•-ê°„-ì¢…í•©-ë¹„êµìš”ì•½">ì „í†µì  ë°©ë²• ê°„ ì¢…í•© ë¹„êµ(ìš”ì•½)</h5>
<p>ì „í†µì  êµ°ì§‘ ê²°ê³¼ë¥¼ ì¢…í•©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²°ë¡ ì´ ìì—°ìŠ¤ëŸ½ë‹¤.</p>
<p><strong>complete linkage</strong>ëŠ” silhouette ê°’ì´ ë§¤ìš° ë†’ê²Œ ë‚˜ì˜¬ ìˆ˜ ìˆìœ¼ë‚˜, digitsì˜ ì‹¤ì œ ìˆ«ì êµ¬ì¡°ì™€ì˜ ëŒ€ì‘(ARI/NMI)ì€ ê±°ì˜ 0ì— ê°€ê¹ë‹¤. ë‚´ë¶€ ì§€í‘œì˜ ë†’ìŒì´ ê³§ë°”ë¡œ ìœ ì˜ë¯¸í•œ êµ°ì§‘ì„ ì˜ë¯¸í•˜ì§€ ì•ŠìŒì„ ë³´ì—¬ì¤€ë‹¤.</p>
<p><strong>Ward linkage</strong>ëŠ” silhouetteëŠ” ë‚®ì§€ë§Œ ARI/NMIê°€ ë§¤ìš° ë†’ì•„, digitsì˜ í´ë˜ìŠ¤ êµ¬ì¡°ë¥¼ ê°€ì¥ ì˜ ë°˜ì˜í•œë‹¤. ê³ ì°¨ì› ì´ë¯¸ì§€í˜• ë°ì´í„°ì—ì„œëŠ” â€œí´ë˜ìŠ¤ ë³µì› ì„±ëŠ¥â€ê³¼ â€œê±°ë¦¬ ê¸°ë°˜ ë¶„ë¦¬ë„â€ê°€ ë°˜ë“œì‹œ ê°™ì€ ë°©í–¥ìœ¼ë¡œ ì›€ì§ì´ì§€ ì•Šì„ ìˆ˜ ìˆìŒì„ ì‹œì‚¬í•œë‹¤.</p>
<p><strong>KMeans</strong>ëŠ” Wardë³´ë‹¤ ì™¸ë¶€ ì§€í‘œê°€ ë‚®ì§€ë§Œ ì „ë°˜ì ìœ¼ë¡œ ì•ˆì •ì ì´ë©°, elbow ì„ íƒê³¼ silhouette ì„ íƒì˜ ì°¨ì´ê°€ ë¹„êµì  ì‘ë‹¤. ë‹¤ë§Œ digitsì™€ ê°™ì€ ë³µì¡í•œ í˜•íƒœ ë°ì´í„°ì—ì„œëŠ” Wardì— ë¹„í•´ êµ¬ì¡° ë³µì›ë ¥ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤.</p>
</section>
<section id="ë¹„êµí‘œì™€ì˜-ì—°ê²°" class="level5">
<h5 class="anchored" data-anchor-id="ë¹„êµí‘œì™€ì˜-ì—°ê²°">ë¹„êµí‘œì™€ì˜ ì—°ê²°</h5>
<p>ìš”ì•½ ë¹„êµí‘œì—ì„œëŠ” silhouette-best ê¸°ì¤€ìœ¼ë¡œ ê° ë°©ë²•ì„ í•œ ì¤„ë¡œ ëŒ€í‘œì‹œì¼°ì„ ë•Œ,</p>
<ul>
<li>Hierarchical(Ward) (Sil-best): K=20, ARI=0.6881, NMI=0.7950</li>
<li>KMeans (Sil-best): K=15, ARI=0.5683, NMI=0.6882</li>
<li>Hierarchical(Complete) (Sil-best): K=2, ARIâ‰ˆ0, NMIâ‰ˆ0</li>
</ul>
<p>ê³¼ ê°™ì€ ìˆœì„œë¡œ ë‚˜íƒ€ë‚œë‹¤. ë”°ë¼ì„œ digits ë°ì´í„°ì—ì„œ ì „í†µì  êµ°ì§‘ë§Œ ë†“ê³  ë³¸ë‹¤ë©´, ì‹¤ì œ ë¼ë²¨ êµ¬ì¡°ë¥¼ ê°€ì¥ ì˜ ë°˜ì˜í•˜ëŠ” í›„ë³´ëŠ” Ward, ê·¸ ë‹¤ìŒì´ KMeansì´ë©°, complete linkageëŠ” ë‚´ë¶€ ì§€í‘œë§Œ ë³´ê³  ì„ íƒí•  ê²½ìš° ì˜ëª»ëœ ê²°ë¡ ìœ¼ë¡œ ì´ì–´ì§ˆ ìœ„í—˜ì´ í° ë°©ë²•ìœ¼ë¡œ í•´ì„ëœë‹¤.</p>
<pre class="text"><code>
method  K   silhouette  wss ARI NMI
0   Hierarchical(Complete)  2   0.784424    106721.094913   0.000002    0.001556
1   Hierarchical(Complete)  3   0.779755    105134.196220   0.000002    0.002223
2   Hierarchical(Complete)  4   0.733223    102725.043083   -0.000002   0.003753
3   Hierarchical(Complete)  5   0.430919    98680.223906    0.000290    0.020400
4   Hierarchical(Complete)  6   0.432321    97196.179621    0.000353    0.023599
5   Hierarchical(Complete)  7   0.433767    95458.376649    0.000352    0.026290
6   Hierarchical(Complete)  8   0.433629    94923.776923    0.000353    0.026916
7   Hierarchical(Complete)  9   0.384715    93599.700879    0.000311    0.027731
8   Hierarchical(Complete)  10  0.385738    91939.649024    0.000298    0.031561
9   Hierarchical(Complete)  11  0.386541    91283.712892    0.000289    0.032888
method  K_sil_best  silhouette_sil_best wss_sil_best    ARI_sil_best    NMI_sil_best    K_elbow silhouette_elbow    wss_elbow   ARI_elbow   NMI_elbow
0   Hierarchical(Complete)  2   0.784424    106721.094913   0.000002    0.001556    13  0.317344    89979.315231    0.000289    0.036864
1   Hierarchical(Ward)  20  0.152754    54003.237083    0.688082    0.794962    3   0.091561    95529.286988    0.276093    0.493419
2   KMeans  15  0.158307    59534.498937    0.568326    0.688241    18  0.155479    57000.786005    0.524090    0.683195</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_tradition_wss.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_tradition_silhouette.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<pre class="text"><code>method  K   silhouette  wss ARI NMI AIC BIC
0   Hierarchical(Ward) (Sil-best)   20  0.152754    54003.237083    0.688082    0.794962    NaN NaN
1   KMeans (Sil-best)   15  0.158307    59534.498937    0.568326    0.688241    NaN NaN
2   GMM(BIC-best, diag) 20  0.093540    62457.729652    0.437694    0.596951    -232769.805429  -218601.104675
3   Hierarchical(Complete) (Sil-best)   2   0.784424    106721.094913   0.000002    0.001556    NaN NaN</code></pre>
</section>
</section>
<section id="í‘œí˜„ê¸°ë°˜-êµ°ì§‘representation-based-clustering" class="level4">
<h4 class="anchored" data-anchor-id="í‘œí˜„ê¸°ë°˜-êµ°ì§‘representation-based-clustering">4. í‘œí˜„ê¸°ë°˜ êµ°ì§‘(Representation-based Clustering)</h4>
<p>ì´ ì ˆì˜ ì½”ë“œëŠ” ì›ìë£Œ X(64ì°¨ì› í”½ì…€ ë²¡í„°)ë¥¼ ê·¸ëŒ€ë¡œ êµ°ì§‘í™”í•˜ì§€ ì•Šê³ , ë¨¼ì € ì°¨ì›ì„ ì¤„ì´ê±°ë‚˜(í‘œí˜„ì„ ì••ì¶•í•˜ê±°ë‚˜) ì˜ë¯¸ ìˆëŠ” ì ì¬í‘œí˜„ì„ í•™ìŠµí•œ ë’¤ ê·¸ í‘œí˜„ ê³µê°„ì—ì„œ êµ°ì§‘ì„ ìˆ˜í–‰í•œë‹¤. ì¦‰, êµ°ì§‘ í’ˆì§ˆì„ ë†’ì´ê¸° ìœ„í•´ ì…ë ¥ ê³µê°„ì„ í‘œí˜„ ê³µê°„(embedding space)ìœ¼ë¡œ ë°”ê¾¸ëŠ” ì ‘ê·¼ì´ë©°, ì—¬ê¸°ì„œëŠ” PCA ì„ë² ë”©ê³¼ ì˜¤í† ì¸ì½”ë” ì„ë² ë”©ì„ ì‚¬ìš©í•œë‹¤. ë¹„êµì˜ ê³µì •ì„±ì„ ìœ„í•´ ì¬í˜„ì„±(random seed)ì„ ê³ ì •í•˜ê³ , ê²°ê³¼ëŠ” ê¸°ì¡´ ë¹„êµí‘œ comparison_sortedì— ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ ì¶”ê°€í•œë‹¤.</p>
<section id="ê³µí†µ-ì„¤ì •ê³¼-ë¹„êµì˜-ê¸°ì¤€" class="level5">
<h5 class="anchored" data-anchor-id="ê³µí†µ-ì„¤ì •ê³¼-ë¹„êµì˜-ê¸°ì¤€">ê³µí†µ ì„¤ì •ê³¼ ë¹„êµì˜ ê¸°ì¤€</h5>
<p>ì½”ë“œëŠ” RANDOM_STATEë¥¼ ì„¤ì •í•˜ê³ , ì›ìë£Œ Xë¥¼ í‘œì¤€í™”í•œ X_stdë¥¼ ê¸°ë³¸ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. ê±°ë¦¬ ê¸°ë°˜ ì§€í‘œ(silhouette, WSS)ì™€ êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ì´ ìŠ¤ì¼€ì¼ì— ë¯¼ê°í•˜ê¸° ë•Œë¬¸ì— í‘œì¤€í™” ê³µê°„ì„ ê¸°ë³¸ìœ¼ë¡œ ë‘ëŠ” ê²ƒì´ ì•ˆì •ì ì´ë‹¤. ë˜í•œ êµ°ì§‘ ìˆ˜ í›„ë³´ëŠ” K=2ë¶€í„° K=20ê¹Œì§€ë¡œ ë‘ê³ , ì—¬ëŸ¬ K ì¤‘ ë‚´ë¶€ì§€í‘œ ê¸°ì¤€ìœ¼ë¡œ ìµœì  Kë¥¼ ì„ íƒí•˜ê±°ë‚˜(GMMì€ BICë¡œ ì„ íƒ), ê·¸ ê²°ê³¼ë¥¼ ìš”ì•½ í…Œì´ë¸”ì— ê¸°ë¡í•œë‹¤.</p>
<p>ë˜í•œ dims = [2, 10, 20]ì„ ì§€ì •í•˜ì—¬ PCAì˜ ì°¨ì› ìˆ˜ë¥¼ ì—¬ëŸ¬ ìˆ˜ì¤€ì—ì„œ ì‹¤í—˜í•œë‹¤. ì´ ê°’ë“¤ì€ â€œê·¹ë‹¨ì ìœ¼ë¡œ ë‚®ì€ ì°¨ì›(2D)â€, â€œì¤‘ê°„ ì •ë„ ì°¨ì›(10D)â€, â€œìƒëŒ€ì ìœ¼ë¡œ í° ì°¨ì›(20D)â€ì—ì„œ êµ°ì§‘ í’ˆì§ˆì´ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ ê´€ì°°í•˜ê¸° ìœ„í•œ ì„¤ì •ì´ë‹¤.</p>
</section>
<section id="pca-ì„ë² ë”©-ìƒì„±ê³¼-ì„¤ëª…ë ¥evì˜-ì˜ë¯¸" class="level5">
<h5 class="anchored" data-anchor-id="pca-ì„ë² ë”©-ìƒì„±ê³¼-ì„¤ëª…ë ¥evì˜-ì˜ë¯¸">PCA ì„ë² ë”© ìƒì„±ê³¼ ì„¤ëª…ë ¥(EV)ì˜ ì˜ë¯¸</h5>
<p>ê° q in dimsì— ëŒ€í•´ PCA(n_components=q)ë¥¼ ì í•©í•˜ê³ , ì„ë² ë”© Zë¥¼ ë§Œë“ ë‹¤. <span class="math inline">\(Z = \text{PCA}_q(X_{\text{std}})\)</span>.</p>
<p>ê·¸ë¦¬ê³  explained_variance_ratio_ì˜ í•©ì„ ê³„ì‚°í•˜ì—¬ EV(ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ì˜ ì´í•©)ë¥¼ ê¸°ë¡í•œë‹¤. <span class="math inline">\(EV(q) = \sum_{j=1}^{q} \text{EVR}_j\)</span></p>
<p>EVëŠ” â€œqì°¨ì›ìœ¼ë¡œ ì¤„ì˜€ì„ ë•Œ ì›ë˜ ë°ì´í„° ë³€ë™ì„ ì–¼ë§ˆë‚˜ ë³´ì¡´í–ˆëŠ”ê°€â€ë¥¼ ìš”ì•½í•˜ëŠ” ê°’ì´ë‹¤. ì½”ë“œì—ì„œëŠ” method ë¬¸ìì—´ì— EVë¥¼ í¬í•¨ì‹œì¼œ, ë™ì¼í•œ që¼ë„ ë°ì´í„° ë³´ì¡´ ì •ë„ë¥¼ í•¨ê»˜ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.</p>
</section>
<section id="pca-kmeans-í‘œí˜„-ê³µê°„ì—ì„œì˜-êµ°ì§‘" class="level5">
<h5 class="anchored" data-anchor-id="pca-kmeans-í‘œí˜„-ê³µê°„ì—ì„œì˜-êµ°ì§‘">PCA + KMeans: í‘œí˜„ ê³µê°„ì—ì„œì˜ êµ°ì§‘</h5>
<p>PCAë¡œ ì–»ì€ Z ê³µê°„ì—ì„œ KMeansë¥¼ ìˆ˜í–‰í•œë‹¤. ì ˆì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
<li>K=2~20ì— ëŒ€í•´ KMeansë¥¼ ê°ê° ì í•©</li>
<li>ê° Kì— ëŒ€í•´ silhouette, WSS, ARI, NMI ê³„ì‚°</li>
<li>silhouetteê°€ ìµœëŒ€ê°€ ë˜ëŠ” Kë¥¼ ì„ íƒ(Silhouette-best)</li>
<li>ì„ íƒëœ ê²°ê³¼ë¥¼ new_rowsì— 1í–‰ìœ¼ë¡œ ìš”ì•½í•˜ì—¬ ì¶”ê°€</li>
</ul>
<p>ì—¬ê¸°ì„œ silhouetteëŠ” Z ê³µê°„ì—ì„œ ê³„ì‚°ëœë‹¤. ì¦‰, ì›ê³µê°„(X_std)ì—ì„œì˜ ë¶„ë¦¬ë„ê°€ ì•„ë‹ˆë¼ PCAë¡œ ì••ì¶•ëœ í‘œí˜„ ê³µê°„ì—ì„œì˜ ë¶„ë¦¬ë„ë¥¼ ì˜ë¯¸í•œë‹¤. ë”°ë¼ì„œ PCA ì°¨ì› ìˆ˜ qê°€ ë„ˆë¬´ ì‘ìœ¼ë©´(ì˜ˆ: 2D) êµ°ì§‘ì´ ë‹¨ìˆœí™”ë˜ì–´ silhouetteê°€ ë†’ì•„ì§ˆ ìˆ˜ë„ ìˆì§€ë§Œ, ì‹¤ì œ í´ë˜ìŠ¤ êµ¬ì¡°(ARI/NMI)ì™€ì˜ ëŒ€ì‘ì€ ì˜¤íˆë ¤ ë‚˜ë¹ ì§ˆ ìˆ˜ ìˆë‹¤.</p>
<p>ë°˜ëŒ€ë¡œ qê°€ ì»¤ì§€ë©´ ì •ë³´ ë³´ì¡´ì´ ëŠ˜ì–´ ì‹¤ì œ ë¼ë²¨ê³¼ì˜ ëŒ€ì‘ì´ ì¢‹ì•„ì§ˆ ê°€ëŠ¥ì„±ì´ ìˆì§€ë§Œ, ê±°ë¦¬ ê¸°ë°˜ ë¶„ë¦¬ë„(silhouette)ëŠ” ë°˜ë“œì‹œ í•¨ê»˜ ì¦ê°€í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. WSSëŠ” KMeansì˜ inertia_ë¡œ ì–»ìœ¼ë©°, ì—­ì‹œ Z ê³µê°„ì—ì„œì˜ ì‘ì§‘ë„ë¥¼ ì˜ë¯¸í•œë‹¤.</p>
</section>
<section id="pca-gmm-bic-ê¸°ë°˜-ëª¨ë¸-ì„ íƒ" class="level5">
<h5 class="anchored" data-anchor-id="pca-gmm-bic-ê¸°ë°˜-ëª¨ë¸-ì„ íƒ">PCA + GMM: BIC ê¸°ë°˜ ëª¨ë¸ ì„ íƒ</h5>
<p>ê°™ì€ PCA ì„ë² ë”© Z ê³µê°„ì—ì„œ GaussianMixtureë¥¼ í•™ìŠµí•œë‹¤. ì´ë•ŒëŠ” Kë¥¼ silhouetteë¡œ ê³ ë¥´ì§€ ì•Šê³ , ëª¨ë¸ ì„ íƒ ê¸°ì¤€ì¸ BICë¡œ (covariance_type, K) ì¡°í•©ì„ ì„ íƒí•œë‹¤.</p>
<ul>
<li>covariance_typeì„ spherical, diag, tied, fullë¡œ ë°”ê¿”ê°€ë©°</li>
<li>K=2~20ì— ëŒ€í•´ GMMì„ ëª¨ë‘ ì í•©</li>
<li>ê° ì¡°í•©ì—ì„œ AICì™€ BICë¥¼ ê³„ì‚°</li>
<li>BICê°€ ìµœì†Œê°€ ë˜ëŠ” ì¡°í•©ì„ ì„ íƒ(BIC-best)</li>
<li>ì„ íƒëœ ì„¤ì •ìœ¼ë¡œ ë‹¤ì‹œ í•™ìŠµí•´ hard label z_gmmì„ ìƒì„±</li>
<li>silhouette, WSS, ARI, NMIë¥¼ ê³„ì‚°í•˜ê³  ê²°ê³¼ë¥¼ new_rowsì— ì¶”ê°€</li>
</ul>
<p>BICëŠ” ëª¨ë¸ ë³µì¡ë„(ëª¨ìˆ˜ ê°œìˆ˜)ë¥¼ ë²Œì ìœ¼ë¡œ ë¶€ê³¼í•˜ë¯€ë¡œ, Kë¥¼ ë¬´ì‘ì • í¬ê²Œ í‚¤ìš°ê¸°ë³´ë‹¤ â€œì„¤ëª…ë ¥ ëŒ€ë¹„ ë³µì¡ë„ê°€ ì ì ˆí•œ ëª¨ë¸â€ì„ ì„ íƒí•˜ë„ë¡ ìœ ë„í•œë‹¤. íŠ¹íˆ GMMì—ì„œ covariance_typeì€ êµ°ì§‘ì˜ ëª¨ì–‘ì„ ê²°ì •í•˜ë¯€ë¡œ, BIC-best ê²°ê³¼ëŠ” â€œêµ°ì§‘ ìˆ˜â€ì™€ â€œêµ°ì§‘ ëª¨ì–‘ ê°€ì •â€ì„ ë™ì‹œì— ìµœì í™”í•œ ê²°ê³¼ë¡œ í•´ì„í•œë‹¤.</p>
</section>
<section id="comparison_sortedì—-ê²°ê³¼ë¥¼-ëˆ„ì í•˜ëŠ”-ì´ìœ " class="level5">
<h5 class="anchored" data-anchor-id="comparison_sortedì—-ê²°ê³¼ë¥¼-ëˆ„ì í•˜ëŠ”-ì´ìœ ">comparison_sortedì— ê²°ê³¼ë¥¼ ëˆ„ì í•˜ëŠ” ì´ìœ </h5>
<p>ê° qì— ëŒ€í•´ PCA+KMeansì™€ PCA+GMMì˜ ìµœì¢… ìš”ì•½ í–‰ì„ new_rowsì— ëª¨ì€ ë’¤, new_dfë¡œ ë§Œë“  ë‹¤ìŒ ê¸°ì¡´ comparison_sortedì— concatí•˜ì—¬ ë¶™ì¸ë‹¤. ì´í›„ ARIì™€ silhouette ê¸°ì¤€ìœ¼ë¡œ ì¬ì •ë ¬í•˜ì—¬, ì–´ë–¤ í‘œí˜„ ê¸°ë°˜ ë°©ë²•ì´ ê°€ì¥ ë†’ì€ ì™¸ë¶€ ì„±ëŠ¥(ARI)ì„ ë‚´ëŠ”ì§€, ë˜ëŠ” ë‚´ë¶€ ë¶„ë¦¬ë„(silhouette)ê°€ ì¢‹ì€ì§€ í•œëˆˆì— ë¹„êµí•  ìˆ˜ ìˆê²Œ í•œë‹¤.</p>
<p>ì´ êµ¬ì¡°ëŠ” â€œë°©ë²•ë§ˆë‹¤ ìµœì  K ì„ íƒ ê¸°ì¤€ì´ ë‹¤ë¥´ë”ë¼ë„, ìµœì¢… ê²°ê³¼ë¥¼ ë™ì¼í•œ í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ì •ë¦¬í•˜ë©´ ë¹„êµê°€ ì‰¬ì›Œì§„ë‹¤â€ëŠ” ì ì„ ë³´ì—¬ì¤€ë‹¤.</p>
</section>
<section id="í•´ì„-í¬ì¸íŠ¸ê°•ì˜ìš©" class="level5">
<h5 class="anchored" data-anchor-id="í•´ì„-í¬ì¸íŠ¸ê°•ì˜ìš©">í•´ì„ í¬ì¸íŠ¸(ê°•ì˜ìš©)</h5>
<p>í‘œí˜„ê¸°ë°˜ êµ°ì§‘ì—ì„œ ì¤‘ìš”í•œ ê´€ì°° í¬ì¸íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
<li>í‘œí˜„ ì°¨ì›(q)ì´ ë‚®ì„ìˆ˜ë¡ ì‹œê°í™”ì™€ ë¶„ë¦¬ë„ëŠ” ì¢‹ì•„ ë³´ì¼ ìˆ˜ ìˆì§€ë§Œ, ì‹¤ì œ í´ë˜ìŠ¤ êµ¬ì¡°ì™€ì˜ ëŒ€ì‘ì´ ì¢‹ì•„ì§„ë‹¤ëŠ” ë³´ì¥ì€ ì—†ë‹¤. ë”°ë¼ì„œ silhouetteë§Œ ë³´ê³  ê²°ë¡ ì„ ë‚´ë¦¬ë©´ ìœ„í—˜í•  ìˆ˜ ìˆë‹¤.</li>
<li>PCA+GMMì€ BIC ê¸°ë°˜ìœ¼ë¡œ ëª¨ë¸ ë³µì¡ë„ë¥¼ ì œì–´í•˜ë©´ì„œ êµ°ì§‘ ìˆ˜ì™€ í˜•íƒœ ê°€ì •ì„ í•¨ê»˜ ì„ íƒí•œë‹¤. ì´ëŠ” ë‹¨ìˆœíˆ Kë§Œ ë°”ê¾¸ëŠ” ë°©ì‹ë³´ë‹¤ ë” â€œëª¨ë¸ ì„ íƒâ€ì˜ ì„±ê²©ì´ ê°•í•˜ë‹¤.</li>
<li>ê²°ê³¼í‘œ(comparison_sorted)ë¥¼ í†µí•´ ì „í†µì  ë°©ë²•, ëª¨ë¸ ê¸°ë°˜(GMM), í‘œí˜„ ê¸°ë°˜(PCA/AE) ë°©ë²•ì´ ê°™ì€ ê¸°ì¤€ìœ¼ë¡œ ë¹„êµë˜ë©°, ì–´ë–¤ ì¡°í•©ì´ digits êµ¬ì¡°ë¥¼ ë” ì˜ ë³µì›í•˜ëŠ”ì§€(ARI/NMI) í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<p>ì´ ì½”ë“œëŠ” PCAë¡œ ë§Œë“  ì €ì°¨ì› í‘œí˜„ ê³µê°„ì—ì„œ KMeans ë˜ëŠ” GMMì„ ìˆ˜í–‰í•˜ì—¬ êµ°ì§‘ì„ êµ¬ì„±í•˜ê³ , ë‚´ë¶€ ì§€í‘œ(silhouette, WSS)ì™€ ì™¸ë¶€ ì§€í‘œ(ARI, NMI)ë¥¼ ê³„ì‚°í•´ ê¸°ì¡´ ë¹„êµí‘œì— ì¶”ê°€í•œë‹¤. PCA ì°¨ì› ìˆ˜(q)ë¥¼ ë³€í™”ì‹œí‚¤ë©´ì„œ ì •ë³´ ë³´ì¡´(EV)ê³¼ êµ°ì§‘ ì„±ëŠ¥ì´ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ë¥¼ í•¨ê»˜ ê´€ì°°í•˜ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆìœ¼ë©°, KMeansëŠ” silhouette-bestë¡œ Kë¥¼ ì„ íƒí•˜ëŠ” ë°˜ë©´ GMMì€ BIC-bestë¡œ (covariance_type, K)ë¥¼ ë™ì‹œì— ì„ íƒí•œë‹¤ëŠ” ì ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ â€œìµœì í™” ì² í•™â€ì„ ë¹„êµí•  ìˆ˜ ìˆë‹¤.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.mixture <span class="im">import</span> GaussianMixture</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score, adjusted_rand_score, normalized_mutual_info_score</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ê³µí†µ ì„¤ì •</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>RANDOM_STATE <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>X_use <span class="op">=</span> X_std                 <span class="co"># ë™ì¼ ë¹„êµ ê¸°ì¤€(ê¶Œì¥: í‘œì¤€í™”)</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>K_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">21</span>))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>dims <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">20</span>]</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>cov_types <span class="op">=</span> [<span class="st">"spherical"</span>, <span class="st">"diag"</span>, <span class="st">"tied"</span>, <span class="st">"full"</span>]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># GMM ì˜µì…˜(ì•ì—ì„œ ì‚¬ìš©í•œ ê²ƒê³¼ ë™ì¼í•˜ê²Œ)</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>N_INIT <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>MAX_ITER <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>REG_COVAR <span class="op">=</span> <span class="fl">1e-6</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co"># í˜¹ì‹œ compute_wss í•¨ìˆ˜ê°€ ì—†ìœ¼ë©´ ì¬ì •ì˜</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_wss(X, labels):</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> np.unique(labels):</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        Xk <span class="op">=</span> X[labels <span class="op">==</span> k]</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> Xk.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        wss <span class="op">+=</span> ((Xk <span class="op">-</span> mu) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(wss)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co"># (A) ê¸°ì¡´ comparison_sortedê°€ ì—†ìœ¼ë©´ ìƒì„±(ì•ˆì „ì¥ì¹˜)</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"comparison_sorted"</span> <span class="kw">not</span> <span class="kw">in</span> <span class="bu">globals</span>():</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    comparison_sorted <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"method"</span>,<span class="st">"K"</span>,<span class="st">"silhouette"</span>,<span class="st">"wss"</span>,<span class="st">"ARI"</span>,<span class="st">"NMI"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>])</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co"># (B) PCA + KMeans / PCA + GMM(BIC) ê²°ê³¼ ìƒì„± í›„ comparison_sortedì— ì¶”ê°€</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>new_rows <span class="op">=</span> []</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> dims:</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1) PCA ì„ë² ë”©</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    pca <span class="op">=</span> PCA(n_components<span class="op">=</span>q, random_state<span class="op">=</span>RANDOM_STATE)</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> pca.fit_transform(X_use)</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    evr <span class="op">=</span> pca.explained_variance_ratio_.<span class="bu">sum</span>()</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># -------------------------</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2) PCA + KMeans : Silhouette-best K ì„ íƒ</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># -------------------------</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    km_records <span class="op">=</span> []</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>        km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>K, random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>        z_km <span class="op">=</span> km.fit_predict(Z)</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>        km_records.append({</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">"K"</span>: K,</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">"silhouette"</span>: silhouette_score(Z, z_km, metric<span class="op">=</span><span class="st">"euclidean"</span>),</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">"wss"</span>: <span class="bu">float</span>(km.inertia_),  <span class="co"># PCA ê³µê°„ì—ì„œì˜ WSS</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">"ARI"</span>: adjusted_rand_score(y, z_km),</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_km),</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    km_df <span class="op">=</span> pd.DataFrame(km_records)</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    km_best <span class="op">=</span> km_df.loc[km_df[<span class="st">"silhouette"</span>].idxmax()]</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>    new_rows.append({</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="ss">f"PCA(</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">D, EV=</span><span class="sc">{</span>evr<span class="sc">:.3f}</span><span class="ss">) + KMeans (Sil-best)"</span>,</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: <span class="bu">int</span>(km_best[<span class="st">"K"</span>]),</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: <span class="bu">float</span>(km_best[<span class="st">"silhouette"</span>]),</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: <span class="bu">float</span>(km_best[<span class="st">"wss"</span>]),</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: <span class="bu">float</span>(km_best[<span class="st">"ARI"</span>]),</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: <span class="bu">float</span>(km_best[<span class="st">"NMI"</span>]),</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AIC"</span>: np.nan,</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BIC"</span>: np.nan</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># -------------------------</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3) PCA + GMM : (cov_type, K) ì¤‘ BIC ìµœì†Œ ì„ íƒ</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># -------------------------</span></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>    gmm_records <span class="op">=</span> []</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cov <span class="kw">in</span> cov_types:</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>            gmm <span class="op">=</span> GaussianMixture(</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>                n_components<span class="op">=</span>K,</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>                covariance_type<span class="op">=</span>cov,</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>                random_state<span class="op">=</span>RANDOM_STATE,</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>                n_init<span class="op">=</span>N_INIT,</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>                max_iter<span class="op">=</span>MAX_ITER,</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>                reg_covar<span class="op">=</span>REG_COVAR,</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>                init_params<span class="op">=</span><span class="st">"kmeans"</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>            gmm.fit(Z)</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>            gmm_records.append({</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>                <span class="st">"covariance_type"</span>: cov,</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>                <span class="st">"K"</span>: K,</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>                <span class="st">"AIC"</span>: gmm.aic(Z),</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>                <span class="st">"BIC"</span>: gmm.bic(Z),</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>    gmm_df <span class="op">=</span> pd.DataFrame(gmm_records)</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>    best <span class="op">=</span> gmm_df.loc[gmm_df[<span class="st">"BIC"</span>].idxmin()]</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>    bestK <span class="op">=</span> <span class="bu">int</span>(best[<span class="st">"K"</span>])</span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>    bestCov <span class="op">=</span> <span class="bu">str</span>(best[<span class="st">"covariance_type"</span>])</span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ì„ íƒëœ ì„¤ì •ìœ¼ë¡œ ì¬í•™ìŠµ í›„ ë¼ë²¨ ì‚°ì¶œ</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>    gmm_best <span class="op">=</span> GaussianMixture(</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>        n_components<span class="op">=</span>bestK,</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>        covariance_type<span class="op">=</span>bestCov,</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span>RANDOM_STATE,</span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>        n_init<span class="op">=</span>N_INIT,</span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>        max_iter<span class="op">=</span>MAX_ITER,</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>        reg_covar<span class="op">=</span>REG_COVAR,</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>        init_params<span class="op">=</span><span class="st">"kmeans"</span></span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>    ).fit(Z)</span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>    z_gmm <span class="op">=</span> gmm_best.predict(Z)</span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>    new_rows.append({</span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="ss">f"PCA(</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">D, EV=</span><span class="sc">{</span>evr<span class="sc">:.3f}</span><span class="ss">) + GMM(BIC-best, </span><span class="sc">{</span>bestCov<span class="sc">}</span><span class="ss">)"</span>,</span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: bestK,</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: silhouette_score(Z, z_gmm, metric<span class="op">=</span><span class="st">"euclidean"</span>),</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: compute_wss(Z, z_gmm),</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_gmm),</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_gmm),</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AIC"</span>: <span class="bu">float</span>(best[<span class="st">"AIC"</span>]),</span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BIC"</span>: <span class="bu">float</span>(best[<span class="st">"BIC"</span>])</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a><span class="co"># (C) comparison_sortedì— í–‰ ì¶”ê°€ + ì¬ì •ë ¬</span></span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.DataFrame(new_rows)</span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>comparison_sorted <span class="op">=</span> (</span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>    pd.concat([comparison_sorted, new_df], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>      .sort_values([<span class="st">"ARI"</span>, <span class="st">"silhouette"</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>      .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>display(new_df)              <span class="co"># ì´ë²ˆì— ì¶”ê°€ëœ í–‰ë§Œ í™•ì¸</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>display(comparison_sorted)   <span class="co"># ì „ì²´ ë¹„êµí‘œ(ì „í†µì  + GMM + PCAê¸°ë°˜ í™•ì¥)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="í‘œí˜„ê¸°ë°˜-êµ°ì§‘-ê²°ê³¼-í•´ì„" class="level5">
<h5 class="anchored" data-anchor-id="í‘œí˜„ê¸°ë°˜-êµ°ì§‘-ê²°ê³¼-í•´ì„">í‘œí˜„ê¸°ë°˜ êµ°ì§‘ ê²°ê³¼ í•´ì„</h5>
<p>í‘œí˜„ê¸°ë°˜ êµ°ì§‘ì€ ì›ìë£Œ(64ì°¨ì› í”½ì…€ ê³µê°„)ì—ì„œ ë°”ë¡œ êµ°ì§‘ì„ ìˆ˜í–‰í•˜ê¸°ë³´ë‹¤, ë¨¼ì € ì €ì°¨ì› í‘œí˜„ê³µê°„ì„ ë§Œë“  ë’¤ ê·¸ ê³µê°„ì—ì„œ êµ°ì§‘ì„ ìˆ˜í–‰í•œë‹¤. ì—¬ê¸°ì„œëŠ” PCAë¡œ 2ì°¨ì›, 10ì°¨ì›, 20ì°¨ì› í‘œí˜„ì„ ë§Œë“  ë’¤ KMeans ë˜ëŠ” GMMì„ ì ìš©í•œ ê²°ê³¼ê°€ ì •ë¦¬ë˜ì–´ ìˆë‹¤. í‘œì— ì œì‹œëœ EVëŠ” PCAê°€ ì„¤ëª…í•˜ëŠ” ëˆ„ì  ë¶„ì‚°ë¹„ìœ¨ì´ë©°, EVê°€ í´ìˆ˜ë¡ ì›ìë£Œì˜ ë³€ë™ì„ ë” ë§ì´ ë³´ì¡´í•œ í‘œí˜„ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p>
<p>ì²«ì§¸, 2ì°¨ì› PCA ê¸°ë°˜ ê²°ê³¼ëŠ” silhouetteì´ ë§¤ìš° ë†’ê²Œ ë‚˜ì™”ì§€ë§Œ(0.37~0.39), ARIì™€ NMIëŠ” ë‚®ê²Œ ë‚˜íƒ€ë‚¬ë‹¤(ARI ì•½ 0.20~0.33, NMI ì•½ 0.44~0.47). ì´ëŠ” 2ì°¨ì›ìœ¼ë¡œ ê°•í•˜ê²Œ ì••ì¶•í•˜ë©´ êµ°ì§‘ ê°„ ê±°ë¦¬ êµ¬ì¡°ê°€ ë‹¨ìˆœí•´ì ¸ ë‚´ë¶€ì§€í‘œ(silhouette)ëŠ” ì¢‹ì•„ì§ˆ ìˆ˜ ìˆìœ¼ë‚˜, ì‹¤ì œ ìˆ«ì ë¼ë²¨ì˜ ë³µì¡í•œ í˜•íƒœ ì°¨ì´ë¥¼ ì¶©ë¶„íˆ ë‹´ì§€ ëª»í•´ ì™¸ë¶€ì§€í‘œ(ARI/NMI)ì—ì„œ ë¶ˆë¦¬í•´ì§ˆ ìˆ˜ ìˆìŒì„ ì‹œì‚¬í•œë‹¤. ì¦‰, â€œë³´ê¸° ì¢‹ì€ ë¶„ë¦¬â€ì™€ â€œì •ë‹µ ë¼ë²¨ê³¼ì˜ ì¼ì¹˜â€ëŠ” ë‹¤ë¥¸ ëª©í‘œì´ë©°, ì €ì°¨ì›ìœ¼ë¡œ ê³¼ë„í•˜ê²Œ ì¶•ì•½í•˜ë©´ ë‘ ëª©í‘œê°€ ë™ì‹œì— ë§Œì¡±ë˜ê¸° ì–´ë µë‹¤.</p>
<p>ë‘˜ì§¸, 10ì°¨ì› PCA ê¸°ë°˜ ê²°ê³¼ëŠ” í‘œí˜„ê¸°ë°˜ êµ°ì§‘ ê°€ìš´ë° ê°€ì¥ ê· í˜•ì´ ì¢‹ë‹¤. EVê°€ 0.589ë¡œ, ì›ìë£Œ ë³€ë™ì˜ ì•½ 59%ë¥¼ ë³´ì¡´í•˜ë©´ì„œ ARIê°€ 0.538~0.565, NMIê°€ 0.670~0.708 ìˆ˜ì¤€ìœ¼ë¡œ í¬ê²Œ ìƒìŠ¹í•œë‹¤. íŠ¹íˆ PCA(10D)+GMM(BIC-best, full)ì´ ARI 0.5649, NMI 0.7076ìœ¼ë¡œ ì œì‹œëœ í‘œí˜„ê¸°ë°˜ ë°©ë²• ì¤‘ ìƒìœ„ê¶Œì´ë©°, ê°™ì€ 10ì°¨ì›ì—ì„œ KMeansë„ ARI 0.5381, NMI 0.6695ë¡œ ì¶©ë¶„íˆ ê²½ìŸë ¥ ìˆë‹¤. ì´ëŠ” digits ë°ì´í„°ì˜ êµ¬ì¡°ê°€ ë‹¨ìˆœí•œ ì„ í˜•ì¶• 2ê°œë¡œëŠ” ì„¤ëª…ì´ ì–´ë µì§€ë§Œ, 10ì°¨ì› ì •ë„ì˜ ì„ í˜• í‘œí˜„ì—ì„œëŠ” ìˆ«ì ëª¨ì–‘ì˜ ì£¼ìš” ë³€ë™(íšì˜ êµµê¸°, ê¸°ìš¸ê¸°, ë¶€ë¶„ íŒ¨í„´)ì„ ìƒë‹¹ ë¶€ë¶„ ë³´ì¡´í•˜ê¸° ë•Œë¬¸ìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤.</p>
<p>ì…‹ì§¸, 20ì°¨ì› PCA ê¸°ë°˜ ê²°ê³¼ëŠ” EVê°€ 0.793ê¹Œì§€ ì˜¬ë¼ê°€ë©° ì •ë³´ ë³´ì¡´ì€ ë” ì¢‹ì•„ì§€ì§€ë§Œ, ì™¸ë¶€ì§€í‘œëŠ” 10ì°¨ì› ëŒ€ë¹„ ëšœë ·í•œ ì¶”ê°€ ì´ë“ì´ í¬ì§€ ì•Šë‹¤. PCA(20D)+KMeansëŠ” ARI 0.5511, NMI 0.6817ì´ê³ , PCA(20D)+GMMì€ ARI 0.5459, NMI 0.6976ìœ¼ë¡œ 10ì°¨ì› GMMì˜ ì„±ëŠ¥ì„ ë„˜ì§€ ëª»í•œë‹¤. ì´ëŠ” 10ì°¨ì› ìˆ˜ì¤€ì—ì„œ ì´ë¯¸ â€œêµ°ì§‘ì— ìœ ë¦¬í•œ í•µì‹¬ ë³€ë™â€ì„ ìƒë‹¹íˆ í¬ì°©í–ˆê³ , 20ì°¨ì›ìœ¼ë¡œ ëŠ˜ë¦¬ë©´ì„œ ì¶”ê°€ë˜ëŠ” ì„±ë¶„ì´ êµ°ì§‘ì„ ë” ì„ ëª…í•˜ê²Œ ë§Œë“¤ê¸°ë³´ë‹¤ëŠ” ìˆ«ì ë‚´ ë³€í˜•(í•„ê¸°ì²´ ì°¨ì´, ë…¸ì´ì¦ˆ)ì„ í•¨ê»˜ ë‹´ì•„ êµ°ì§‘ ê²½ê³„ë¥¼ ë‹¤ì†Œ íë¦´ ìˆ˜ ìˆìŒì„ ì‹œì‚¬í•œë‹¤. ê°™ì€ ë§¥ë½ì—ì„œ 20ì°¨ì›ì—ì„œëŠ” Kê°€ 11~15ê¹Œì§€ ì»¤ì§€ëŠ”ë°, ì´ëŠ” í´ë˜ìŠ¤(0~9)ë¥¼ ë„˜ì–´ ì„¸ë¶€ ë³€í˜•ì„ ì—¬ëŸ¬ êµ°ì§‘ìœ¼ë¡œ ìª¼ê°œëŠ” ê²½í–¥ê³¼ ì—°ê²°ëœë‹¤.</p>
<p>ë„·ì§¸, ë™ì¼í•œ PCA ì°¨ì›ì—ì„œ KMeansì™€ GMMì„ ë¹„êµí•˜ë©´, 10ì°¨ì›ì—ì„œëŠ” GMMì´ KMeansë³´ë‹¤ ARI/NMIê°€ ì•½ê°„ ë” ë†’ë‹¤. ì´ëŠ” ê³µë¶„ì‚°ì„ í—ˆìš©í•˜ëŠ” í˜¼í•©ì •ê·œëª¨í˜•ì´ ë‹¨ìˆœ êµ¬í˜• êµ°ì§‘ì„ ê°€ì •í•˜ëŠ” KMeansë³´ë‹¤, ì„ë² ë”© ê³µê°„ì—ì„œì˜ íƒ€ì›í˜• ë¶„í¬ë‚˜ êµ°ì§‘ë³„ ë¶„ì‚° ì°¨ì´ë¥¼ ë” ì˜ ë°˜ì˜í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ë°˜ë©´ 2ì°¨ì›ì—ì„œëŠ” ë‘ ë°©ë²• ëª¨ë‘ ì™¸ë¶€ì§€í‘œê°€ ë‚®ì•„, ëª¨ë¸ ì„ íƒì˜ ì´ë“ë³´ë‹¤ ì°¨ì› ì¶•ì†Œë¡œ ì¸í•œ ì •ë³´ ì†ì‹¤ì´ ë” ì§€ë°°ì ì´ë¼ëŠ” í•´ì„ì´ ê°€ëŠ¥í•˜ë‹¤.</p>
<p>ìš”ì•½í•˜ë©´, í‘œí˜„ê¸°ë°˜ êµ°ì§‘ì—ì„œëŠ” â€œì°¨ì› ì¶•ì†Œì˜ ì •ë„â€ê°€ ì„±ëŠ¥ì„ ì¢Œìš°í•œë‹¤. 2ì°¨ì›ì€ ë‚´ë¶€ì§€í‘œëŠ” ì¢‹ì§€ë§Œ ì •ë‹µ ë¼ë²¨ê³¼ì˜ ì •í•©ì„±ì´ ë–¨ì–´ì§€ê³ , 10ì°¨ì›ì€ ë‚´ë¶€ì§€í‘œì™€ ì™¸ë¶€ì§€í‘œì˜ ê· í˜•ì´ ê°€ì¥ ì¢‹ìœ¼ë©°, 20ì°¨ì›ì€ ì •ë³´ ë³´ì¡´ì€ ë” í¬ì§€ë§Œ êµ°ì§‘ ì„±ëŠ¥ì´ ë°˜ë“œì‹œ ê°œì„ ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ digitsì™€ ê°™ì€ í˜•íƒœ ê¸°ë°˜ ë°ì´í„°ì—ì„œëŠ” PCA ì°¨ì›ì„ ë„ˆë¬´ ë‚®ê²Œ ì¡ê¸°ë³´ë‹¤, 10ì°¨ì› ë‚´ì™¸ì—ì„œ GMM ë˜ëŠ” KMeansë¥¼ ë¹„êµí•˜ëŠ” ì „ëµì´ í•©ë¦¬ì ì´ë‹¤. ì´í›„ ë‹¨ê³„ë¡œ ì˜¤í† ì¸ì½”ë”ë‚˜ DECë¥˜ ë°©ë²•ì„ ë„ì…í•˜ë©´ ì„ í˜• PCAê°€ ë‹´ì§€ ëª»í•œ ë¹„ì„ í˜• êµ¬ì¡°ê¹Œì§€ í‘œí˜„ê³µê°„ì— ë°˜ì˜í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, 10~20ì°¨ì›ëŒ€ì˜ ì„ë² ë”©ì„ í•™ìŠµí•˜ë©´ì„œ êµ°ì§‘ ëª©ì ì„ í•¨ê»˜ ìµœì í™”í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ í™•ì¥ì´ ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§„ë‹¤.</p>
<pre class="text"><code>
method  K   silhouette  wss ARI NMI AIC BIC
0   PCA(2D, EV=0.216) + KMeans (Sil-best)   8   0.392024    3563.424744 0.331101    0.472753    NaN NaN
1   PCA(2D, EV=0.216) + GMM(BIC-best, full) 4   0.370952    8414.589706 0.199783    0.436065    16308.982097    16435.341197
2   PCA(10D, EV=0.589) + KMeans (Sil-best)  12  0.287190    23293.872256    0.538087    0.669544    NaN NaN
3   PCA(10D, EV=0.589) + GMM(BIC-best, full)    13  0.251226    25275.837661    0.564898    0.707620    50025.756510    54734.006431
4   PCA(20D, EV=0.793) + KMeans (Sil-best)  15  0.222177    37368.974559    0.551132    0.681702    NaN NaN
5   PCA(20D, EV=0.793) + GMM(BIC-best, full)    11  0.193245    47099.997586    0.545944    0.697619    61251.650935    75206.090607
method  K   silhouette  wss ARI NMI AIC BIC
0   Hierarchical(Ward) (Sil-best)   20  0.152754    54003.237083    0.688082    0.794962    NaN NaN
1   KMeans (Sil-best)   15  0.158307    59534.498937    0.568326    0.688241    NaN NaN
2   PCA(10D, EV=0.589) + GMM(BIC-best, full)    13  0.251226    25275.837661    0.564898    0.707620    50025.756510    54734.006431
3   PCA(20D, EV=0.793) + KMeans (Sil-best)  15  0.222177    37368.974559    0.551132    0.681702    NaN NaN
4   PCA(20D, EV=0.793) + GMM(BIC-best, full)    11  0.193245    47099.997586    0.545944    0.697619    61251.650935    75206.090607
5   PCA(10D, EV=0.589) + KMeans (Sil-best)  12  0.287190    23293.872256    0.538087    0.669544    NaN NaN
6   GMM(BIC-best, diag) 20  0.093540    62457.729652    0.437694    0.596951    -232769.805429  -218601.104675
7   PCA(2D, EV=0.216) + KMeans (Sil-best)   8   0.392024    3563.424744 0.331101    0.472753    NaN NaN
8   PCA(2D, EV=0.216) + GMM(BIC-best, full) 4   0.370952    8414.589706 0.199783    0.436065    16308.982097    16435.341197
9   Hierarchical(Complete) (Sil-best)   2   0.784424    106721.094913   0.000002    0.001556    NaN NaN</code></pre>
</section>
</section>
<section id="ì˜¤í† ì¸ì½”ë”-ê¸°ë°˜-í‘œí˜„-êµ°ì§‘autoencoder-clustering-deep-clustering-ê°œë…-ì‹¤í—˜" class="level4">
<h4 class="anchored" data-anchor-id="ì˜¤í† ì¸ì½”ë”-ê¸°ë°˜-í‘œí˜„-êµ°ì§‘autoencoder-clustering-deep-clustering-ê°œë…-ì‹¤í—˜">5. ì˜¤í† ì¸ì½”ë” ê¸°ë°˜ í‘œí˜„ êµ°ì§‘(AutoEncoder + Clustering) deep clustering ê°œë… ì‹¤í—˜</h4>
<p>ì´ ì ˆì˜ ì½”ë“œëŠ” ì›ìë£Œ Xë¥¼ ì§ì ‘ êµ°ì§‘í™”í•˜ì§€ ì•Šê³ , ì‹ ê²½ë§ ê¸°ë°˜ ì˜¤í† ì¸ì½”ë”(AutoEncoder)ë¥¼ ì´ìš©í•˜ì—¬ ì ì¬í‘œí˜„(latent representation)ì„ í•™ìŠµí•œ ë’¤, ê·¸ ì ì¬ê³µê°„ì—ì„œ êµ°ì§‘ì„ ìˆ˜í–‰í•œë‹¤. ì´ëŠ” ë‹¨ìˆœ ì„ í˜• ì°¨ì›ì¶•ì†Œ(PCA)ì™€ ë‹¬ë¦¬ ë¹„ì„ í˜• êµ¬ì¡°ë¥¼ ë°˜ì˜í•  ìˆ˜ ìˆëŠ” í‘œí˜„ì„ í•™ìŠµí•œë‹¤ëŠ” ì ì—ì„œ ì˜ë¯¸ê°€ ìˆë‹¤.</p>
<section id="ì˜¤í† ì¸ì½”ë”ì˜-ê¸°ë³¸-êµ¬ì¡°" class="level5">
<h5 class="anchored" data-anchor-id="ì˜¤í† ì¸ì½”ë”ì˜-ê¸°ë³¸-êµ¬ì¡°">ì˜¤í† ì¸ì½”ë”ì˜ ê¸°ë³¸ êµ¬ì¡°</h5>
<p>ì˜¤í† ì¸ì½”ë”ëŠ” ì…ë ¥ì„ ë³µì›í•˜ë„ë¡ í•™ìŠµë˜ëŠ” ì‹ ê²½ë§ì´ë‹¤. êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì…ë ¥ì¸µ â†’ ì¸ì½”ë” â†’ ì ì¬ê³µê°„(latent space) â†’ ë””ì½”ë” â†’ ë³µì›ì¶œë ¥. í•™ìŠµ ëª©ì ì€ ë‹¤ìŒ ì†ì‹¤í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒì´ë‹¤.</p>
<p><span class="math inline">\(\min_{\theta} \sum_{i=1}^{n} |x_i - \hat{x}_i|^2\)</span>, ì—¬ê¸°ì„œ <span class="math inline">\(x_i\)</span> ëŠ” ì› ì…ë ¥, <span class="math inline">\(\hat{x}_i\)</span> ëŠ” ë³µì›ëœ ì¶œë ¥ ì ì¬ê³µê°„ì˜ ì°¨ì›ì€ që¡œ ì„¤ì •í•œë‹¤. ì¦‰, ì…ë ¥ì„ qì°¨ì›ìœ¼ë¡œ ì••ì¶•í–ˆë‹¤ê°€ ë‹¤ì‹œ ì›ë˜ ì°¨ì›ìœ¼ë¡œ ë³µì›í•˜ë„ë¡ í•™ìŠµí•œë‹¤.</p>
</section>
<section id="ì ì¬í‘œí˜„z-ì¶”ì¶œ" class="level5">
<h5 class="anchored" data-anchor-id="ì ì¬í‘œí˜„z-ì¶”ì¶œ">ì ì¬í‘œí˜„(Z) ì¶”ì¶œ</h5>
<p>í•™ìŠµì´ ì™„ë£Œë˜ë©´ ì¸ì½”ë” ë¶€ë¶„ë§Œ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒì„ ì–»ëŠ”ë‹¤.</p>
<p><span class="math inline">\(Z = Encoder(X_{\text{std}})\)</span></p>
<p>ì´ ZëŠ” ì›ìë£Œì˜ ë¹„ì„ í˜• êµ¬ì¡°ê°€ ë°˜ì˜ëœ ì„ë² ë”©ì´ë‹¤. ì°¨ì› ìˆ˜ qëŠ” ì‹¤í—˜ì ìœ¼ë¡œ ì—¬ëŸ¬ ê°’(ì˜ˆ: 2, 10, 20 ë“±)ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.</p>
<p>PCAì™€ ë‹¬ë¦¬ ì˜¤í† ì¸ì½”ë”ëŠ” ì„ í˜• ë³€í™˜ì´ ì•„ë‹ˆë¼ ë¹„ì„ í˜• ë³€í™˜ì´ë¯€ë¡œ, ë°ì´í„°ì˜ ë³µì¡í•œ ê³¡ì„ í˜• êµ¬ì¡°ë¥¼ ë” ì˜ í¬ì°©í•  ê°€ëŠ¥ì„±ì´ ìˆë‹¤.</p>
</section>
<section id="ì ì¬ê³µê°„ì—ì„œì˜-êµ°ì§‘-ìˆ˜í–‰" class="level5">
<h5 class="anchored" data-anchor-id="ì ì¬ê³µê°„ì—ì„œì˜-êµ°ì§‘-ìˆ˜í–‰">ì ì¬ê³µê°„ì—ì„œì˜ êµ°ì§‘ ìˆ˜í–‰</h5>
<p>ì–»ì–´ì§„ Z ê³µê°„ì—ì„œ ë‹¤ìŒ ë‘ ê°€ì§€ êµ°ì§‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
<li>KMeans</li>
<li>GMM</li>
</ul>
<p><strong>(1) AutoEncoder + KMeans</strong></p>
<p>K=2~20ì— ëŒ€í•´ KMeansë¥¼ ìˆ˜í–‰í•˜ê³  ë‹¤ìŒ ì§€í‘œë¥¼ ê³„ì‚°í•œë‹¤.</p>
<p>silhouette(Z ê³µê°„ì—ì„œ ê³„ì‚°), WSS, ARI, NMI</p>
<p>Silhouetteê°€ ìµœëŒ€ê°€ ë˜ëŠ” Kë¥¼ ì„ íƒí•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ë¹„êµí‘œì— ì¶”ê°€í•œë‹¤. í•´ì„ìƒ ì¤‘ìš”í•œ ì ì€ silhouetteê°€ Z ê³µê°„ì—ì„œ ê³„ì‚°ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ì¦‰, ì›ê³µê°„ì—ì„œì˜ ê±°ë¦¬ êµ¬ì¡°ê°€ ì•„ë‹ˆë¼ í•™ìŠµëœ í‘œí˜„ ê³µê°„ì—ì„œì˜ êµ°ì§‘ ì‘ì§‘ë„ì™€ ë¶„ë¦¬ë„ë¥¼ í‰ê°€í•˜ëŠ” ê²ƒì´ë‹¤.</p>
<p><strong>(2) AutoEncoder + GMM</strong></p>
<p>GMMì„ ì ìš©í•  ê²½ìš° ë‹¤ìŒì„ ìˆ˜í–‰í•œë‹¤.</p>
<ul>
<li>covariance_typeì„ ì—¬ëŸ¬ í˜•íƒœë¡œ ì„¤ì •</li>
<li>K=2~20 ë²”ìœ„ì—ì„œ ëª¨ë“  ì¡°í•©ì„ íƒìƒ‰</li>
<li>BIC ê¸°ì¤€ ìµœì†Œê°’ì„ ì„ íƒ</li>
</ul>
<p>ì„ íƒëœ (covariance_type, K) ì¡°í•©ìœ¼ë¡œ ìµœì¢… ëª¨ë¸ì„ ì í•©í•˜ê³  hard labelì„ ìƒì„±í•œë‹¤. ì´í›„ silhouette, WSS, ARI, NMIë¥¼ ê³„ì‚°í•œë‹¤.</p>
<p>BICëŠ” ëª¨ë¸ ë³µì¡ë„ì— ëŒ€í•œ ë²Œì ì„ í¬í•¨í•˜ë¯€ë¡œ, ì ì¬ê³µê°„ì—ì„œ ê³¼ë„í•˜ê²Œ ë§ì€ êµ°ì§‘ì„ ì„ íƒí•˜ëŠ” ê²ƒì„ ì–µì œí•˜ëŠ” ì—­í• ì„ í•œë‹¤.</p>
</section>
<section id="pca-ê¸°ë°˜-í‘œí˜„ê³¼ì˜-êµ¬ì¡°ì -ì°¨ì´" class="level5">
<h5 class="anchored" data-anchor-id="pca-ê¸°ë°˜-í‘œí˜„ê³¼ì˜-êµ¬ì¡°ì -ì°¨ì´">PCA ê¸°ë°˜ í‘œí˜„ê³¼ì˜ êµ¬ì¡°ì  ì°¨ì´</h5>
<p>PCAëŠ” ì„ í˜• ë³€í™˜ì´ë¯€ë¡œ ë°ì´í„°ì˜ ê³µë¶„ì‚° êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì‚°ì„ ìµœëŒ€í•œ ë³´ì¡´í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì°¨ì›ì„ ì¶•ì†Œí•œë‹¤. ë°˜ë©´ ì˜¤í† ì¸ì½”ë”ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì°¨ì´ë¥¼ ê°€ì§„ë‹¤.</p>
<ul>
<li>ë¹„ì„ í˜• ë³€í™˜ ê°€ëŠ¥</li>
<li>ì€ë‹‰ì¸µ êµ¬ì¡°ì— ë”°ë¼ ë³µì¡í•œ í‘œí˜„ í•™ìŠµ ê°€ëŠ¥</li>
<li>ì¬êµ¬ì„± ì˜¤ì°¨ ìµœì†Œí™”ê°€ ëª©ì </li>
</ul>
<p>ë”°ë¼ì„œ ì˜¤í† ì¸ì½”ë” ì ì¬ê³µê°„ì€ â€œë¶„ì‚° ìµœëŒ€í™”â€ê°€ ì•„ë‹ˆë¼ â€œë³µì› ìµœì í™”â€ ê´€ì ì—ì„œ í˜•ì„±ëœ ê³µê°„ì´ë‹¤. ì´ ë•Œë¬¸ì— PCAì—ì„œ ì˜ ë¶„ë¦¬ë˜ì§€ ì•Šë˜ êµ¬ì¡°ê°€ ì˜¤í† ì¸ì½”ë”ì—ì„œëŠ” ë” ëª…í™•í•´ì§ˆ ìˆ˜ë„ ìˆê³ , ë°˜ëŒ€ë¡œ ë³µì› ìœ„ì£¼ í•™ìŠµ ë•Œë¬¸ì— êµ°ì§‘ ë¶„ë¦¬ê°€ ëšœë ·í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤.</p>
</section>
<section id="ì§€í‘œ-í•´ì„-ê´€ì " class="level5">
<h5 class="anchored" data-anchor-id="ì§€í‘œ-í•´ì„-ê´€ì ">ì§€í‘œ í•´ì„ ê´€ì </h5>
<p>AutoEncoder ê¸°ë°˜ êµ°ì§‘ ê²°ê³¼ë¥¼ í•´ì„í•  ë•ŒëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ë¥¼ í•¨ê»˜ ë³¸ë‹¤.</p>
<ul>
<li>silhouette:ì ì¬ê³µê°„ì—ì„œ êµ°ì§‘ ê°„ ë¶„ë¦¬ë„ê°€ ì¢‹ì€ê°€</li>
<li>ARI, NMI: ì‹¤ì œ ìˆ«ì êµ¬ì¡°ì™€ ì–¼ë§ˆë‚˜ ì¼ì¹˜í•˜ëŠ”ê°€</li>
<li>K ì„ íƒ ë°©ì‹: silhouette-bestì¸ì§€, BIC-bestì¸ì§€ì— ë”°ë¼ í•´ì„ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ</li>
</ul>
<p>íŠ¹íˆ ARIê°€ ë†’ë‹¤ë©´, ì ì¬í‘œí˜„ì´ ì‹¤ì œ í´ë˜ìŠ¤ êµ¬ì¡°ë¥¼ ì˜ ë°˜ì˜í•˜ê³  ìˆìŒì„ ì˜ë¯¸í•œë‹¤. silhouetteê°€ ë†’ì§€ë§Œ ARIê°€ ë‚®ë‹¤ë©´, ì ì¬ê³µê°„ì—ì„œ ë‹¤ë¥¸ ìš”ì¸(ë°ê¸°, íš ë‘ê»˜ ë“±)ì— ì˜í•´ ë¶„ë¦¬ëœ ê°€ëŠ¥ì„±ì„ ê³ ë ¤í•´ì•¼ í•œë‹¤.</p>
</section>
<section id="ë¹„êµí‘œì—-ì¶”ê°€ë˜ëŠ”-ì˜ë¯¸" class="level5">
<h5 class="anchored" data-anchor-id="ë¹„êµí‘œì—-ì¶”ê°€ë˜ëŠ”-ì˜ë¯¸">ë¹„êµí‘œì— ì¶”ê°€ë˜ëŠ” ì˜ë¯¸</h5>
<p>ìµœì¢…ì ìœ¼ë¡œ AutoEncoder ê¸°ë°˜ êµ°ì§‘ì€ comparison_sortedì— ì¶”ê°€ëœë‹¤. ì´ë¥¼ í†µí•´ ë‹¤ìŒì„ ë™ì‹œì— ë¹„êµí•  ìˆ˜ ìˆë‹¤.</p>
<ul>
<li>ì „í†µì  êµ°ì§‘(KMeans, Ward ë“±)</li>
<li>PCA ê¸°ë°˜ í‘œí˜„ êµ°ì§‘</li>
<li>AutoEncoder ê¸°ë°˜ í‘œí˜„ êµ°ì§‘</li>
<li>GMM ëª¨ë¸ ê¸°ë°˜ êµ°ì§‘</li>
</ul>
<p>ì´ êµ¬ì¡°ëŠ” â€œí‘œí˜„ì„ ë°”ê¾¸ë©´ êµ°ì§‘ í’ˆì§ˆì´ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ê°€â€ë¥¼ ì‹¤í—˜ì ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•œ ì„¤ê³„ì´ë‹¤.</p>
<p>ì˜¤í† ì¸ì½”ë” ê¸°ë°˜ êµ°ì§‘ ì½”ë“œëŠ” ë¨¼ì € ë¹„ì„ í˜• ì ì¬ê³µê°„ì„ í•™ìŠµí•œ ë’¤, ê·¸ ê³µê°„ì—ì„œ KMeans ë˜ëŠ” GMMì„ ìˆ˜í–‰í•˜ì—¬ êµ°ì§‘ì„ ìƒì„±í•œë‹¤. ì ì¬í‘œí˜„ì€ ë³µì› ì˜¤ì°¨ ìµœì†Œí™”ë¥¼ í†µí•´ í•™ìŠµë˜ë¯€ë¡œ, ë‹¨ìˆœ ë¶„ì‚° ìµœëŒ€í™” ê¸°ë°˜ì˜ PCAì™€ ë‹¤ë¥¸ êµ¬ì¡°ë¥¼ ê°€ì§„ë‹¤. êµ°ì§‘ í‰ê°€ëŠ” ì ì¬ê³µê°„ì—ì„œì˜ silhouetteì™€ ì‹¤ì œ ë¼ë²¨ê³¼ì˜ ì¼ì¹˜ë„(ARI, NMI)ë¥¼ í•¨ê»˜ í™•ì¸í•˜ë©°, ì´ë¥¼ ê¸°ì¡´ ë¹„êµí‘œì— ëˆ„ì í•˜ì—¬ ë‹¤ì–‘í•œ êµ°ì§‘ ì „ëµ ê°„ ì„±ëŠ¥ì„ ì¢…í•©ì ìœ¼ë¡œ ë¹„êµí•˜ë„ë¡ êµ¬ì„±ë˜ì–´ ìˆë‹¤.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Deep clustering (ê°œë… ì‹¤í—˜): AutoEncoder ì„ë² ë”© + KMeans</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  - ì„ë² ë”© ê³µê°„ì—ì„œ KMeansë¥¼ ìˆ˜í–‰í•˜ê³  Silhouette-best Kë¥¼ ì„ íƒ</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  - ê²°ê³¼ë¥¼ comparison_sortedì— í–‰(row)ë¡œ ì¶”ê°€</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score, adjusted_rand_score, normalized_mutual_info_score</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- ì¬í˜„ì„± ----</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>RANDOM_STATE <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_STATE)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(RANDOM_STATE)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- ì•ˆì „ì¥ì¹˜: comparison_sortedê°€ ì—†ìœ¼ë©´ ìƒì„± ----</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"comparison_sorted"</span> <span class="kw">not</span> <span class="kw">in</span> <span class="bu">globals</span>():</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    comparison_sorted <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"method"</span>,<span class="st">"K"</span>,<span class="st">"silhouette"</span>,<span class="st">"wss"</span>,<span class="st">"ARI"</span>,<span class="st">"NMI"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>])</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- WSS ê³„ì‚° í•¨ìˆ˜(ì„ë² ë”© ê³µê°„) ----</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_wss(X, labels):</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> np.unique(labels):</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        Xk <span class="op">=</span> X[labels <span class="op">==</span> k]</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> Xk.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>        wss <span class="op">+=</span> ((Xk <span class="op">-</span> mu) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(wss)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) ì˜¤í† ì¸ì½”ë” í•™ìŠµìš© ë°ì´í„° ì¤€ë¹„</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   - NNì€ ë³´í†µ 0~1 ìŠ¤ì¼€ì¼ì´ ì•ˆì •ì ì´ë¯€ë¡œ MinMaxScalerë¥¼ ì‚¬ìš©</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>scaler_nn <span class="op">=</span> MinMaxScaler()</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>X_nn <span class="op">=</span> scaler_nn.fit_transform(X).astype(<span class="st">"float32"</span>)  <span class="co"># X: ì›ìë£Œ(0~16)</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) ì˜¤í† ì¸ì½”ë” ëª¨ë¸ ì •ì˜/í•™ìŠµ</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>latent_dim <span class="op">=</span> <span class="dv">10</span>      <span class="co"># ì„ë² ë”© ì°¨ì›(ì›í•˜ë©´ 2, 10, 20 ë“± ë°”ê¿” ì‹¤í—˜ ê°€ëŠ¥)</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>hidden_dim <span class="op">=</span> <span class="dv">32</span>      <span class="co"># ì€ë‹‰ì¸µ í¬ê¸°(ê°„ë‹¨ êµ¬ì¡°)</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>inputs <span class="op">=</span> keras.Input(shape<span class="op">=</span>(X_nn.shape[<span class="dv">1</span>],))</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> layers.Dense(hidden_dim, activation<span class="op">=</span><span class="st">"relu"</span>)(inputs)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> layers.Dense(latent_dim, activation<span class="op">=</span><span class="st">"linear"</span>, name<span class="op">=</span><span class="st">"latent"</span>)(h)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>h2 <span class="op">=</span> layers.Dense(hidden_dim, activation<span class="op">=</span><span class="st">"relu"</span>)(z)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>outputs <span class="op">=</span> layers.Dense(X_nn.shape[<span class="dv">1</span>], activation<span class="op">=</span><span class="st">"sigmoid"</span>)(h2)</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>autoencoder <span class="op">=</span> keras.Model(inputs, outputs, name<span class="op">=</span><span class="st">"autoencoder"</span>)</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>encoder <span class="op">=</span> keras.Model(inputs, z, name<span class="op">=</span><span class="st">"encoder"</span>)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>autoencoder.<span class="bu">compile</span>(optimizer<span class="op">=</span>keras.optimizers.Adam(<span class="fl">1e-3</span>), loss<span class="op">=</span><span class="st">"mse"</span>)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>early <span class="op">=</span> keras.callbacks.EarlyStopping(</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">"val_loss"</span>, patience<span class="op">=</span><span class="dv">5</span>, restore_best_weights<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> autoencoder.fit(</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    X_nn, X_nn,</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">128</span>,</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>    validation_split<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    callbacks<span class="op">=</span>[early],</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">0</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>final_val <span class="op">=</span> <span class="bu">float</span>(np.<span class="bu">min</span>(history.history[<span class="st">"val_loss"</span>]))</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"[AE] latent_dim=</span><span class="sc">{</span>latent_dim<span class="sc">}</span><span class="ss">, best val_loss=</span><span class="sc">{</span>final_val<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="co"># ì„ë² ë”© ì¶”ì¶œ</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>Z_ae <span class="op">=</span> encoder.predict(X_nn, verbose<span class="op">=</span><span class="dv">0</span>)  <span class="co"># (n, latent_dim)</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) ì„ë² ë”© ê³µê°„ì—ì„œ KMeans ìˆ˜í–‰ â†’ Silhouette-best K ì„ íƒ</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>K_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">21</span>))</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>km_records <span class="op">=</span> []</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>K, random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>    z_km <span class="op">=</span> km.fit_predict(Z_ae)</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>    km_records.append({</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: K,</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: silhouette_score(Z_ae, z_km, metric<span class="op">=</span><span class="st">"euclidean"</span>),</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wss"</span>: <span class="bu">float</span>(km.inertia_),  <span class="co"># ì„ë² ë”© ê³µê°„ì—ì„œì˜ WSS</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: adjusted_rand_score(y, z_km),</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: normalized_mutual_info_score(y, z_km),</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>km_df <span class="op">=</span> pd.DataFrame(km_records)</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>km_best <span class="op">=</span> km_df.loc[km_df[<span class="st">"silhouette"</span>].idxmax()]</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>new_row <span class="op">=</span> {</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">"method"</span>: <span class="ss">f"AutoEncoder(</span><span class="sc">{</span>latent_dim<span class="sc">}</span><span class="ss">D, val_loss=</span><span class="sc">{</span>final_val<span class="sc">:.4g}</span><span class="ss">) + KMeans (Sil-best)"</span>,</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">"K"</span>: <span class="bu">int</span>(km_best[<span class="st">"K"</span>]),</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">"silhouette"</span>: <span class="bu">float</span>(km_best[<span class="st">"silhouette"</span>]),</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wss"</span>: <span class="bu">float</span>(km_best[<span class="st">"wss"</span>]),</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ARI"</span>: <span class="bu">float</span>(km_best[<span class="st">"ARI"</span>]),</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NMI"</span>: <span class="bu">float</span>(km_best[<span class="st">"NMI"</span>]),</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">"AIC"</span>: np.nan,</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BIC"</span>: np.nan</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.DataFrame([new_row])</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>display(new_df)</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) comparison_sortedì— í–‰ ì¶”ê°€ + ì¬ì •ë ¬</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>comparison_sorted <span class="op">=</span> (</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>    pd.concat([comparison_sorted, new_df], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>      .sort_values([<span class="st">"ARI"</span>, <span class="st">"silhouette"</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>      .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>display(comparison_sorted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ì˜¤í† ì¸ì½”ë”-ì„ë² ë”©-kmeansdeep-clustering-ê°œë…-ì‹¤í—˜-ê²°ê³¼-í•´ì„" class="level5">
<h5 class="anchored" data-anchor-id="ì˜¤í† ì¸ì½”ë”-ì„ë² ë”©-kmeansdeep-clustering-ê°œë…-ì‹¤í—˜-ê²°ê³¼-í•´ì„">ì˜¤í† ì¸ì½”ë” ì„ë² ë”© + KMeans(â€œdeep clustering ê°œë… ì‹¤í—˜â€) ê²°ê³¼ í•´ì„</h5>
<p>ì´ë²ˆ ì‹¤í—˜ì€ í”½ì…€ ì›ê³µê°„(64ì°¨ì›)ì—ì„œ ë°”ë¡œ êµ°ì§‘ì„ ìˆ˜í–‰í•˜ëŠ” ëŒ€ì‹ , ì˜¤í† ì¸ì½”ë”ê°€ í•™ìŠµí•œ 10ì°¨ì› ì„ë² ë”© ê³µê°„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì˜®ê¸´ ë‹¤ìŒ ê·¸ ì„ë² ë”©ì—ì„œ KMeansë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼ì´ë‹¤. ì¦‰, â€œí‘œí˜„(ì„ë² ë”©)ì„ ë¨¼ì € í•™ìŠµí•œ ë’¤ êµ°ì§‘ì„ í•˜ëŠ”â€ ê°€ì¥ ë‹¨ìˆœí•œ í˜•íƒœì˜ deep clustering ì‹¤í—˜ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.</p>
<p>ì˜¤í† ì¸ì½”ë” í•™ìŠµ ì„±ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” best val_loss=0.024130ì€ 0~1ë¡œ ìŠ¤ì¼€ì¼ëœ ì…ë ¥(X_nn)ì„ ì¬êµ¬ì„±í•˜ëŠ” í‰ê· ì œê³±ì˜¤ì°¨ ê¸°ì¤€ìœ¼ë¡œ, digits ê·œëª¨ì—ì„œëŠ” ì¬êµ¬ì„± í’ˆì§ˆì´ ë¬´ë‚œí•˜ê²Œ í™•ë³´ë˜ì—ˆìŒì„ ì˜ë¯¸í•œë‹¤. ë‹¤ë§Œ ì¬êµ¬ì„± ì†ì‹¤ì´ ë‚®ë‹¤ê³  í•´ì„œ êµ°ì§‘ì— ìµœì ì¸ ì„ë² ë”©ì´ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” ê²ƒì€ ì•„ë‹ˆë©°, êµ°ì§‘ì— í•„ìš”í•œ ê²ƒì€ â€œì¬êµ¬ì„±ì— ì¢‹ì€ í‘œí˜„â€ì´ ì•„ë‹ˆë¼ â€œí´ëŸ¬ìŠ¤í„°ê°€ ì˜ ë¶„ë¦¬ë˜ëŠ” í‘œí˜„â€ì´ë¼ëŠ” ì ì—ì„œ ì´í›„ ì§€í‘œë¥¼ í•¨ê»˜ í•´ì„í•´ì•¼ í•œë‹¤.</p>
<p>ì„ë² ë”© ê³µê°„ì—ì„œ KMeansë¥¼ ì ìš©í•œ ë’¤ silhouetteê°€ ìµœëŒ€ê°€ ë˜ëŠ” Kë¥¼ ì„ íƒí–ˆì„ ë•Œ, ìµœì  KëŠ” 9ë¡œ ë‚˜íƒ€ë‚¬ê³  silhouette=0.2807ì„ ì–»ì—ˆë‹¤. ê°™ì€ í‘œì—ì„œ PCA(10D)+KMeansì˜ silhouette(0.2872)ì™€ ë¹„êµí•˜ë©´ ë‚´ë¶€ì§€í‘œ ìˆ˜ì¤€ì€ ë§¤ìš° ë¹„ìŠ·í•œ í¸ì´ë©°, AE ì„ë² ë”©ì´ ìµœì†Œí•œ â€œê±°ë¦¬ ê¸°ë°˜ ë¶„ë¦¬ êµ¬ì¡°â€ë¥¼ ì–´ëŠ ì •ë„ í˜•ì„±í•˜ê³  ìˆìŒì„ ì‹œì‚¬í•œë‹¤. ë°˜ë©´ PCA(10D)+GMMì˜ silhouette(0.2512)ë³´ë‹¤ëŠ” ë†’ì•„ì„œ, ë‹¨ìˆœ ë‚´ë¶€ ë¶„ë¦¬ë„ ê´€ì ì—ì„œëŠ” AE+KMeans ì¡°í•©ì´ ê²½ìŸë ¥ ìˆëŠ” ìœ„ì¹˜ì— ìˆë‹¤.</p>
<p>ì™¸ë¶€ì§€í‘œ ê¸°ì¤€ìœ¼ë¡œ ë³´ë©´ AE+KMeansëŠ” ARI=0.5977, NMI=0.7012ë¡œ ë‚˜íƒ€ë‚¬ë‹¤. ì´ëŠ” í‘œí˜„ê¸°ë°˜ ë°©ë²• ì¤‘ PCA(10D)+KMeans(ARI=0.5381, NMI=0.6695)ë³´ë‹¤ ë¶„ëª…íˆ ê°œì„ ëœ ê²°ê³¼ì´ë©°, PCA(10D)+GMM(ARI=0.5649, NMI=0.7076)ê³¼ ë¹„êµí•˜ë©´ ARIëŠ” ë” ë†’ê³  NMIëŠ” ê±°ì˜ ë¹„ìŠ·í•œ ìˆ˜ì¤€ì´ë‹¤. ë‹¤ì‹œ ë§í•´, ì„ í˜• ì°¨ì›ì¶•ì†Œ(PCA)ë¡œ ë§Œë“  10ì°¨ì› í‘œí˜„ë³´ë‹¤ ì˜¤í† ì¸ì½”ë”ì˜ ë¹„ì„ í˜• í‘œí˜„ì´ digitsì˜ í˜•íƒœ ë³€ë™ì„ ë” ì˜ ì •ë¦¬í•´ ì£¼ì—ˆê³ , ê·¸ ê²°ê³¼ ì •ë‹µ ë¼ë²¨ê³¼ì˜ ì •í•©ì„±(íŠ¹íˆ ARI)ì´ ìƒìŠ¹í•œ ê²ƒìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤.</p>
<p>ë˜ í•˜ë‚˜ì˜ ê´€ì°° í¬ì¸íŠ¸ëŠ” ì„ íƒëœ Kê°€ 9ë¡œ ë‚˜ì™”ë‹¤ëŠ” ì ì´ë‹¤. digitsì˜ ì‹¤ì œ í´ë˜ìŠ¤ëŠ” 10ê°œì´ë¯€ë¡œ, silhouette ê¸°ì¤€ ìµœì  Kê°€ 9ë¼ëŠ” ê²ƒì€ ë‘ ê°œ ìˆ«ì í´ë˜ìŠ¤ê°€ ì„ë² ë”© ê³µê°„ì—ì„œ ì¶©ë¶„íˆ ë¶„ë¦¬ë˜ì§€ ëª»í•˜ê³  í•˜ë‚˜ì˜ êµ°ì§‘ìœ¼ë¡œ í•©ì³ì¡Œê±°ë‚˜, í˜¹ì€ í•˜ë‚˜ì˜ ìˆ«ì í´ë˜ìŠ¤ ë‚´ë¶€ ë³€í˜•ì´ ì»¤ì„œ ë‹¤ë¥¸ ìˆ«ìì™€ ë¹„ìŠ·í•œ í˜•íƒœë¡œ ì„ì˜€ì„ ê°€ëŠ¥ì„±ì„ ì‹œì‚¬í•œë‹¤. ì´ëŸ° í˜„ìƒì€ íŠ¹íˆ í•„ê¸°ì²´ ë³€í˜•ì´ í° ìˆ«ì(ì˜ˆ: 1ê³¼ 7, 3ê³¼ 8, 4ì™€ 9 ë“±)ì—ì„œ í”íˆ ë‚˜íƒ€ë‚˜ë©°, ìµœì¢…ì ìœ¼ë¡œëŠ” clusterÃ—digit êµì°¨í‘œì—ì„œ ì–´ëŠ ìˆ«ìê°€ í•©ì³ì¡ŒëŠ”ì§€ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ í•´ì„ì˜ í•µì‹¬ì´ë‹¤.</p>
<p>ì „ì²´ ë¹„êµí‘œì˜ ìƒë‹¨ì„ ë³´ë©´, ì „í†µì  ë°©ë²• ì¤‘ Hierarchical(Ward)ê°€ ARI=0.6881, NMI=0.7950ìœ¼ë¡œ ì—¬ì „íˆ ê°€ì¥ ë†’ë‹¤. ë”°ë¼ì„œ ì´ë²ˆ AE+KMeansëŠ” â€œí‘œí˜„í•™ìŠµì„ ë„ì…í–ˆìŒì—ë„ ìµœê³  ì„±ëŠ¥ì„ ì¦‰ì‹œ ê°±ì‹ í•œ ê²ƒì€ ì•„ë‹ˆì§€ë§Œâ€, í‘œí˜„ê¸°ë°˜ êµ°ì§‘(PCAë¥˜) ëŒ€ë¹„ ì„±ëŠ¥ì„ ìœ ì˜ë¯¸í•˜ê²Œ ëŒì–´ì˜¬ë ¸ê³ , deep clusteringìœ¼ë¡œ í™•ì¥í•  ë•Œ ì¶œë°œì ìœ¼ë¡œ ì¶©ë¶„íˆ ì„¤ë“ë ¥ ìˆëŠ” ê²°ê³¼ë¼ê³  ì •ë¦¬í•  ìˆ˜ ìˆë‹¤. íŠ¹íˆ AE ì„ë² ë”©ì€ ì¬êµ¬ì„± ì¤‘ì‹¬ìœ¼ë¡œ í•™ìŠµë˜ì—ˆê¸° ë•Œë¬¸ì— êµ°ì§‘ ëª©ì ì´ ì§ì ‘ ë°˜ì˜ë˜ì§€ ì•Šì•˜ëŠ”ë°ë„ ARIê°€ 0.60 ìˆ˜ì¤€ê¹Œì§€ ì˜¬ë¼ì™”ë‹¤ëŠ” ì ì€, ì´í›„ DECë¥˜ì²˜ëŸ¼ ì„ë² ë”© í•™ìŠµê³¼ êµ°ì§‘ ëª©ì ì„ ë™ì‹œì— ìµœì í™”í•˜ë©´ ì¶”ê°€ ê°œì„  ì—¬ì§€ê°€ ìˆìŒì„ ë’·ë°›ì¹¨í•œë‹¤.</p>
<p>ìš”ì•½í•˜ë©´, ì˜¤í† ì¸ì½”ë” ì„ë² ë”© + KMeansëŠ” â€œì„ í˜• PCA í‘œí˜„ë³´ë‹¤ ì •ë‹µ êµ¬ì¡°ì™€ ë” ì˜ ë§ëŠ” ë¹„ì„ í˜• í‘œí˜„ì„ ì œê³µâ€í–ˆê³ , ê·¸ ê²°ê³¼ ì™¸ë¶€ì§€í‘œ(ARI/NMI)ê°€ ê°œì„ ë˜ì—ˆë‹¤. ë‹¤ë§Œ Kê°€ 9ë¡œ ì„ íƒëœ ì ì€ ì¼ë¶€ ìˆ«ìê°€ êµ°ì§‘ ë‹¨ìœ„ì—ì„œ ë³‘í•©ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì„ ë³´ì—¬ì£¼ë¯€ë¡œ, ëŒ€í‘œìˆ«ì(ë‹¤ìˆ˜ê²°)ì™€ overall purity, ê·¸ë¦¬ê³  ëŒ€í‘œ ì´ë¯¸ì§€(centroid ê·¼ì ‘ í‘œë³¸)ë¥¼ í•¨ê»˜ ë³´ë©´ ì–´ë–¤ ìˆ«ììŒì´ ì„ì˜€ëŠ”ì§€ê¹Œì§€ ìì—°ìŠ¤ëŸ½ê²Œ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤.</p>
<pre class="text"><code>[AE] latent_dim=10, best val_loss=0.024130
method  K   silhouette  wss ARI NMI AIC BIC
0   AutoEncoder(10D, val_loss=0.02413) + KMeans (S...   9   0.280719    21491.103516    0.597681    0.70121 NaN NaN
method  K   silhouette  wss ARI NMI AIC BIC
0   Hierarchical(Ward) (Sil-best)   20  0.152754    54003.237083    0.688082    0.794962    NaN NaN
1   AutoEncoder(10D, val_loss=0.02413) + KMeans (S...   9   0.280719    21491.103516    0.597681    0.701210    NaN NaN
2   KMeans (Sil-best)   15  0.158307    59534.498937    0.568326    0.688241    NaN NaN
3   PCA(10D, EV=0.589) + GMM(BIC-best, full)    13  0.251226    25275.837661    0.564898    0.707620    50025.756510    54734.006431
4   PCA(20D, EV=0.793) + KMeans (Sil-best)  15  0.222177    37368.974559    0.551132    0.681702    NaN NaN
5   PCA(20D, EV=0.793) + GMM(BIC-best, full)    11  0.193245    47099.997586    0.545944    0.697619    61251.650935    75206.090607
6   PCA(10D, EV=0.589) + KMeans (Sil-best)  12  0.287190    23293.872256    0.538087    0.669544    NaN NaN
7   GMM(BIC-best, diag) 20  0.093540    62457.729652    0.437694    0.596951    -232769.805429  -218601.104675
8   PCA(2D, EV=0.216) + KMeans (Sil-best)   8   0.392024    3563.424744 0.331101    0.472753    NaN NaN
9   PCA(2D, EV=0.216) + GMM(BIC-best, full) 4   0.370952    8414.589706 0.199783    0.436065    16308.982097    16435.341197
10  Hierarchical(Complete) (Sil-best)   2   0.784424    106721.094913   0.000002    0.001556    NaN NaN</code></pre>
</section>
</section>
<section id="deep-clustering-dec-ê°œë…-ì‹¤í—˜-ae-ì„ë² ë”©-klêµ°ì§‘-ë™ì‹œ-ìµœì í™”" class="level4">
<h4 class="anchored" data-anchor-id="deep-clustering-dec-ê°œë…-ì‹¤í—˜-ae-ì„ë² ë”©-klêµ°ì§‘-ë™ì‹œ-ìµœì í™”">6. Deep clustering (DEC ê°œë… ì‹¤í—˜): AE ì„ë² ë”© + KL(êµ°ì§‘) ë™ì‹œ ìµœì í™”</h4>
<section id="í˜„ì¬ê¹Œì§€ì˜-ì˜¤í† ì¸ì½”ë”-ì„ë² ë”©-kmeansëŠ”-ë¬´ì—‡ì¸ê°€" class="level5">
<h5 class="anchored" data-anchor-id="í˜„ì¬ê¹Œì§€ì˜-ì˜¤í† ì¸ì½”ë”-ì„ë² ë”©-kmeansëŠ”-ë¬´ì—‡ì¸ê°€">í˜„ì¬ê¹Œì§€ì˜ ì˜¤í† ì¸ì½”ë” ì„ë² ë”© + KMeansëŠ” ë¬´ì—‡ì¸ê°€</h5>
<p>í˜„ì¬ êµ¬í˜„ì€ ë‘ ë‹¨ê³„ë¡œ ë¶„ë¦¬ëœ ì ˆì°¨ì´ë‹¤.</p>
<ul>
<li>ì˜¤í† ì¸ì½”ë”ë¥¼ ì¬êµ¬ì„± ì†ì‹¤(MSE)ë¡œ í•™ìŠµí•´ ì ì¬í‘œí˜„ Zë¥¼ ë§Œë“ ë‹¤.</li>
<li>ê³ ì •ëœ Z ìœ„ì—ì„œ KMeansë¥¼ ìˆ˜í–‰í•´ êµ°ì§‘ ë¼ë²¨ì„ ì–»ëŠ”ë‹¤.</li>
</ul>
<p>ì´ ë°©ì‹ì˜ í•µì‹¬ì€ ì„ë² ë”© Zê°€ êµ°ì§‘ì„ ìœ„í•´ í•™ìŠµëœ ê²ƒì´ ì•„ë‹ˆë¼, ì…ë ¥ì„ ì˜ ë³µì›í•˜ë„ë¡ í•™ìŠµëœ ê²°ê³¼ë¼ëŠ” ì ì´ë‹¤. ë”°ë¼ì„œ Z ê³µê°„ì´ êµ°ì§‘ì— ìœ ë¦¬í•˜ë„ë¡ í˜•ì„±ëœë‹¤ëŠ” ë³´ì¥ì€ ì—†ë‹¤.</p>
</section>
<section id="decë¥˜-ì•„ì´ë””ì–´ëŠ”-ë¬´ì—‡ì„-ì¶”ê°€í•˜ëŠ”ê°€" class="level5">
<h5 class="anchored" data-anchor-id="decë¥˜-ì•„ì´ë””ì–´ëŠ”-ë¬´ì—‡ì„-ì¶”ê°€í•˜ëŠ”ê°€">DECë¥˜ ì•„ì´ë””ì–´ëŠ” ë¬´ì—‡ì„ ì¶”ê°€í•˜ëŠ”ê°€</h5>
<p>DEC(Deep Embedded Clustering)ëŠ” â€œì„ë² ë”© í•™ìŠµ + êµ°ì§‘ ëª©ì â€ì„ ë™ì‹œì— ìµœì í™”í•˜ëŠ” ë°©ì‹ì´ë‹¤. ì ˆì°¨ëŠ” ë³´í†µ ë‹¤ìŒ êµ¬ì¡°ë¥¼ ê°€ì§„ë‹¤.</p>
<ul>
<li>ì˜¤í† ì¸ì½”ë”ë¥¼ ë¨¼ì € ì‚¬ì „í•™ìŠµ(pretrain)í•´ì„œ ì´ˆê¸° ì„ë² ë”© Z0ë¥¼ ì–»ëŠ”ë‹¤.</li>
<li>Z0ì—ì„œ KMeansë¡œ ì´ˆê¸° êµ°ì§‘ ì¤‘ì‹¬ Î¼_kë¥¼ ë§Œë“ ë‹¤.</li>
<li>ì„ë² ë”© z_iì™€ êµ°ì§‘ ì¤‘ì‹¬ Î¼_k ì‚¬ì´ ê±°ë¦¬ë¡œë¶€í„° soft assignment q_ikë¥¼ ì •ì˜í•œë‹¤.</li>
<li>q_ikë¥¼ sharpení•œ target distribution p_ikë¥¼ ë§Œë“ ë‹¤.</li>
<li>KL(P||Q)ë¥¼ ìµœì†Œí™”í•˜ë„ë¡ encoder(ì„ë² ë”©)ì™€ êµ°ì§‘ ì¤‘ì‹¬ì„ í•¨ê»˜ ì—…ë°ì´íŠ¸í•œë‹¤.</li>
<li>í•„ìš”í•˜ë©´ ì¬êµ¬ì„± ì†ì‹¤(MSE)ì„ ì„ì–´ì„œ ì„ë² ë”©ì´ ë¶•ê´´í•˜ëŠ” ê²ƒì„ ë°©ì§€í•œë‹¤.</li>
</ul>
<p>ê²°ê³¼ì ìœ¼ë¡œ ì„ë² ë”© ê³µê°„ ìì²´ê°€ êµ°ì§‘ êµ¬ì¡°ë¥¼ ë” ì˜ ë“œëŸ¬ë‚´ë„ë¡ í•™ìŠµ ê³¼ì •ì—ì„œ ì¡°ì •ëœë‹¤.</p>
</section>
<section id="ë…¸íŠ¸ë¶ì˜-dec-like-ì…€ì€-ìœ„-ê°œë…ê³¼-ì–´ë–»ê²Œ-ì—°ê²°ë˜ëŠ”ê°€" class="level5">
<h5 class="anchored" data-anchor-id="ë…¸íŠ¸ë¶ì˜-dec-like-ì…€ì€-ìœ„-ê°œë…ê³¼-ì–´ë–»ê²Œ-ì—°ê²°ë˜ëŠ”ê°€">ë…¸íŠ¸ë¶ì˜ DEC-like ì…€ì€ ìœ„ ê°œë…ê³¼ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ê°€</h5>
<p>ë…¸íŠ¸ë¶ì˜ DEC-like ì…€ì€ ë‹¤ìŒ ìš”ì†Œë“¤ì„ í¬í•¨í•˜ê³  ìˆì–´ DEC í™•ì¥ê³¼ ì§ì ‘ ì—°ê²°ëœë‹¤.</p>
<ul>
<li>AE ì‚¬ì „í•™ìŠµ(pretrain): MSEë¡œ ë¨¼ì € ì„ë² ë”©ì„ ì•ˆì •í™”í•œë‹¤.</li>
<li>ì„ë² ë”©ì—ì„œ K ì„ íƒ: Z0ì—ì„œ Kë¥¼ ì„ íƒí•˜ê³  KMeansë¡œ ì´ˆê¸° ì¤‘ì‹¬ì„ ì„¤ì •í•œë‹¤.</li>
<li>ClusteringLayer: Student-t ê¸°ë°˜ìœ¼ë¡œ q_ik(soft assignment)ì„ ê³„ì‚°í•œë‹¤.</li>
<li>target_distribution: q_ikë¥¼ ì œê³±í•˜ê³  êµ°ì§‘ ë¹ˆë„ë¡œ ì •ê·œí™”í•´ p_ikë¥¼ ë§Œë“ ë‹¤.</li>
<li>í•™ìŠµ ëª©ì í•¨ìˆ˜: KL(P||Q) + gamma*MSE í˜•íƒœë¡œ êµ°ì§‘ ì†ì‹¤ê³¼ ì¬êµ¬ì„± ì†ì‹¤ì„ í•¨ê»˜ ìµœì†Œí™”í•œë‹¤.</li>
<li>ë°˜ë³µ ì—…ë°ì´íŠ¸: ì¼ì • ì£¼ê¸°ë§ˆë‹¤ pë¥¼ ê°±ì‹ í•˜ê³  ë¼ë²¨ ë³€í™”ìœ¨ì´ ì‘ì•„ì§€ë©´ ì¡°ê¸° ì¢…ë£Œí•œë‹¤.</li>
</ul>
<p>ë”°ë¼ì„œ ì´ ì…€ì€ â€œì„ë² ë”©ì„ ë§Œë“  ë’¤ êµ°ì§‘â€ì—ì„œ â€œì„ë² ë”© í•™ìŠµê³¼ êµ°ì§‘ ëª©ì  ë™ì‹œ ìµœì í™”â€ë¡œ ë„˜ì–´ê°€ëŠ”, ê°€ì¥ ì „í˜•ì ì¸ DEC ë°©í–¥ì˜ í™•ì¥ ì‹¤í—˜ì´ë¼ê³  í•´ì„í•  ìˆ˜ ìˆë‹¤.</p>
<p>ì˜¤í† ì¸ì½”ë” ì„ë² ë”© + KMeansëŠ” ì‚¬í›„ êµ°ì§‘ ë°©ì‹ì´ê³ , DECë¥˜ëŠ” ì„ë² ë”© í•™ìŠµ ìì²´ì— êµ°ì§‘ ëª©ì (KL divergence)ì„ ë„£ì–´ ì„ë² ë”©ê³¼ êµ°ì§‘ì„ í•¨ê»˜ ìµœì í™”í•˜ëŠ” í™•ì¥ì´ë‹¤. ë”°ë¼ì„œ ì§ˆë¬¸ì˜ ë¬¸ì¥(ì§„ì§œ deep clustering í˜•íƒœ, ì„ë² ë”© í•™ìŠµ + êµ°ì§‘ ëª©ì  ë™ì‹œ ìµœì í™”)ì€ í˜„ì¬ ë…¸íŠ¸ë¶ íë¦„ê³¼ ì§ì ‘ì ìœ¼ë¡œ ì´ì–´ì§€ëŠ” ë‹¤ìŒ ë‹¨ê³„ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Deep clustering (DEC ê°œë… ì‹¤í—˜): AE ì„ë² ë”© + KL(êµ°ì§‘) ë™ì‹œ ìµœì í™”</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  - AE ì‚¬ì „í•™ìŠµ(pretrain) í›„</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  - ì„ë² ë”©ì—ì„œ Kë¥¼ Silhouette-bestë¡œ ì„ íƒ</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  - DEC(soft assignment q, target p)ë¡œ KL(P||Q) + gamma*MSE ì¬êµ¬ì„± ì†ì‹¤ ìµœì í™”</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  - ìµœì¢… ê²°ê³¼ë¥¼ comparison_sortedì— í–‰(row) ì¶”ê°€</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score, adjusted_rand_score, normalized_mutual_info_score</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ì¬í˜„ì„±</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>RANDOM_STATE <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_STATE)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(RANDOM_STATE)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ì•ˆì „ì¥ì¹˜: ë¹„êµí‘œ ì—†ìœ¼ë©´ ìƒì„±</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"comparison_sorted"</span> <span class="kw">not</span> <span class="kw">in</span> <span class="bu">globals</span>():</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    comparison_sorted <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"method"</span>,<span class="st">"K"</span>,<span class="st">"silhouette"</span>,<span class="st">"wss"</span>,<span class="st">"ARI"</span>,<span class="st">"NMI"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>])</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_wss(X, labels):</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> np.unique(labels):</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        Xk <span class="op">=</span> X[labels <span class="op">==</span> k]</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> Xk.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        wss <span class="op">+=</span> ((Xk <span class="op">-</span> mu) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(wss)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) ë°ì´í„° ì¤€ë¹„ (NNìš© 0~1 ìŠ¤ì¼€ì¼)</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>scaler_nn <span class="op">=</span> MinMaxScaler()</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>X_nn <span class="op">=</span> scaler_nn.fit_transform(X).astype(<span class="st">"float32"</span>)</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> X_nn.shape</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"X_nn shape:"</span>, X_nn.shape)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) AutoEncoder ì‚¬ì „í•™ìŠµ(Pretrain)</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>latent_dim <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>hidden_dim <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>inp <span class="op">=</span> keras.Input(shape<span class="op">=</span>(p,))</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>h1 <span class="op">=</span> layers.Dense(hidden_dim, activation<span class="op">=</span><span class="st">"relu"</span>)(inp)</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>z  <span class="op">=</span> layers.Dense(latent_dim, activation<span class="op">=</span><span class="st">"linear"</span>, name<span class="op">=</span><span class="st">"latent"</span>)(h1)</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>h2 <span class="op">=</span> layers.Dense(hidden_dim, activation<span class="op">=</span><span class="st">"relu"</span>)(z)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> layers.Dense(p, activation<span class="op">=</span><span class="st">"sigmoid"</span>)(h2)</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>autoencoder <span class="op">=</span> keras.Model(inp, out, name<span class="op">=</span><span class="st">"AE"</span>)</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>encoder <span class="op">=</span> keras.Model(inp, z, name<span class="op">=</span><span class="st">"Encoder"</span>)</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="co"># decoderëŠ” encoder ì¶œë ¥ì„ ë°›ì•„ ë³µì›í•˜ëŠ” ëª¨ë¸ë¡œ ë”°ë¡œ ë§Œë“ ë‹¤</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>z_in <span class="op">=</span> keras.Input(shape<span class="op">=</span>(latent_dim,))</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>dh <span class="op">=</span> layers.Dense(hidden_dim, activation<span class="op">=</span><span class="st">"relu"</span>)(z_in)</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>dout <span class="op">=</span> layers.Dense(p, activation<span class="op">=</span><span class="st">"sigmoid"</span>)(dh)</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>decoder <span class="op">=</span> keras.Model(z_in, dout, name<span class="op">=</span><span class="st">"Decoder"</span>)</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>autoencoder.<span class="bu">compile</span>(optimizer<span class="op">=</span>keras.optimizers.Adam(<span class="fl">1e-3</span>), loss<span class="op">=</span><span class="st">"mse"</span>)</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>early <span class="op">=</span> keras.callbacks.EarlyStopping(monitor<span class="op">=</span><span class="st">"val_loss"</span>, patience<span class="op">=</span><span class="dv">5</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>hist <span class="op">=</span> autoencoder.fit(</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>    X_nn, X_nn,</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">50</span>, batch_size<span class="op">=</span><span class="dv">128</span>,</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>    validation_split<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>    callbacks<span class="op">=</span>[early],</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">0</span></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>best_val <span class="op">=</span> <span class="bu">float</span>(np.<span class="bu">min</span>(hist.history[<span class="st">"val_loss"</span>]))</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"[Pretrain AE] latent_dim=</span><span class="sc">{</span>latent_dim<span class="sc">}</span><span class="ss">, best val_loss=</span><span class="sc">{</span>best_val<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>Z0 <span class="op">=</span> encoder.predict(X_nn, verbose<span class="op">=</span><span class="dv">0</span>)  <span class="co"># (n, latent_dim)</span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) K ì„ íƒ: ì„ë² ë”© Z0ì—ì„œ Silhouette-best</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>K_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">21</span>))</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>sil_list <span class="op">=</span> []</span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K <span class="kw">in</span> K_list:</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>    km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>K, random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> km.fit_predict(Z0)</span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>    sil <span class="op">=</span> silhouette_score(Z0, labels, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>    sil_list.append(sil)</span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>K_best <span class="op">=</span> <span class="bu">int</span>(K_list[<span class="bu">int</span>(np.argmax(sil_list))])</span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"[K selection on embedding] K_best=</span><span class="sc">{</span>K_best<span class="sc">}</span><span class="ss">, best silhouette=</span><span class="sc">{</span><span class="bu">max</span>(sil_list)<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a><span class="co"># ì´ˆê¸° êµ°ì§‘ ì¤‘ì‹¬ (kmeans)</span></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>km_init <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>K_best, random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>init_labels <span class="op">=</span> km_init.fit_predict(Z0)</span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>init_centers <span class="op">=</span> km_init.cluster_centers_.astype(<span class="st">"float32"</span>)</span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) DEC í•µì‹¬: soft assignment q, target p, KL(P||Q) ìµœì†Œí™”</span></span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a><span class="co">#    + (ì˜µì…˜) ì¬êµ¬ì„± ì†ì‹¤ì„ ì„ì–´ ë¶•ê´´(collapse) ë°©ì§€</span></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ClusteringLayer(layers.Layer):</span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a><span class="co">    Student-t ê¸°ë°˜ soft assignment layer.</span></span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a><span class="co">    q_ik âˆ (1 + ||z_i - Î¼_k||^2 / Î±)^(-(Î±+1)/2)</span></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, n_clusters, init_centers, alpha<span class="op">=</span><span class="fl">1.0</span>, <span class="op">**</span>kwargs):</span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_clusters <span class="op">=</span> n_clusters</span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alpha <span class="op">=</span> alpha</span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.init_centers <span class="op">=</span> init_centers</span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build(<span class="va">self</span>, input_shape):</span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.clusters <span class="op">=</span> <span class="va">self</span>.add_weight(</span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a>            shape<span class="op">=</span>(<span class="va">self</span>.n_clusters, <span class="bu">int</span>(input_shape[<span class="op">-</span><span class="dv">1</span>])),</span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a>            initializer<span class="op">=</span>keras.initializers.Constant(<span class="va">self</span>.init_centers),</span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a>            trainable<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="st">"cluster_centers"</span></span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> call(<span class="va">self</span>, inputs):</span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a>        <span class="co"># inputs: (n, latent_dim)</span></span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dist: (n, K)</span></span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> tf.reduce_sum(tf.square(tf.expand_dims(inputs, axis<span class="op">=</span><span class="dv">1</span>) <span class="op">-</span> <span class="va">self</span>.clusters), axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> (<span class="fl">1.0</span> <span class="op">+</span> dist <span class="op">/</span> <span class="va">self</span>.alpha)</span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> tf.<span class="bu">pow</span>(q, (<span class="va">self</span>.alpha <span class="op">+</span> <span class="fl">1.0</span>) <span class="op">/</span> <span class="fl">2.0</span>)</span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> q <span class="op">/</span> tf.reduce_sum(q, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> q</span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> target_distribution(q):</span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># p_ik = (q_ik^2 / f_k) / sum_j (q_ij^2 / f_j)</span></span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a>    weight <span class="op">=</span> q<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> tf.reduce_sum(q, axis<span class="op">=</span><span class="dv">0</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> weight <span class="op">/</span> tf.reduce_sum(weight, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p</span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a><span class="co"># DEC ëª¨ë¸(encoder + clustering + decoder)</span></span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a>clust_layer <span class="op">=</span> ClusteringLayer(K_best, init_centers, alpha<span class="op">=</span><span class="fl">1.0</span>, name<span class="op">=</span><span class="st">"clustering"</span>)(encoder(inp))</span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>recon <span class="op">=</span> decoder(encoder(inp))</span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a>dec_model <span class="op">=</span> keras.Model(inp, [clust_layer, recon], name<span class="op">=</span><span class="st">"DEC_like"</span>)</span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a><span class="co"># í•™ìŠµ ì„¤ì •</span></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">1.0</span>   <span class="co"># ì¬êµ¬ì„± ì†ì‹¤ ê°€ì¤‘ì¹˜(0ì´ë©´ ìˆœìˆ˜ DEC, 0.5~2 ì •ë„ë¡œ ì‹¤í—˜ ê°€ëŠ¥)</span></span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> keras.optimizers.Adam(<span class="fl">1e-3</span>)</span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a><span class="co"># KL loss (P||Q)</span></span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a>kld <span class="op">=</span> keras.losses.KLDivergence()</span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> keras.losses.MeanSquaredError()</span>
<span id="cb19-157"><a href="#cb19-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a><span class="co"># í•™ìŠµ ë£¨í”„</span></span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a>update_interval <span class="op">=</span> <span class="dv">1</span>   <span class="co"># ë§¤ epochë§ˆë‹¤ target p ì—…ë°ì´íŠ¸</span></span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a>tol <span class="op">=</span> <span class="fl">1e-3</span>            <span class="co"># ë¼ë²¨ ë³€í™”ìœ¨ì´ tol ë¯¸ë§Œì´ë©´ ì¡°ê¸° ì¢…ë£Œ</span></span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a><span class="co"># ì´ˆê¸° q, p</span></span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a>q0, xhat0 <span class="op">=</span> dec_model.predict(X_nn, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-165"><a href="#cb19-165" aria-hidden="true" tabindex="-1"></a>p0 <span class="op">=</span> target_distribution(tf.constant(q0)).numpy()</span>
<span id="cb19-166"><a href="#cb19-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a>prev_labels <span class="op">=</span> q0.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"[DEC] start training..."</span>)</span>
<span id="cb19-169"><a href="#cb19-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-170"><a href="#cb19-170" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, epochs <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb19-171"><a href="#cb19-171" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (1) p ì—…ë°ì´íŠ¸</span></span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">%</span> update_interval <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a>        q, _ <span class="op">=</span> dec_model.predict(X_nn, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> target_distribution(tf.constant(q)).numpy()</span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a>        curr_labels <span class="op">=</span> q.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-177"><a href="#cb19-177" aria-hidden="true" tabindex="-1"></a>        delta <span class="op">=</span> np.mean(curr_labels <span class="op">!=</span> prev_labels)</span>
<span id="cb19-178"><a href="#cb19-178" aria-hidden="true" tabindex="-1"></a>        prev_labels <span class="op">=</span> curr_labels</span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> epoch <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  epoch=</span><span class="sc">{</span>epoch<span class="sc">:02d}</span><span class="ss">, label_change=</span><span class="sc">{</span>delta<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> delta <span class="op">&lt;</span> tol <span class="kw">and</span> epoch <span class="op">&gt;</span> <span class="dv">5</span>:</span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  early stop at epoch=</span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">, label_change=</span><span class="sc">{</span>delta<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (2) í•œ ë²ˆì˜ full-batch gradient step</span></span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> tf.GradientTape() <span class="im">as</span> tape:</span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a>        q_pred, x_hat <span class="op">=</span> dec_model(X_nn, training<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a>        loss_kl <span class="op">=</span> kld(p, q_pred)</span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a>        loss_rec <span class="op">=</span> mse(X_nn, x_hat)</span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> loss_kl <span class="op">+</span> gamma <span class="op">*</span> loss_rec</span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a>    grads <span class="op">=</span> tape.gradient(loss, dec_model.trainable_weights)</span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a>    optimizer.apply_gradients(<span class="bu">zip</span>(grads, dec_model.trainable_weights))</span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"[DEC] training done."</span>)</span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) ìµœì¢… ê²°ê³¼ í‰ê°€ + comparison_sortedì— ì¶”ê°€</span></span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a>q_final, xhat_final <span class="op">=</span> dec_model.predict(X_nn, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a>z_final <span class="op">=</span> encoder.predict(X_nn, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-204"><a href="#cb19-204" aria-hidden="true" tabindex="-1"></a>labels_final <span class="op">=</span> q_final.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-205"><a href="#cb19-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a>sil_dec <span class="op">=</span> silhouette_score(z_final, labels_final, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a>wss_dec <span class="op">=</span> compute_wss(z_final, labels_final)</span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a>ari_dec <span class="op">=</span> adjusted_rand_score(y, labels_final)</span>
<span id="cb19-209"><a href="#cb19-209" aria-hidden="true" tabindex="-1"></a>nmi_dec <span class="op">=</span> normalized_mutual_info_score(y, labels_final)</span>
<span id="cb19-210"><a href="#cb19-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a>new_row <span class="op">=</span> {</span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"method"</span>: <span class="ss">f"DEC-like(AE</span><span class="sc">{</span>latent_dim<span class="sc">}</span><span class="ss">D, K=</span><span class="sc">{</span>K_best<span class="sc">}</span><span class="ss">, gamma=</span><span class="sc">{</span>gamma<span class="sc">}</span><span class="ss">, val=</span><span class="sc">{</span>best_val<span class="sc">:.4g}</span><span class="ss">)"</span>,</span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"K"</span>: <span class="bu">int</span>(K_best),</span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a>    <span class="st">"silhouette"</span>: <span class="bu">float</span>(sil_dec),</span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wss"</span>: <span class="bu">float</span>(wss_dec),</span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ARI"</span>: <span class="bu">float</span>(ari_dec),</span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NMI"</span>: <span class="bu">float</span>(nmi_dec),</span>
<span id="cb19-218"><a href="#cb19-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">"AIC"</span>: np.nan,</span>
<span id="cb19-219"><a href="#cb19-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BIC"</span>: np.nan</span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.DataFrame([new_row])</span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a>display(new_df)</span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a>comparison_sorted <span class="op">=</span> (</span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a>    pd.concat([comparison_sorted, new_df], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a>      .sort_values([<span class="st">"ARI"</span>, <span class="st">"silhouette"</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-227"><a href="#cb19-227" aria-hidden="true" tabindex="-1"></a>      .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-228"><a href="#cb19-228" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a>display(comparison_sorted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="deep-clustering-dec-ê°œë…-ì‹¤í—˜-ae-ì„ë² ë”©-klêµ°ì§‘-ë™ì‹œ-ìµœì í™”-ê²°ê³¼-í•´ì„" class="level5">
<h5 class="anchored" data-anchor-id="deep-clustering-dec-ê°œë…-ì‹¤í—˜-ae-ì„ë² ë”©-klêµ°ì§‘-ë™ì‹œ-ìµœì í™”-ê²°ê³¼-í•´ì„">Deep clustering (DEC ê°œë… ì‹¤í—˜): AE ì„ë² ë”© + KL(êµ°ì§‘) ë™ì‹œ ìµœì í™” ê²°ê³¼ í•´ì„</h5>
<p>ì´ë²ˆ ê²°ê³¼ëŠ” ì˜¤í† ì¸ì½”ë”(AE)ê°€ ë§Œë“  ì„ë² ë”©ì„ ê³ ì •í•œ ë’¤ KMeansë¥¼ ìˆ˜í–‰í•˜ëŠ” ë‹¨ê³„ì—ì„œ í•œ ê±¸ìŒ ë” ë‚˜ì•„ê°€, ì„ë² ë”© í‘œí˜„ ìì²´ë¥¼ êµ°ì§‘ ëª©ì ì— ë§ê²Œ í•¨ê»˜ ì¡°ì •í•œ DEC ê³„ì—´ì˜ ê°œë… ì‹¤í—˜ì´ë‹¤. ì ˆì°¨ëŠ” (1) AEë¥¼ ì¬êµ¬ì„± ì†ì‹¤ë¡œ ì‚¬ì „í•™ìŠµí•´ ì´ˆê¸° ì„ë² ë”©ì„ ë§Œë“¤ê³ , (2) ê·¸ ì„ë² ë”©ì—ì„œ silhouette ê¸°ì¤€ìœ¼ë¡œ Kë¥¼ ì„ íƒí•œ ë‹¤ìŒ, (3) Student-t ê¸°ë°˜ soft assignment qì™€ target distribution pë¥¼ ì •ì˜í•˜ì—¬ KL(Pâ€–Q)ì„ ì¤„ì´ë„ë¡ ì„ë² ë”©ê³¼ êµ°ì§‘ ì¤‘ì‹¬ì„ ë™ì‹œì— ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬ì„±ëœë‹¤. ë‹¤ë§Œ ë¶•ê´´(collapse)ë¥¼ ë°©ì§€í•˜ê³  ì…ë ¥ ì •ë³´ë¥¼ ì¼ì • ë¶€ë¶„ ìœ ì§€í•˜ê¸° ìœ„í•´, ì´ë²ˆ êµ¬í˜„ì€ ìˆœìˆ˜ KLë§Œì´ ì•„ë‹ˆë¼ ì¬êµ¬ì„± ì†ì‹¤(MSE)ì„ gamma=1.0 ê°€ì¤‘ì¹˜ë¡œ í•¨ê»˜ ìµœì í™”í•˜ëŠ” í˜•íƒœë¡œ ë˜ì–´ ìˆë‹¤.</p>
<p>ì‚¬ì „í•™ìŠµ ë‹¨ê³„ì—ì„œ best val_loss=0.018878ì€ 0~1 ìŠ¤ì¼€ì¼ë¡œ ë³€í™˜ëœ ì…ë ¥ì„ AEê°€ ë¹„êµì  ì˜ ë³µì›í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ì˜ ì¬êµ¬ì„± í’ˆì§ˆì„ í™•ë³´í–ˆìŒì„ ì˜ë¯¸í•œë‹¤. ì´ì–´ì„œ ì‚¬ì „í•™ìŠµ ì„ë² ë”©ì—ì„œ silhouette-bestë¡œ ì„ íƒëœ KëŠ” 9ì´ë©°(best silhouette=0.2455), digitsì˜ ì‹¤ì œ í´ë˜ìŠ¤ ìˆ˜(10ê°œ)ì™€ ë¹„êµí•˜ë©´ í•œ ê°œ ìˆ«ì í´ë˜ìŠ¤ê°€ ë‹¤ë¥¸ í´ë˜ìŠ¤ì™€ ê°€ê¹Œìš´ í˜•íƒœ ë³€í˜•ìœ¼ë¡œ ì¸í•´ í•¨ê»˜ ë¬¶ì˜€ê±°ë‚˜, ì¼ë¶€ í´ë˜ìŠ¤ ë‚´ë¶€ ë³€í˜•ì´ í° ê²½ìš° êµ°ì§‘ì´ ì™„ì „íˆ ë¶„ë¦¬ë˜ì§€ ëª»í–ˆì„ ê°€ëŠ¥ì„±ì„ ì‹œì‚¬í•œë‹¤. ì´ ë¶€ë¶„ì€ ìµœì¢…ì ìœ¼ë¡œ clusterÃ—digit êµì°¨í‘œì—ì„œ ì–´ë–¤ ìˆ«ì ìŒì´ í•©ì³ì¡ŒëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•´ì„ì„ ë§ˆë¬´ë¦¬í•˜ëŠ” ê²ƒì´ ìì—°ìŠ¤ëŸ½ë‹¤.</p>
<p>DEC í•™ìŠµ ë¡œê·¸ë¥¼ ë³´ë©´ epoch=1ì—ì„œ label_change=0.0000ìœ¼ë¡œ ì‹œì‘í•´, epoch=6ì—ì„œ ì¡°ê¸° ì¢…ë£Œ(early stop)ê°€ ë°œìƒí–ˆê³  label_changeê°€ ëê¹Œì§€ 0.0000ìœ¼ë¡œ ìœ ì§€ë˜ì—ˆë‹¤. ì´ëŠ” ì²« target p ì—…ë°ì´íŠ¸ ì´í›„ì—ë„ í•˜ë“œ ë¼ë²¨(argmax ê¸°ì¤€)ì´ ì „í˜€ ë°”ë€Œì§€ ì•Šì•˜ë‹¤ëŠ” ëœ»ìœ¼ë¡œ, ì´ë²ˆ ì„¤ì •ì—ì„œëŠ” KL ê¸°ë°˜ ìµœì í™”ê°€ êµ°ì§‘ ë°°ì •ì„ ì‹¤ì§ˆì ìœ¼ë¡œ ì¬ë°°ì¹˜í•˜ì§€ ëª»í•˜ê³  ë§¤ìš° ë¹ ë¥´ê²Œ ê³ ì •ì ì— ë„ë‹¬í–ˆìŒì„ ë‚˜íƒ€ë‚¸ë‹¤. ë³´í†µ ì´ëŸ° í˜„ìƒì€ ì´ˆê¸° KMeans ë°°ì •ì´ ì´ë¯¸ ì•ˆì •ì ì¸ ê²½ìš°ì—ë„ ë‚˜íƒ€ë‚  ìˆ˜ ìˆì§€ë§Œ, ë™ì‹œì— í•™ìŠµë¥ , update_interval, tol ì„¤ì •, ê·¸ë¦¬ê³  gamma(ì¬êµ¬ì„± ì†ì‹¤ ê°€ì¤‘ì¹˜)ê°€ ìƒëŒ€ì ìœ¼ë¡œ ì»¤ì„œ ì„ë² ë”©ì´ êµ°ì§‘ ëª©ì  ë°©í–¥ìœ¼ë¡œ ì¶©ë¶„íˆ ì›€ì§ì´ì§€ ëª»í•œ ê²½ìš°ì—ë„ í”íˆ ê´€ì°°ëœë‹¤. ê²°ê³¼ì ìœ¼ë¡œ â€œë™ì‹œ ìµœì í™”â€ì˜ íš¨ê³¼ê°€ ì œí•œì ìœ¼ë¡œ ë‚˜íƒ€ë‚œ ìƒí™©ìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤.</p>
<p>ìµœì¢… ì§€í‘œë¥¼ ë³´ë©´ DEC-like(AE10D, K=9, gamma=1.0)ì€ silhouette=0.2522, ARI=0.5657, NMI=0.6926ì´ë‹¤. ì´ëŠ” ë‚´ë¶€ì§€í‘œ(silhouette) ì¸¡ë©´ì—ì„œëŠ” AE+KMeansì˜ 0.2807ë³´ë‹¤ ë‚®ì§€ë§Œ, PCA(10D)+GMMì˜ 0.2512ì™€ëŠ” ë¹„ìŠ·í•œ ìˆ˜ì¤€ì´ë‹¤. ì™¸ë¶€ì§€í‘œ(ARI/NMI) ê¸°ì¤€ìœ¼ë¡œëŠ” AE+KMeans(ARI=0.5977, NMI=0.7012)ë³´ë‹¤ ë‚®ì•„ â€œì„ë² ë”©ì„ êµ°ì§‘ ëª©ì ì— ë§ê²Œ ì¡°ì •í–ˆëŠ”ë°ë„â€ ì •ë‹µ ë¼ë²¨ê³¼ì˜ ì •í•©ì„±ì´ ê°œì„ ë˜ì—ˆë‹¤ê³  ë³´ê¸°ëŠ” ì–´ë µë‹¤. ë‹¤ë§Œ KMeans ë‹¨ë…(Sil-best)ì˜ ARI=0.5683ê³¼ ë¹„êµí•˜ë©´ ê±°ì˜ ë¹„ìŠ·í•œ ìˆ˜ì¤€ì´ë©°, PCA ê¸°ë°˜ í‘œí˜„êµ°ì§‘(íŠ¹íˆ PCA10D+GMMì˜ ARI=0.5649)ê³¼ë„ ìœ ì‚¬í•œ ì™¸ë¶€ì§€í‘œë¥¼ ë³´ì¸ë‹¤. ì¦‰, ì´ë²ˆ ì‹¤í–‰ì—ì„œ DEC-likeëŠ” ì˜ë¯¸ ìˆëŠ” ì„±ëŠ¥ ë„ì•½ì„ ë§Œë“¤ì§€ëŠ” ëª»í–ˆì§€ë§Œ, ìµœì†Œí•œ í‘œí˜„ê¸°ë°˜ êµ°ì§‘ì˜ ìƒìœ„ê¶Œ ë²”ì£¼ì—ëŠ” ë¨¸ë¬¼ë©° â€œDEC ê°œë… ì‹¤í—˜ì´ ì‹¤ì œë¡œ ëŒì•„ê°€ê³  í‰ê°€ê¹Œì§€ ì´ì–´ì§„â€ ìƒíƒœë¥¼ í™•ë³´í–ˆë‹¤ê³  ì •ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>
<p>ë˜í•œ WSSëŠ” 29944.3ìœ¼ë¡œ AE+KMeansì˜ 21491.1ë³´ë‹¤ ì»¤ì¡ŒëŠ”ë°, ì´ëŠ” ì´ë²ˆ í‘œì—ì„œ WSSê°€ ì„ë² ë”© ê³µê°„ì—ì„œì˜ within-cluster ì œê³±í•©ìœ¼ë¡œ ê³„ì‚°ë˜ì–´ ìˆê³ , DEC í•™ìŠµ í›„ ì„ë² ë”© ê³µê°„ì˜ ìŠ¤ì¼€ì¼ì´ë‚˜ êµ°ì§‘ ì¤‘ì‹¬ ë°°ì¹˜ê°€ KMeans ê²°ê³¼ì™€ ë‹¬ë¼ì¡ŒìŒì„ ë°˜ì˜í•œë‹¤. WSSëŠ” ê³µê°„ ìŠ¤ì¼€ì¼ì˜ ì˜í–¥ì„ í¬ê²Œ ë°›ê¸° ë•Œë¬¸ì—, ì¬êµ¬ì„± ì†ì‹¤ì„ í¬í•¨í•´ ì„ë² ë”©ì´ ë³€í•˜ë©´ ê°’ì´ ì»¤ì§€ê±°ë‚˜ ì‘ì•„ì§ˆ ìˆ˜ ìˆìœ¼ë©°, ë‹¨ë…ìœ¼ë¡œ ì„±ëŠ¥ì„ ë‹¨ì •í•˜ëŠ” ì§€í‘œë¡œ ì“°ê¸°ë³´ë‹¤ëŠ” silhouette ë° ì™¸ë¶€ì§€í‘œì™€ í•¨ê»˜ ë³´ì¡°ì ìœ¼ë¡œ í•´ì„í•˜ëŠ” í¸ì´ ì•ˆì •ì ì´ë‹¤.</p>
<p>ì •ë¦¬í•˜ë©´, ì´ë²ˆ DEC-like ê²°ê³¼ëŠ” (1) AE ì‚¬ì „í•™ìŠµìœ¼ë¡œ ì¬êµ¬ì„± í’ˆì§ˆì€ í™•ë³´í–ˆì§€ë§Œ, (2) KL ê¸°ë°˜ êµ°ì§‘ ëª©ì ì´ ë¼ë²¨ ì¬ë°°ì •ì„ ê±°ì˜ ìœ ë„í•˜ì§€ ëª»í•´ ë§¤ìš° ë¹ ë¥´ê²Œ ìˆ˜ë ´í–ˆê³ , (3) ìµœì¢… ì„±ëŠ¥ì€ AE+KMeansë³´ë‹¤ ë‹¤ì†Œ ë‚®ì•„ì¡Œë‹¤. ë”°ë¼ì„œ â€œêµ°ì§‘ ëª©ì ì„ ê°™ì´ ìµœì í™”í•˜ë©´ ë¬´ì¡°ê±´ ì¢‹ì•„ì§„ë‹¤â€ê°€ ì•„ë‹ˆë¼, ì´ˆê¸°í™”ì™€ ì†ì‹¤ ê°€ì¤‘ì¹˜, target ì—…ë°ì´íŠ¸ ì „ëµì´ ì„±ëŠ¥ì— ë¯¼ê°í•˜ë‹¤ëŠ” ì ì„ ë³´ì—¬ì£¼ëŠ” ì‚¬ë¡€ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤. í›„ì† ì‹¤í—˜ì—ì„œëŠ” gammaë¥¼ ì¤„ì—¬ KL í•­ì˜ ì˜í–¥ë ¥ì„ í‚¤ìš°ê±°ë‚˜, update_intervalì„ í¬ê²Œ(ì˜ˆ: 5~10 epoch) í•˜ì—¬ p ì—…ë°ì´íŠ¸ì˜ ë…¸ì´ì¦ˆë¥¼ ì¤„ì´ê±°ë‚˜, tolì„ ë” ì‘ê²Œ ë‘ì–´ ì¡°ê¸° ì¢…ë£Œê°€ ë„ˆë¬´ ë¹ ë¥´ê²Œ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì¡°ì •í•˜ë©´ DECì˜ ì¥ì (êµ°ì§‘ ê²½ê³„ ê°•í™”)ì´ ë” ì˜ ê´€ì°°ë  ê°€ëŠ¥ì„±ì´ ìˆë‹¤.</p>
<pre class="text"><code>X_nn shape: (1797, 64)
[Pretrain AE] latent_dim=10, best val_loss=0.018878
[K selection on embedding] K_best=9, best silhouette=0.2455
[DEC] start training...
  epoch=01, label_change=0.0000
  early stop at epoch=6, label_change=0.0000
[DEC] training done.
method  K   silhouette  wss ARI NMI AIC BIC
0   DEC-like(AE10D, K=9, gamma=1.0, val=0.01888)    9   0.252209    29944.263672    0.565679    0.692584    NaN NaN
method  K   silhouette  wss ARI NMI AIC BIC
0   Hierarchical(Ward) (Sil-best)   20  0.152754    54003.237083    0.688082    0.794962    NaN NaN
1   AutoEncoder(10D, val_loss=0.02413) + KMeans (S...   9   0.280719    21491.103516    0.597681    0.701210    NaN NaN
2   KMeans (Sil-best)   15  0.158307    59534.498937    0.568326    0.688241    NaN NaN
3   DEC-like(AE10D, K=9, gamma=1.0, val=0.01888)    9   0.252209    29944.263672    0.565679    0.692584    NaN NaN
4   PCA(10D, EV=0.589) + GMM(BIC-best, full)    13  0.251226    25275.837661    0.564898    0.707620    50025.756510    54734.006431
5   PCA(20D, EV=0.793) + KMeans (Sil-best)  15  0.222177    37368.974559    0.551132    0.681702    NaN NaN
6   PCA(20D, EV=0.793) + GMM(BIC-best, full)    11  0.193245    47099.997586    0.545944    0.697619    61251.650935    75206.090607
7   PCA(10D, EV=0.589) + KMeans (Sil-best)  12  0.287190    23293.872256    0.538087    0.669544    NaN NaN
8   GMM(BIC-best, diag) 20  0.093540    62457.729652    0.437694    0.596951    -232769.805429  -218601.104675
9   PCA(2D, EV=0.216) + KMeans (Sil-best)   8   0.392024    3563.424744 0.331101    0.472753    NaN NaN
10  PCA(2D, EV=0.216) + GMM(BIC-best, full) 4   0.370952    8414.589706 0.199783    0.436065    16308.982097    16435.341197
11  Hierarchical(Complete) (Sil-best)   2   0.784424    106721.094913   0.000002    0.001556    NaN NaN</code></pre>
</section>
</section>
<section id="ìµœì¢…-ë³´ê³ ì„œ-ìƒì„±-ìƒìœ„-3ê°œ-ë°©ë²•ì˜-êµì°¨í‘œ-ëŒ€í‘œìˆ«ì-ëŒ€í‘œì´ë¯¸ì§€-ì‹œê°í™”" class="level4">
<h4 class="anchored" data-anchor-id="ìµœì¢…-ë³´ê³ ì„œ-ìƒì„±-ìƒìœ„-3ê°œ-ë°©ë²•ì˜-êµì°¨í‘œ-ëŒ€í‘œìˆ«ì-ëŒ€í‘œì´ë¯¸ì§€-ì‹œê°í™”">7. ìµœì¢… ë³´ê³ ì„œ ìƒì„±: ìƒìœ„ 3ê°œ ë°©ë²•ì˜ êµì°¨í‘œ, ëŒ€í‘œìˆ«ì, ëŒ€í‘œì´ë¯¸ì§€ ì‹œê°í™”</h4>
<p>ì´ ì½”ë“œëŠ” ì•ì—ì„œ ë§Œë“¤ì–´ ë‘” ë¹„êµí‘œ(comparison_sorted)ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„, ì„±ëŠ¥ì´ ì¢‹ì€ ìƒìœ„ 3ê°œ êµ°ì§‘ ë°©ë²•ì„ ìë™ìœ¼ë¡œ ì„ ì •í•˜ê³ , ê° ë°©ë²•ì— ëŒ€í•´ êµ°ì§‘ê³¼ ì‹¤ì œ ìˆ«ì ë¼ë²¨ì˜ ê´€ê³„ë¥¼ êµì°¨í‘œë¡œ ì œì‹œí•˜ë©°, í´ëŸ¬ìŠ¤í„°ë³„ ëŒ€í‘œ í‘œë³¸ ì´ë¯¸ì§€ë¥¼ ì‹œê°í™”í•œë‹¤. ì¦‰, ë‹¤ì–‘í•œ êµ°ì§‘ ì‹¤í—˜ ê²°ê³¼ë¥¼ í•œ ë²ˆì— ë³´ê³ ì„œ í˜•íƒœë¡œ ìš”ì•½í•˜ê¸° ìœ„í•œ ìë™ ë¦¬í¬íŒ… ì…€ì´ë‹¤.</p>
<section id="ì½”ë“œì˜-ì…ë ¥ê³¼-ì „ì œ" class="level5">
<h5 class="anchored" data-anchor-id="ì½”ë“œì˜-ì…ë ¥ê³¼-ì „ì œ">ì½”ë“œì˜ ì…ë ¥ê³¼ ì „ì œ</h5>
<p>ì´ ì…€ì€ ë‹¤ìŒ ë³€ìˆ˜ê°€ ì´ë¯¸ ì„¸ì…˜ì— ì¡´ì¬í•œë‹¤ê³  ê°€ì •í•œë‹¤.</p>
<ul>
<li>X, X_std: digits ë°ì´í„°(ì›ê³µê°„ X)ì™€ í‘œì¤€í™”ëœ ë°ì´í„°(X_std)</li>
<li>y: ì‹¤ì œ ì •ë‹µ ë¼ë²¨(0~9)</li>
<li>images: 8Ã—8 í˜•íƒœë¡œ reshapeëœ ìˆ«ì ì´ë¯¸ì§€(ëŒ€í‘œ ì´ë¯¸ì§€ ì‹œê°í™”ì— ì‚¬ìš©)</li>
<li>comparison_sorted: ì „í†µì  êµ°ì§‘, ëª¨ë¸ê¸°ë°˜ êµ°ì§‘(GMM), í‘œí˜„ê¸°ë°˜ êµ°ì§‘(PCA/AE/DEC-like) ë“±ì„ í•œ í…Œì´ë¸”ì— ì •ë¦¬í•´ ë‘” ë¹„êµí‘œ method, K, ARI, NMI, silhouette, wss ë“±ì´ ë“¤ì–´ìˆë‹¤ê³  ë³¸ë‹¤.</li>
</ul>
<p>ì´ ì½”ë“œì˜ ëª©ì ì€ ìƒˆë¡œìš´ êµ°ì§‘ì„ ì¶”ê°€ë¡œ í•™ìŠµí•˜ê¸°ë³´ë‹¤, ë¹„êµí‘œì— ê¸°ë¡ëœ ìƒìœ„ ë°©ë²•ì„ ì„ íƒí•œ ë’¤ ê·¸ ë°©ë²•ì˜ ë¼ë²¨ì„ ì¬ìƒì„±í•˜ê±°ë‚˜ ê¸°ì¡´ ë¼ë²¨ì„ ì¬ì‚¬ìš©í•˜ì—¬ ë³´ê³ ì„œìš© ì¶œë ¥ë¬¼ì„ ë§Œë“œëŠ” ê²ƒì´ë‹¤.</p>
</section>
<section id="ê³µí†µ-ì„¤ì •ê³¼-ê¸°ì¤€-ê³µê°„x_baseì˜-ì˜ë¯¸" class="level5">
<h5 class="anchored" data-anchor-id="ê³µí†µ-ì„¤ì •ê³¼-ê¸°ì¤€-ê³µê°„x_baseì˜-ì˜ë¯¸">ê³µí†µ ì„¤ì •ê³¼ ê¸°ì¤€ ê³µê°„(X_base)ì˜ ì˜ë¯¸</h5>
<p>RANDOM_STATEë¥¼ ê³ ì •í•˜ê³ , ë¹„êµì˜ ê¸°ì¤€ ê³µê°„ìœ¼ë¡œ X_base = X_stdë¥¼ ë‘”ë‹¤. ì´ëŠ” silhouetteì´ë‚˜ WSS ê°™ì€ ë‚´ë¶€ ì§€í‘œë¥¼ ê³„ì‚°í•  ë•Œ, ì„œë¡œ ë‹¤ë¥¸ ë°©ë²•ì„ ê°€ëŠ¥í•œ í•œ ê³µì •í•œ ê¸°ì¤€ì—ì„œ ë¹„êµí•˜ë ¤ëŠ” ì˜ë„ì´ë‹¤.</p>
<p>ë‹¤ë§Œ PCA/AE/DEC ê°™ì€ í‘œí˜„ê¸°ë°˜ ë°©ë²•ì€ êµ°ì§‘ì´ ìˆ˜í–‰ë˜ëŠ” ê³µê°„ì´ X_stdê°€ ì•„ë‹ˆë¼ ì„ë² ë”© ê³µê°„ Zì´ë¯€ë¡œ, ì´ ì½”ë“œì—ì„œëŠ” ì›ì¹™ì ìœ¼ë¡œ ê·¸ ì„ë² ë”© ê³µê°„ì—ì„œ silhouetteê³¼ WSSë¥¼ ê³„ì‚°í•˜ë ¤ê³  ì‹œë„í•œë‹¤.</p>
</section>
<section id="wss-ê³„ì‚°-í•¨ìˆ˜-compute_wss" class="level5">
<h5 class="anchored" data-anchor-id="wss-ê³„ì‚°-í•¨ìˆ˜-compute_wss">WSS ê³„ì‚° í•¨ìˆ˜ compute_wss</h5>
<p>compute_wss(Xmat, labels)ëŠ” ë¼ë²¨ì´ ì£¼ì–´ì¡Œì„ ë•Œ êµ°ì§‘ë³„ í‰ê·  ë²¡í„°(centroid)ë¥¼ ê³„ì‚°í•˜ê³ , ê° í‘œë³¸ì´ ìì‹ ì´ ì†í•œ êµ°ì§‘ ì¤‘ì‹¬ì—ì„œ ë–¨ì–´ì§„ ì œê³±ê±°ë¦¬ì˜ í•©ì„ ë”í•´ WSSë¥¼ êµ¬í•œë‹¤.</p>
<p>ì´ëŠ” k-meansì²˜ëŸ¼ inertia_ë¥¼ ì§ì ‘ ì œê³µí•˜ì§€ ì•ŠëŠ” ë°©ë²•ì—ì„œë„, ë¼ë²¨ë§Œ ìˆìœ¼ë©´ ë™ì¼í•œ í˜•íƒœì˜ WSSë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë„ë¡ ë§Œë“  ë³´ì¡° í•¨ìˆ˜ì´ë‹¤.</p>
</section>
<section id="ê³„ì¸µêµ°ì§‘-ë¼ë²¨-ìƒì„±-í•¨ìˆ˜-agglomerative_fit_predict" class="level5">
<h5 class="anchored" data-anchor-id="ê³„ì¸µêµ°ì§‘-ë¼ë²¨-ìƒì„±-í•¨ìˆ˜-agglomerative_fit_predict">ê³„ì¸µêµ°ì§‘ ë¼ë²¨ ìƒì„± í•¨ìˆ˜ agglomerative_fit_predict</h5>
<p>AgglomerativeClusteringì€ scikit-learn ë²„ì „ì— ë”°ë¼ metric íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•˜ê¸°ë„ í•˜ê³ , affinityë¡œ ëŒ€ì²´ë˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì´ ì½”ë“œëŠ” try/exceptë¡œ ë‘ ê²½ìš°ë¥¼ ëª¨ë‘ ì²˜ë¦¬í•´ í˜¸í™˜ì„±ì„ í™•ë³´í•œë‹¤.</p>
<p>ì´ í•¨ìˆ˜ëŠ” linkageì— ë”°ë¼ ward ë˜ëŠ” complete ë°©ì‹ìœ¼ë¡œ ê³„ì¸µêµ°ì§‘ ë¼ë²¨ì„ ìƒì„±í•œë‹¤.</p>
</section>
<section id="get_labels_by_method-ë°©ë²•-ì´ë¦„ì„-ë³´ê³ -ë¼ë²¨ì„-ì¬êµ¬ì„±í•˜ëŠ”-í•µì‹¬-ë¡œì§" class="level5">
<h5 class="anchored" data-anchor-id="get_labels_by_method-ë°©ë²•-ì´ë¦„ì„-ë³´ê³ -ë¼ë²¨ì„-ì¬êµ¬ì„±í•˜ëŠ”-í•µì‹¬-ë¡œì§">get_labels_by_method: ë°©ë²• ì´ë¦„ì„ ë³´ê³  ë¼ë²¨ì„ ì¬êµ¬ì„±í•˜ëŠ” í•µì‹¬ ë¡œì§</h5>
<p>ì´ ì…€ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì€ ë¹„êµí‘œì˜ method ë¬¸ìì—´ì„ í•´ì„í•˜ì—¬ í•´ë‹¹ ë°©ë²•ì˜ êµ°ì§‘ ë¼ë²¨ì„ ë‹¤ì‹œ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. ì¦‰, comparison_sortedì˜ ê° í–‰ì´ ê°€ì§„ method ë¬¸ìì—´ì„ ì¼ì¢…ì˜ ê·œì¹™ìœ¼ë¡œ ë³´ê³ , ê·¸ ê·œì¹™ì— ë§ì¶° ë¼ë²¨ì„ ì–»ëŠ”ë‹¤.</p>
<p>êµ¬ì²´ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë¶„ê¸°ë¥¼ ê°€ì§„ë‹¤.</p>
<ul>
<li>GMM(BIC-best, â€¦): ì´ë¯¸ ì• ì…€ì—ì„œ êµ¬í•´ë‘” z_bicì´ ìˆë‹¤ë©´ ì´ë¥¼ ì¬ì‚¬ìš©í•œë‹¤. ë³´ê³ ì„œ ì…€ì—ì„œ ë‹¤ì‹œ GMMì„ í•™ìŠµí•˜ì§€ ì•Šë„ë¡ í•˜ì—¬ ì‹¤í–‰ ì‹œê°„ì„ ì¤„ì¸ë‹¤.</li>
<li>ì „í†µì  êµ°ì§‘(KMeans, Hierarchical Ward/Complete): X_baseì—ì„œ ë™ì¼í•œ ì„¤ì •ìœ¼ë¡œ ë‹¤ì‹œ í•™ìŠµí•˜ì—¬ ë¼ë²¨ì„ ë§Œë“ ë‹¤. ë¹„êµí‘œì˜ Kê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤.</li>
<li>PCA ê¸°ë°˜ ë°©ë²•: method ë¬¸ìì—´ì—ì„œ PCA ì°¨ì› që¥¼ ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ë½‘ì•„ë‚¸ í›„, X_baseë¥¼ PCAë¡œ ë³€í™˜í•´ Zë¥¼ ë§Œë“ ë‹¤. ì´í›„ +KMeans ë˜ëŠ” +GMMì¸ì§€ì— ë”°ë¼ ë¼ë²¨ì„ ì¬ìƒì„±í•œë‹¤. GMMì˜ ê²½ìš° method ë¬¸ìì—´ì—ì„œ covariance_typeì„ ë½‘ì•„ë‚´ì–´ ë™ì¼ ì„¤ì •ìœ¼ë¡œ ì í•©í•œë‹¤.</li>
<li>AutoEncoder ì„ë² ë”© + KMeans: method ë¬¸ìì—´ì—ì„œ latent_dimì„ íŒŒì‹±í•œë‹¤. ì´ë¯¸ Z_aeê°€ ê°™ì€ ì°¨ì›ìœ¼ë¡œ ì¡´ì¬í•˜ë©´ ì¬ì‚¬ìš©í•˜ê³ , ì—†ë‹¤ë©´ ê°„ë‹¨í•œ ì˜¤í† ì¸ì½”ë”ë¥¼ ë¹ ë¥´ê²Œ ì¬í•™ìŠµí•œ ë’¤ ê·¸ ì„ë² ë”©ì—ì„œ KMeans ë¼ë²¨ì„ ìƒì„±í•œë‹¤.</li>
<li>DEC-like ë°©ë²•: ì´ë¯¸ ì•ì—ì„œ DEC í•™ìŠµì„ ìˆ˜í–‰í•´ labels_finalì´ ì¡´ì¬í•˜ë©´ ì´ë¥¼ ì¬ì‚¬ìš©í•œë‹¤.</li>
</ul>
<p>ì–´ë–¤ ê²½ìš°ì—ë„ ë¼ë²¨ì„ ë§Œë“¤ ìˆ˜ ì—†ë‹¤ë©´ Noneì„ ë°˜í™˜í•˜ì—¬, ë³´ê³ ì„œ ìƒì„± ë£¨í”„ì—ì„œ í•´ë‹¹ ë°©ë²•ì„ ê±´ë„ˆë›´ë‹¤.</p>
</section>
<section id="cluster_report-êµì°¨í‘œ-ëŒ€í‘œìˆ«ì-ìˆœë„purity-ì§€í‘œ-ì¶œë ¥" class="level5">
<h5 class="anchored" data-anchor-id="cluster_report-êµì°¨í‘œ-ëŒ€í‘œìˆ«ì-ìˆœë„purity-ì§€í‘œ-ì¶œë ¥">cluster_report: êµì°¨í‘œ, ëŒ€í‘œìˆ«ì, ìˆœë„(purity), ì§€í‘œ ì¶œë ¥</h5>
<p>cluster_report(labels, title, X_for_wss, Z_for_sil)ì€ í•œ ë°©ë²•ì˜ ë¼ë²¨ì´ ì£¼ì–´ì¡Œì„ ë•Œ ë³´ê³ ì„œ í•µì‹¬ ê²°ê³¼ë¥¼ ìƒì„±í•œë‹¤.</p>
<ul>
<li>êµì°¨í‘œ ìƒì„±: pd.crosstab(labels, y)ë¥¼ ì´ìš©í•´ cluster Ã— true_digit êµì°¨í‘œë¥¼ ë§Œë“ ë‹¤. ì´ë¥¼ í†µí•´ êµ°ì§‘ì´ ì‹¤ì œ ìˆ«ìë¥¼ ì–´ë–»ê²Œ ë¶„í• í•˜ê±°ë‚˜ ì„ëŠ”ì§€ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
<li>í´ëŸ¬ìŠ¤í„° ëŒ€í‘œìˆ«ì(ë‹¤ìˆ˜ê²°): ê° í´ëŸ¬ìŠ¤í„°ì—ì„œ ê°€ì¥ ë§ì´ ë‚˜íƒ€ë‚œ true_digitì„ major_digitë¡œ ì •ì˜í•œë‹¤. major_countëŠ” ê·¸ ê°œìˆ˜ì´ë©°, cluster_size ëŒ€ë¹„ ë¹„ìœ¨ì´ cluster_purityê°€ ëœë‹¤.</li>
<li>ì „ì²´ í‰ê·  ìˆœë„(overall_purity): ê° í´ëŸ¬ìŠ¤í„°ì˜ major_countë¥¼ í•©í•œ ë’¤ ì „ì²´ í‘œë³¸ ìˆ˜ nìœ¼ë¡œ ë‚˜ëˆˆ ê°’ì´ overall_purityì´ë‹¤. ì´ëŠ” majority-vote overall purityì— í•´ë‹¹í•˜ëŠ” ë‹¨ì¼ ìš”ì•½ ì§€í‘œë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤. ì¦‰, ê° í´ëŸ¬ìŠ¤í„°ë¥¼ ë‹¤ìˆ˜ê²°ë¡œ í•˜ë‚˜ì˜ ìˆ«ìë¡œ ëŒ€í‘œì‹œì¼°ì„ ë•Œ ì „ì²´ì—ì„œ ë§ì¶˜ ë¹„ìœ¨ì´ë‹¤.</li>
<li>ì™¸ë¶€ ì§€í‘œ(ì •ë‹µ ë¼ë²¨ ê¸°ë°˜): ARIì™€ NMIë¥¼ ê³„ì‚°í•´ ì¶œë ¥í•œë‹¤. ì´ëŠ” êµ°ì§‘ ê²°ê³¼ê°€ ì •ë‹µ ìˆ«ì êµ¬ì¡°ì™€ ì–¼ë§ˆë‚˜ ì¼ì¹˜í•˜ëŠ”ì§€ë¥¼ ì •ëŸ‰í™”í•œë‹¤.</li>
<li>ë‚´ë¶€ ì§€í‘œ(ê±°ë¦¬ ê¸°ë°˜): silhouetteê³¼ WSSëŠ” ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§„ Z_for_sil, X_for_wssì—ì„œ ê³„ì‚°í•œë‹¤. í‘œí˜„ê¸°ë°˜ ë°©ë²•ì´ë¼ë©´ ë³´í†µ ì„ë² ë”© Zì—ì„œ, ì „í†µì  ë°©ë²•ì´ë¼ë©´ X_baseì—ì„œ ê³„ì‚°ëœë‹¤.</li>
</ul>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ êµì°¨í‘œì— major_digit, cluster_size, cluster_purityë¥¼ ë¶™ì¸ í™•ì¥ í‘œ(ct_ext)ë¥¼ ì¶œë ¥í•˜ì—¬ ë³´ê³ ì„œ í‘œë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•œë‹¤.</p>
</section>
<section id="plot_representatives-í´ëŸ¬ìŠ¤í„°-ëŒ€í‘œ-ì´ë¯¸ì§€-ì‹œê°í™”" class="level5">
<h5 class="anchored" data-anchor-id="plot_representatives-í´ëŸ¬ìŠ¤í„°-ëŒ€í‘œ-ì´ë¯¸ì§€-ì‹œê°í™”">plot_representatives: í´ëŸ¬ìŠ¤í„° ëŒ€í‘œ ì´ë¯¸ì§€ ì‹œê°í™”</h5>
<p>plot_representatives(labels, â€¦)ëŠ” ê° í´ëŸ¬ìŠ¤í„°ë³„ë¡œ ëŒ€í‘œ í‘œë³¸ í•˜ë‚˜ë¥¼ ì„ ì •í•´ ì´ë¯¸ì§€ë¡œ ë³´ì—¬ì¤€ë‹¤.</p>
<p>ëŒ€í‘œ í‘œë³¸ì€ ë‹¤ìŒ ê¸°ì¤€ìœ¼ë¡œ ì„ íƒëœë‹¤.</p>
<ul>
<li>ë¨¼ì € í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ì›ê³µê°„ ë°ì´í„° X_refì—ì„œ í‰ê·  ë²¡í„° muë¥¼ ê³„ì‚°í•œë‹¤.</li>
<li>ê° í‘œë³¸ì´ muì—ì„œ ì–¼ë§ˆë‚˜ ë–¨ì–´ì ¸ ìˆëŠ”ì§€ ì œê³±ê±°ë¦¬(dist)ë¥¼ êµ¬í•œë‹¤.</li>
<li>distê°€ ìµœì†Œì¸ í‘œë³¸ì„ ê·¸ í´ëŸ¬ìŠ¤í„°ì˜ ëŒ€í‘œ(centroidì— ê°€ì¥ ê°€ê¹Œìš´ í‘œë³¸)ë¡œ ì„ ì •í•œë‹¤.</li>
</ul>
<p>ì´ ëŒ€í‘œ í‘œë³¸ì„ images ë°°ì—´ì—ì„œ êº¼ë‚´ì–´ 8Ã—8 í‘ë°± ì´ë¯¸ì§€ë¡œ ì‹œê°í™”í•œë‹¤. í´ëŸ¬ìŠ¤í„° ìˆ˜ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ max_clustersê¹Œì§€ë§Œ í‘œì‹œí•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ìƒëµí–ˆë‹¤ëŠ” ì•ˆë‚´ë¬¸ì„ ì¶œë ¥í•œë‹¤.</p>
</section>
<section id="top-3-ë°©ë²•-ì„ ì •ê³¼-ë¦¬í¬íŠ¸-ìƒì„±-íë¦„" class="level5">
<h5 class="anchored" data-anchor-id="top-3-ë°©ë²•-ì„ ì •ê³¼-ë¦¬í¬íŠ¸-ìƒì„±-íë¦„">Top-3 ë°©ë²• ì„ ì •ê³¼ ë¦¬í¬íŠ¸ ìƒì„± íë¦„</h5>
<p>ì´ ì½”ë“œëŠ” ë¹„êµí‘œ(comparison_sorted)ë¥¼ ARI, NMI, silhouette ìˆœìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•œ ë’¤ ìƒìœ„ 3ê°œ í–‰ì„ ì„ íƒí•œë‹¤. ì´í›„ ê° ë°©ë²•ì— ëŒ€í•´ ë‹¤ìŒì„ ë°˜ë³µí•œë‹¤.</p>
<ul>
<li>method, Kë¥¼ ì½ëŠ”ë‹¤.</li>
<li>get_labels_by_methodë¡œ ë¼ë²¨ì„ ë§Œë“ ë‹¤(ë˜ëŠ” ì¬ì‚¬ìš©).</li>
<li>í•´ë‹¹ ë°©ë²•ì´ êµ°ì§‘ì„ ìˆ˜í–‰í•œ ê³µê°„ì— ë§ì¶° Z_for_silê³¼ X_for_wssë¥¼ ì„¤ì •í•œë‹¤.</li>
<li>cluster_reportë¡œ êµì°¨í‘œ, ëŒ€í‘œìˆ«ì, ìˆœë„, ARI/NMI, silhouette/WSSë¥¼ ì¶œë ¥í•œë‹¤.</li>
<li>plot_representativesë¡œ ëŒ€í‘œ ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.</li>
<li>ìš”ì•½ ì§€í‘œë¥¼ summary_rowsì— ëˆ„ì í•œë‹¤.</li>
</ul>
<p>ë§ˆì§€ë§‰ì— summary_rowsë¡œë¶€í„° summary_dfë¥¼ ë§Œë“¤ì–´ ìƒìœ„ 3ê°œ ë°©ë²•ì— ëŒ€í•œ í•µì‹¬ ì§€í‘œë¥¼ í•œ í‘œë¡œ ì •ë¦¬í•œë‹¤.</p>
<p>ì´ ìë™ ìš”ì•½ ì…€ì€ ë‹¨ìˆœíˆ ARI/NMI ìƒìœ„ ë°©ë²•ì„ ë³´ì—¬ì£¼ëŠ” ìˆ˜ì¤€ì„ ë„˜ì–´, êµ°ì§‘ì´ ì‹¤ì œ ìˆ«ì êµ¬ì¡°ë¥¼ ì–´ë–»ê²Œ ë¶„í• í•˜ëŠ”ì§€ë¥¼ êµì°¨í‘œì™€ ëŒ€í‘œ ì´ë¯¸ì§€ë¡œ í•¨ê»˜ ì œì‹œí•œë‹¤ëŠ” ì ì—ì„œ ë³´ê³ ì„œ ì‘ì„±ì— ì§ì ‘ì ì¸ ë„ì›€ì„ ì¤€ë‹¤.</p>
<p>íŠ¹íˆ overall_purityëŠ” ì§ê´€ì ì¸ ë‹¨ì¼ ìš”ì•½ ì§€í‘œë¡œ, í´ëŸ¬ìŠ¤í„°ë¥¼ ë‹¤ìˆ˜ê²°ë¡œ ë¼ë²¨ë§í–ˆì„ ë•Œì˜ ì „ì²´ ì •í™•ë„ì— í•´ë‹¹í•œë‹¤. ARI/NMIì™€ í•¨ê»˜ ì œì‹œí•˜ë©´ êµ°ì§‘ ì„±ëŠ¥ì„ í•´ì„í•˜ëŠ” ë° ê· í˜•ì„ ì œê³µí•œë‹¤.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ë³´ê³ ì„œìš© ìë™ ìš”ì•½:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - ARI ìƒìœ„ 3ê°œ ë°©ë²• ì„ íƒ</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - ê° ë°©ë²•ë³„ "cluster x true digit" êµì°¨í‘œ + ëŒ€í‘œìˆ«ì + purity</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - ê° í´ëŸ¬ìŠ¤í„° ëŒ€í‘œ ì´ë¯¸ì§€(centroidì— ê°€ì¥ ê°€ê¹Œìš´ í‘œë³¸) ì‹œê°í™”</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans, AgglomerativeClustering</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.mixture <span class="im">import</span> GaussianMixture</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> adjusted_rand_score, normalized_mutual_info_score, silhouette_score</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ê³µí†µ ì„¤ì •</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>RANDOM_STATE <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_STATE)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ë¹„êµì˜ ê¸°ì¤€ ê³µê°„(ì „í†µì /ëª¨ë¸ê¸°ë°˜/PCAê¸°ë°˜ì´ ì£¼ë¡œ ì‚¬ìš©í–ˆë˜ ê³µê°„)</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>X_base <span class="op">=</span> X_std   <span class="co"># silhouette, WSS ë“±ì„ ê³µì •í•˜ê²Œ ë§ì¶”ê¸° ìœ„í•´ í‘œì¤€í™” ê³µê°„ì„ ê¸°ë³¸ìœ¼ë¡œ ë‘”ë‹¤</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_wss(Xmat, labels):</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> np.unique(labels):</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>        Xk <span class="op">=</span> Xmat[labels <span class="op">==</span> k]</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> Xk.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        wss <span class="op">+=</span> ((Xk <span class="op">-</span> mu) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(wss)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> agglomerative_fit_predict(Xmat, K, linkage):</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span>K, linkage<span class="op">=</span>linkage, metric<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">TypeError</span>:</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span>K, linkage<span class="op">=</span>linkage, affinity<span class="op">=</span><span class="st">"euclidean"</span>)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model.fit_predict(Xmat)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="co"># method ë¬¸ìì—´ì„ ë³´ê³  ë¼ë²¨ì„ ì¬ìƒì„±(ê°€ëŠ¥í•˜ë©´ ê¸°ì¡´ ë³€ìˆ˜ë¥¼ í™œìš©)</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_labels_by_method(method_name, K):</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    method_name <span class="op">=</span> <span class="bu">str</span>(method_name)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (1) GMM(BIC-best, ...) : ê°€ëŠ¥í•˜ë©´ ê¸°ì¡´ z_bic ì¬ì‚¬ìš©</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method_name.startswith(<span class="st">"GMM(BIC-best"</span>) <span class="kw">and</span> (<span class="st">"z_bic"</span> <span class="kw">in</span> <span class="bu">globals</span>()):</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(z_bic) <span class="op">==</span> <span class="bu">len</span>(y):</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> np.asarray(z_bic)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (2) ì „í†µì : KMeans / Hierarchical</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method_name.startswith(<span class="st">"KMeans"</span>):</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>        km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="bu">int</span>(K), random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> km.fit_predict(X_base)</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method_name.startswith(<span class="st">"Hierarchical(Ward)"</span>):</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> agglomerative_fit_predict(X_base, <span class="bu">int</span>(K), linkage<span class="op">=</span><span class="st">"ward"</span>)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method_name.startswith(<span class="st">"Hierarchical(Complete)"</span>):</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> agglomerative_fit_predict(X_base, <span class="bu">int</span>(K), linkage<span class="op">=</span><span class="st">"complete"</span>)</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (3) PCA ê¸°ë°˜: "PCA(10D, EV=...) + KMeans ..." í˜¹ì€ "+ GMM(...)" íŒŒì‹±</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method_name.startswith(<span class="st">"PCA("</span>):</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> re.search(<span class="vs">r"PCA</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">\d</span><span class="op">+</span><span class="kw">)</span><span class="vs">D"</span>, method_name)</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> <span class="bu">int</span>(m.group(<span class="dv">1</span>)) <span class="cf">if</span> m <span class="cf">else</span> <span class="dv">10</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>        Z <span class="op">=</span> PCA(n_components<span class="op">=</span>q, random_state<span class="op">=</span>RANDOM_STATE).fit_transform(X_base)</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"+ KMeans"</span> <span class="kw">in</span> method_name:</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>            km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="bu">int</span>(K), random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> km.fit_predict(Z)</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"+ GMM"</span> <span class="kw">in</span> method_name:</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>            <span class="co"># covariance_type íŒŒì‹± (ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ 'full')</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>            cov <span class="op">=</span> <span class="st">"full"</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>            m2 <span class="op">=</span> re.search(<span class="vs">r"GMM</span><span class="ch">\(</span><span class="vs">BIC-best,</span><span class="dv">\s</span><span class="op">*</span><span class="kw">(</span><span class="pp">[a-z]</span><span class="op">+</span><span class="kw">)</span><span class="ch">\)</span><span class="vs">"</span>, method_name)</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> m2:</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>                cov <span class="op">=</span> m2.group(<span class="dv">1</span>)</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>            gmm <span class="op">=</span> GaussianMixture(</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>                n_components<span class="op">=</span><span class="bu">int</span>(K),</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>                covariance_type<span class="op">=</span>cov,</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>                random_state<span class="op">=</span>RANDOM_STATE,</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>                n_init<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>                max_iter<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>                reg_covar<span class="op">=</span><span class="fl">1e-6</span>,</span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>                init_params<span class="op">=</span><span class="st">"kmeans"</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>            ).fit(Z)</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> gmm.predict(Z)</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (4) AutoEncoder ì„ë² ë”© + KMeans</span></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     - ì´ë¯¸ Z_aeê°€ ìˆìœ¼ë©´ ì¬ì‚¬ìš©, ì—†ìœ¼ë©´ ê°„ë‹¨ AEë¥¼ ì¬í•™ìŠµ(í•„ìš”ì‹œ)</span></span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method_name.startswith(<span class="st">"AutoEncoder("</span>) <span class="kw">and</span> <span class="st">"+ KMeans"</span> <span class="kw">in</span> method_name:</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># latent_dim íŒŒì‹±</span></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> re.search(<span class="vs">r"AutoEncoder</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">\d</span><span class="op">+</span><span class="kw">)</span><span class="vs">D"</span>, method_name)</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>        latent_dim <span class="op">=</span> <span class="bu">int</span>(m.group(<span class="dv">1</span>)) <span class="cf">if</span> m <span class="cf">else</span> <span class="dv">10</span></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"Z_ae"</span> <span class="kw">in</span> <span class="bu">globals</span>() <span class="kw">and</span> Z_ae.shape[<span class="dv">0</span>] <span class="op">==</span> <span class="bu">len</span>(y) <span class="kw">and</span> Z_ae.shape[<span class="dv">1</span>] <span class="op">==</span> latent_dim:</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>            Z <span class="op">=</span> Z_ae</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>            <span class="co"># ê°„ë‹¨ AE ì¬í•™ìŠµ(ë¹ ë¥´ê²Œ): digits ê·œëª¨ë¼ ë¶€ë‹´ ì ìŒ</span></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>            <span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>            <span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>            tf.random.set_seed(RANDOM_STATE)</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>            scaler_nn <span class="op">=</span> MinMaxScaler()</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>            X_nn <span class="op">=</span> scaler_nn.fit_transform(X).astype(<span class="st">"float32"</span>)</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> X_nn.shape[<span class="dv">1</span>]</span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>            hidden_dim <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> keras.Input(shape<span class="op">=</span>(p,))</span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a>            h <span class="op">=</span> layers.Dense(hidden_dim, activation<span class="op">=</span><span class="st">"relu"</span>)(inputs)</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>            z <span class="op">=</span> layers.Dense(latent_dim, activation<span class="op">=</span><span class="st">"linear"</span>)(h)</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>            h2 <span class="op">=</span> layers.Dense(hidden_dim, activation<span class="op">=</span><span class="st">"relu"</span>)(z)</span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> layers.Dense(p, activation<span class="op">=</span><span class="st">"sigmoid"</span>)(h2)</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>            ae <span class="op">=</span> keras.Model(inputs, outputs)</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>            enc <span class="op">=</span> keras.Model(inputs, z)</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>            ae.<span class="bu">compile</span>(optimizer<span class="op">=</span>keras.optimizers.Adam(<span class="fl">1e-3</span>), loss<span class="op">=</span><span class="st">"mse"</span>)</span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>            early <span class="op">=</span> keras.callbacks.EarlyStopping(monitor<span class="op">=</span><span class="st">"val_loss"</span>, patience<span class="op">=</span><span class="dv">3</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>            ae.fit(X_nn, X_nn, epochs<span class="op">=</span><span class="dv">30</span>, batch_size<span class="op">=</span><span class="dv">128</span>, validation_split<span class="op">=</span><span class="fl">0.2</span>, callbacks<span class="op">=</span>[early], verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>            Z <span class="op">=</span> enc.predict(X_nn, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>        km <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="bu">int</span>(K), random_state<span class="op">=</span>RANDOM_STATE, n_init<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> km.fit_predict(Z)</span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (5) DEC-like ê²°ê³¼(ì´ë¯¸ ê³„ì‚°ë˜ì–´ ìˆìœ¼ë©´ ì¬ì‚¬ìš©)</span></span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method_name.startswith(<span class="st">"DEC-like"</span>) <span class="kw">and</span> (<span class="st">"labels_final"</span> <span class="kw">in</span> <span class="bu">globals</span>()):</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(labels_final) <span class="op">==</span> <span class="bu">len</span>(y):</span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> np.asarray(labels_final)</span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ì—¬ê¸°ê¹Œì§€ ì™”ë‹¤ë©´ ì¬ìƒì„± ë¶ˆê°€</span></span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster x digit êµì°¨í‘œ + ëŒ€í‘œìˆ«ì(ë‹¤ìˆ˜ê²°) + purity ê³„ì‚°</span></span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cluster_report(labels, title, X_for_wss<span class="op">=</span><span class="va">None</span>, Z_for_sil<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> np.asarray(labels)</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>    K <span class="op">=</span> <span class="bu">len</span>(np.unique(labels))</span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(labels)</span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># êµì°¨í‘œ: rows=cluster, cols=true digit</span></span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>    ct <span class="op">=</span> pd.crosstab(labels, y, rownames<span class="op">=</span>[<span class="st">"cluster"</span>], colnames<span class="op">=</span>[<span class="st">"true_digit"</span>])</span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ëŒ€í‘œ ìˆ«ì(ë‹¤ìˆ˜ê²°) ë° purity</span></span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>    major_digit <span class="op">=</span> ct.idxmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>    major_count <span class="op">=</span> ct.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>    cluster_size <span class="op">=</span> ct.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>    cluster_purity <span class="op">=</span> (major_count <span class="op">/</span> cluster_size).rename(<span class="st">"cluster_purity"</span>)</span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a>    ct_ext <span class="op">=</span> ct.copy()</span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a>    ct_ext[<span class="st">"major_digit"</span>] <span class="op">=</span> major_digit</span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>    ct_ext[<span class="st">"cluster_size"</span>] <span class="op">=</span> cluster_size</span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a>    ct_ext[<span class="st">"cluster_purity"</span>] <span class="op">=</span> cluster_purity</span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a>    overall_purity <span class="op">=</span> <span class="bu">float</span>(major_count.<span class="bu">sum</span>() <span class="op">/</span> n)</span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ë‚´ë¶€/ì™¸ë¶€ ì§€í‘œ</span></span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>    ari <span class="op">=</span> adjusted_rand_score(y, labels)</span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a>    nmi <span class="op">=</span> normalized_mutual_info_score(y, labels)</span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a>    sil <span class="op">=</span> np.nan</span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a>    wss <span class="op">=</span> np.nan</span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> Z_for_sil <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>            sil <span class="op">=</span> <span class="bu">float</span>(silhouette_score(Z_for_sil, labels, metric<span class="op">=</span><span class="st">"euclidean"</span>))</span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>            sil <span class="op">=</span> np.nan</span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> X_for_wss <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>        wss <span class="op">=</span> <span class="bu">float</span>(compute_wss(X_for_wss, labels))</span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> ==="</span>)</span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"K=</span><span class="sc">{</span>K<span class="sc">}</span><span class="ss">, overall_purity(majority vote)=</span><span class="sc">{</span>overall_purity<span class="sc">:.4f}</span><span class="ss">, ARI=</span><span class="sc">{</span>ari<span class="sc">:.4f}</span><span class="ss">, NMI=</span><span class="sc">{</span>nmi<span class="sc">:.4f}</span><span class="ss">, silhouette=</span><span class="sc">{</span>sil<span class="sc">:.4f}</span><span class="ss">, WSS=</span><span class="sc">{</span>wss<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>    display(ct_ext.sort_values([<span class="st">"cluster_purity"</span>,<span class="st">"cluster_size"</span>], ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ct_ext, overall_purity, ari, nmi, sil, wss</span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a><span class="co"># ëŒ€í‘œ ì´ë¯¸ì§€(ê° clusterì˜ centroidì— ê°€ì¥ ê°€ê¹Œìš´ í‘œë³¸ 1ê°œ)</span></span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_representatives(labels, method_title, X_ref<span class="op">=</span><span class="va">None</span>, max_clusters<span class="op">=</span><span class="dv">20</span>, ncols<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> np.asarray(labels)</span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>    clusters <span class="op">=</span> np.unique(labels)</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a>    K <span class="op">=</span> <span class="bu">len</span>(clusters)</span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> X_ref <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a>        X_ref <span class="op">=</span> X  <span class="co"># ì›ê³µê°„ì—ì„œ ëŒ€í‘œë¥¼ ë½‘ëŠ” ê²ƒì´ ì§ê´€ì ì´ë‹¤</span></span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ë„ˆë¬´ ë§ìœ¼ë©´ ì¼ë¶€ë§Œ</span></span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>    show_clusters <span class="op">=</span> clusters[:max_clusters]</span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>    n_show <span class="op">=</span> <span class="bu">len</span>(show_clusters)</span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a>    nrows <span class="op">=</span> <span class="bu">int</span>(np.ceil(n_show <span class="op">/</span> ncols))</span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a>    reps <span class="op">=</span> []</span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> show_clusters:</span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a>        idxs <span class="op">=</span> np.where(labels <span class="op">==</span> c)[<span class="dv">0</span>]</span>
<span id="cb21-203"><a href="#cb21-203" aria-hidden="true" tabindex="-1"></a>        Xc <span class="op">=</span> X_ref[idxs]</span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> Xc.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> ((Xc <span class="op">-</span> mu) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>        rep_idx <span class="op">=</span> idxs[np.argmin(dist)]</span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a>        reps.append(rep_idx)</span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="fl">1.2</span><span class="op">*</span>ncols, <span class="fl">1.2</span><span class="op">*</span>nrows))</span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, rep_idx <span class="kw">in</span> <span class="bu">enumerate</span>(reps):</span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> plt.subplot(nrows, ncols, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a>        ax.imshow(images[rep_idx], cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f"cl=</span><span class="sc">{</span>show_clusters[i]<span class="sc">}</span><span class="ch">\n</span><span class="ss">y=</span><span class="sc">{</span>y[rep_idx]<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a>        ax.axis(<span class="st">"off"</span>)</span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a>    plt.suptitle(<span class="ss">f"Representatives (up to </span><span class="sc">{</span>max_clusters<span class="sc">}</span><span class="ss"> clusters): </span><span class="sc">{</span>method_title<span class="sc">}</span><span class="ss">"</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> K <span class="op">&gt;</span> max_clusters:</span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"â€» í´ëŸ¬ìŠ¤í„°ê°€ </span><span class="sc">{</span>K<span class="sc">}</span><span class="ss">ê°œë¼ì„œ ëŒ€í‘œ ì´ë¯¸ì§€ëŠ” ì²˜ìŒ </span><span class="sc">{</span>max_clusters<span class="sc">}</span><span class="ss">ê°œ í´ëŸ¬ìŠ¤í„°ë§Œ í‘œì‹œí–ˆë‹¤."</span>)</span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Top-3 ì„ íƒ (ARI ìš°ì„ , ë™ë¥ ì´ë©´ NMI)</span></span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a>top3 <span class="op">=</span> (comparison_sorted</span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a>        .sort_values([<span class="st">"ARI"</span>,<span class="st">"NMI"</span>,<span class="st">"silhouette"</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a>        .head(<span class="dv">3</span>)</span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a>        .reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Top-3 methods (by ARI/NMI) ==="</span>)</span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>display(top3[[<span class="st">"method"</span>,<span class="st">"K"</span>,<span class="st">"ARI"</span>,<span class="st">"NMI"</span>,<span class="st">"silhouette"</span>,<span class="st">"wss"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>]])</span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) ê° ë°©ë²•ë³„ ë³´ê³ ì„œ ìƒì„±</span></span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a>summary_rows <span class="op">=</span> []</span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> top3.iterrows():</span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>    method <span class="op">=</span> row[<span class="st">"method"</span>]</span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a>    K <span class="op">=</span> <span class="bu">int</span>(row[<span class="st">"K"</span>])</span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> get_labels_by_method(method, K)</span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> labels <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">âš ï¸ '</span><span class="sc">{</span>method<span class="sc">}</span><span class="ss">' ì€(ëŠ”) í˜„ì¬ ì„¸ì…˜ì—ì„œ ë¼ë²¨ì„ ì¬êµ¬ì„±í•  ìˆ˜ ì—†ë‹¤. (í•´ë‹¹ ì…€ë“¤ì„ ë¨¼ì € ì‹¤í–‰í•œ ë’¤ ë‹¤ì‹œ ì‹œë„)"</span>)</span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a>    <span class="co"># silhouette/WSSë¥¼ ê³µì •í•˜ê²Œ ê³„ì‚°í•˜ë ¤ë©´ "ê·¸ ë°©ë²•ì´ êµ°ì§‘ì„ ìˆ˜í–‰í•œ ê³µê°„"ì´ í•„ìš”í•˜ë‚˜</span></span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ì—¬ê¸°ì„œëŠ” ë³´ê³ ì„œ ì¼ê´€ì„±ì„ ìœ„í•´:</span></span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a>    <span class="co"># - ì „í†µ/ëª¨ë¸(GMM): X_baseì—ì„œ silhouette/WSS</span></span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a>    <span class="co"># - PCA/AE/DEC: í•´ë‹¹ ì„ë² ë”©(Z)ì´ ìˆìœ¼ë©´ ê·¸ Zì—ì„œ silhouette ê³„ì‚°</span></span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a>    Z_for_sil <span class="op">=</span> <span class="va">None</span></span>
<span id="cb21-252"><a href="#cb21-252" aria-hidden="true" tabindex="-1"></a>    X_for_wss <span class="op">=</span> <span class="va">None</span></span>
<span id="cb21-253"><a href="#cb21-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method.startswith(<span class="st">"PCA("</span>):</span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> <span class="bu">int</span>(re.search(<span class="vs">r"PCA</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">\d</span><span class="op">+</span><span class="kw">)</span><span class="vs">D"</span>, method).group(<span class="dv">1</span>))</span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a>        Z_for_sil <span class="op">=</span> PCA(n_components<span class="op">=</span>q, random_state<span class="op">=</span>RANDOM_STATE).fit_transform(X_base)</span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a>        X_for_wss <span class="op">=</span> Z_for_sil</span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method.startswith(<span class="st">"AutoEncoder("</span>):</span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"Z_ae"</span> <span class="kw">in</span> <span class="bu">globals</span>() <span class="kw">and</span> <span class="bu">len</span>(Z_ae) <span class="op">==</span> <span class="bu">len</span>(y):</span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a>            Z_for_sil <span class="op">=</span> Z_ae</span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a>            X_for_wss <span class="op">=</span> Z_ae</span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a>            Z_for_sil <span class="op">=</span> <span class="va">None</span></span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a>            X_for_wss <span class="op">=</span> X_base</span>
<span id="cb21-266"><a href="#cb21-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-267"><a href="#cb21-267" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method.startswith(<span class="st">"DEC-like"</span>):</span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"z_final"</span> <span class="kw">in</span> <span class="bu">globals</span>() <span class="kw">and</span> <span class="bu">len</span>(z_final) <span class="op">==</span> <span class="bu">len</span>(y):</span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a>            Z_for_sil <span class="op">=</span> z_final</span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a>            X_for_wss <span class="op">=</span> z_final</span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a>            Z_for_sil <span class="op">=</span> <span class="va">None</span></span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a>            X_for_wss <span class="op">=</span> X_base</span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a>        Z_for_sil <span class="op">=</span> X_base</span>
<span id="cb21-277"><a href="#cb21-277" aria-hidden="true" tabindex="-1"></a>        X_for_wss <span class="op">=</span> X_base</span>
<span id="cb21-278"><a href="#cb21-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a>    ct_ext, purity, ari, nmi, sil, wss <span class="op">=</span> cluster_report(</span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a>        labels, title<span class="op">=</span>method, X_for_wss<span class="op">=</span>X_for_wss, Z_for_sil<span class="op">=</span>Z_for_sil</span>
<span id="cb21-281"><a href="#cb21-281" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-282"><a href="#cb21-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ëŒ€í‘œ ì´ë¯¸ì§€(ì›ê³µê°„ì—ì„œ ëŒ€í‘œë¥¼ ë½‘ì•„ ì‹œê°ì ìœ¼ë¡œ í•´ì„)</span></span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a>    plot_representatives(labels, method_title<span class="op">=</span>method, X_ref<span class="op">=</span>X, max_clusters<span class="op">=</span><span class="dv">20</span>, ncols<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a>    summary_rows.append({</span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a>        <span class="st">"method"</span>: method,</span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K"</span>: <span class="bu">len</span>(np.unique(labels)),</span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a>        <span class="st">"purity(majority)"</span>: purity,</span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ARI"</span>: ari,</span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NMI"</span>: nmi,</span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a>        <span class="st">"silhouette"</span>: sil,</span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a>        <span class="st">"WSS"</span>: wss</span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== Top-3 summary table ==="</span>)</span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a>summary_df <span class="op">=</span> pd.DataFrame(summary_rows).sort_values([<span class="st">"ARI"</span>,<span class="st">"NMI"</span>], ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a>display(summary_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="êµ°ì§‘-ê²°ê³¼-í•´ì„-ë²„ì „-b-í‘œë¥¼-ì½ëŠ”-ë²•-ì¤‘ì‹¬ìœ¼ë¡œ-ì°¨ê·¼ì°¨ê·¼" class="level5">
<h5 class="anchored" data-anchor-id="êµ°ì§‘-ê²°ê³¼-í•´ì„-ë²„ì „-b-í‘œë¥¼-ì½ëŠ”-ë²•-ì¤‘ì‹¬ìœ¼ë¡œ-ì°¨ê·¼ì°¨ê·¼">êµ°ì§‘ ê²°ê³¼ í•´ì„ (ë²„ì „ B: â€œí‘œë¥¼ ì½ëŠ” ë²•â€ ì¤‘ì‹¬ìœ¼ë¡œ ì°¨ê·¼ì°¨ê·¼)</h5>
<p>ì´ë²ˆ ì¶œë ¥ì€ êµ°ì§‘ ì„±ëŠ¥ì„ ë‘ ê´€ì ìœ¼ë¡œ ì •ë¦¬í•œ ê²ƒì´ë‹¤.</p>
<p><strong>ë‚´ë¶€ì§€í‘œ: silhouette, WSS</strong></p>
<ul>
<li>silhouetteê°€ ë†’ì„ìˆ˜ë¡ êµ°ì§‘ì´ ë‚´ë¶€ì ìœ¼ë¡œ ë” ì‘ì§‘ë˜ê³ (ê°™ì€ êµ°ì§‘ë¼ë¦¬ ê°€ê¹ê³ ), ì„œë¡œ ë” ë¶„ë¦¬ëœë‹¤(ë‹¤ë¥¸ êµ°ì§‘ê³¼ ë©€ë‹¤).</li>
<li>WSSëŠ” êµ°ì§‘ ë‚´ ì œê³±ê±°ë¦¬ í•©ì´ë¼ ë‚®ì„ìˆ˜ë¡ â€œê° êµ°ì§‘ì´ ë” ì´˜ì´˜í•˜ë‹¤â€ëŠ” ëœ»ì´ì§€ë§Œ, Kê°€ ì»¤ì§ˆìˆ˜ë¡ ë³´í†µ ìë™ìœ¼ë¡œ ì‘ì•„ì§„ë‹¤(ê·¸ë˜ì„œ ë‹¨ë…ìœ¼ë¡œëŠ” í•´ì„ì´ ì–´ë µë‹¤).</li>
</ul>
<p><strong>ì™¸ë¶€ì§€í‘œ: ARI, NMI, purity(majority vote)</strong></p>
<ul>
<li>ARI/NMIëŠ” â€œêµ°ì§‘ ê²°ê³¼ê°€ ì‹¤ì œ ì •ë‹µ ìˆ«ì(y)ì™€ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œê°€â€ë¥¼ ë³¸ë‹¤. ì´ ê°’ì´ ë†’ìœ¼ë©´, êµ°ì§‘ì´ ì‚¬ì‹¤ìƒ ìˆ«ì ë¶„ë¥˜ì— ê°€ê¹Œìš´ êµ¬ì¡°ë¥¼ ë§Œë“¤ì—ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.</li>
<li>purityëŠ” ê° í´ëŸ¬ìŠ¤í„°ì—ì„œ ê°€ì¥ ë§ì€ ìˆ«ì(major digit)ë¥¼ ëŒ€í‘œ ìˆ«ìë¡œ ë†“ê³ , ì „ì²´ê°€ ì–¼ë§ˆë‚˜ ë§ì•˜ëŠ”ì§€(ë‹¤ìˆ˜ê²° ì •í™•ë„)ë¥¼ ë³´ëŠ” ì§ê´€ì  ì§€í‘œë‹¤.</li>
</ul>
<p><strong>ARI/NMI ê¸°ì¤€ ìƒìœ„ 3ê°œ ë°©ë²•</strong></p>
<ul>
<li>Hierarchical(Ward), K=20: ARI=0.688, NMI=0.795, purity=0.840</li>
<li>AutoEncoder(10D) ì„ë² ë”© + KMeans, K=9: ARI=0.598, NMI=0.701, purity=0.717</li>
<li>KMeans(ì›ê³µê°„), K=15: ARI=0.568, NMI=0.688, purity=0.715</li>
</ul>
<p>ì´ì œ ê° ë°©ë²•ì˜ êµì°¨í‘œ(í´ëŸ¬ìŠ¤í„° x true_digit)ë¥¼ ì½ì–´ë³´ì. í‘œì—ì„œ í•µì‹¬ì€ ë‘ ê°€ì§€ë‹¤.</p>
<ul>
<li>ì–´ë–¤ í´ëŸ¬ìŠ¤í„°ê°€ ê±°ì˜ í•œ ìˆ«ìë§Œ ë‹´ê³  ìˆëŠ”ê°€(ìˆœë„ê°€ ë†’ë‹¤)</li>
<li>ì–´ë–¤ ìˆ«ìê°€ ì—¬ëŸ¬ í´ëŸ¬ìŠ¤í„°ë¡œ ìª¼ê°œì¡ŒëŠ”ê°€(ë¶„í• ), í˜¹ì€ ì—¬ëŸ¬ ìˆ«ìê°€ í•œ í´ëŸ¬ìŠ¤í„°ì— ì„ì˜€ëŠ”ê°€(í˜¼í•©)</li>
</ul>
</section>
<section id="hierarchicalward-k20" class="level5">
<h5 class="anchored" data-anchor-id="hierarchicalward-k20">Hierarchical(Ward), K=20</h5>
<p>ì „ì²´ purityê°€ 0.84ë¡œ ê°€ì¥ ë†’ë‹¤. êµì°¨í‘œë¥¼ ë³´ë©´ â€œê±°ì˜ ì™„ì „ ìˆœìˆ˜â€ í´ëŸ¬ìŠ¤í„°ê°€ ì—¬ëŸ¿ ìˆë‹¤.</p>
<ul>
<li>0ë§Œ ëª¨ì¸ í´ëŸ¬ìŠ¤í„°(178ê°œ)</li>
<li>7ë§Œ ëª¨ì¸ í´ëŸ¬ìŠ¤í„°(151ê°œ)</li>
<li>2ë§Œ ëª¨ì¸ í´ëŸ¬ìŠ¤í„°(107ê°œ)</li>
<li>6ì´ ê±°ì˜ ë‹¨ë…(167/168)</li>
<li>4ê°€ ê±°ì˜ ë‹¨ë…(160/164)</li>
<li>5ê°€ ê±°ì˜ ë‹¨ë…(136/140)</li>
</ul>
<p>ì¦‰, WardëŠ” ìˆ«ì ì •ë‹µê³¼ ì˜ ë§ëŠ” êµ°ì§‘ì„ ë§ì´ ë§Œë“¤ì–´ë‚¸ë‹¤. ëŒ€ì‹  K=20ì´ë¼ëŠ” ì ì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ”, ìˆ«ì 10ê°œë¥¼ 20ê°œë¡œ ë‚˜ëˆ´ë‹¤ëŠ” ê²ƒì´ë‹¤. ê°™ì€ ìˆ«ìë¼ë„ í•„ê¸°ì²´ê°€ ì—¬ëŸ¬ ìœ í˜•ì´ë©´ ì—¬ëŸ¬ í´ëŸ¬ìŠ¤í„°ë¡œ ìª¼ê°œì¡Œì„ ê°€ëŠ¥ì„±ì´ í¬ë‹¤(ê³¼ë¶„í• ). ì‹¤ì œë¡œ ì‘ì€ í´ëŸ¬ìŠ¤í„°(í¬ê¸° 1~3ì§œë¦¬)ê°€ ì—¬ëŸ¬ ê°œ ë³´ì´ëŠ”ë°, ì´ëŠ” â€œíŠ¹ì´í•œ í˜•íƒœì˜ ìƒ˜í”Œâ€ì„ ë³„ë„ êµ°ì§‘ìœ¼ë¡œ ë–¼ì–´ë‚¸ ê²°ê³¼ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤.</p>
<p>ë˜í•œ í˜¼í•©ì´ í° í´ëŸ¬ìŠ¤í„°ë„ ìˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ cluster 0ì€ 3ê³¼ 9ê°€ í¬ê²Œ ì„ì—¬ ìˆë‹¤(3ì´ 168, 9ê°€ 135). ì´ëŠ” 3ê³¼ 9ê°€ ëª¨ì–‘ì´ ë¹„ìŠ·í•´ì§€ëŠ” ê²½ìš°(ë‹«íˆëŠ” ì •ë„, íšì˜ êµµê¸°/ê¸°ìš¸ê¸° ë“±) ê±°ë¦¬ ê¸°ë°˜ì—ì„œ í•œ ë©ì–´ë¦¬ë¡œ ê°€ê¹Œì›Œì§€ê¸° ë•Œë¬¸ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p>
<p>silhouetteê°€ ë‚®ì€ ì´ìœ (0.153)ëŠ” â€œë¼ë²¨ê³¼ëŠ” ì˜ ë§ì§€ë§Œ, ê±°ë¦¬ êµ¬ì¡° ê´€ì ì—ì„œ êµ°ì§‘ ê°„ ê²½ê³„ê°€ ì•„ì£¼ ì„ ëª…í•˜ì§„ ì•Šë‹¤â€ í˜¹ì€ â€œKë¥¼ í¬ê²Œ ì¡ì•„ ë¯¸ì„¸ ì°¨ì´ë¥¼ ë‚˜ëˆ„ë‹¤ ë³´ë‹ˆ êµ°ì§‘ ê°„ ë¶„ë¦¬ê°€ ë” ì¢‹ì•„ì§€ì§€ ì•ŠëŠ”ë‹¤â€ ì •ë„ë¡œ ì´í•´í•˜ë©´ ëœë‹¤.</p>
<pre class="text"><code>=== Top-3 methods (by ARI/NMI) ===
method  K   ARI NMI silhouette  wss AIC BIC
0   Hierarchical(Ward) (Sil-best)   20  0.688082    0.794962    0.152754    54003.237083    NaN NaN
1   AutoEncoder(10D, val_loss=0.02413) + KMeans (S...   9   0.597681    0.701210    0.280719    21491.103516    NaN NaN
2   KMeans (Sil-best)   15  0.568326    0.688241    0.158307    59534.498937    NaN NaN

=== Hierarchical(Ward) (Sil-best) ===
K=20, overall_purity(majority vote)=0.8397, ARI=0.6881, NMI=0.7950, silhouette=0.1528, WSS=54003.2
true_digit  0   1   2   3   4   5   6   7   8   9   major_digit cluster_size    cluster_purity
cluster                                                 
11  178 0   0   0   0   0   0   0   0   0   0   178 1.000000
9   0   0   0   0   0   0   0   151 0   0   7   151 1.000000
6   0   0   107 0   0   0   0   0   0   0   2   107 1.000000
16  0   0   0   0   3   0   0   0   0   0   4   3   1.000000
18  0   0   0   0   3   0   0   0   0   0   4   3   1.000000
12  0   0   0   0   1   0   0   0   0   0   4   1   1.000000
14  0   0   1   0   0   0   0   0   0   0   2   1   1.000000
8   0   0   0   0   0   1   167 0   0   0   6   168 0.994048
4   0   4   0   0   160 0   0   0   0   0   4   164 0.975610
7   0   0   0   0   0   136 0   0   1   3   5   140 0.971429
19  0   0   0   0   0   32  0   1   0   0   5   33  0.969697
15  0   0   0   0   0   0   13  0   0   1   6   14  0.928571
17  0   94  6   0   0   0   1   0   7   0   1   108 0.870370
3   0   1   9   11  4   0   0   0   160 21  8   206 0.776699
5   0   55  0   0   0   0   0   1   1   17  1   74  0.743243
1   0   0   0   0   9   0   0   25  0   3   7   37  0.675676
2   0   27  51  2   0   0   0   0   0   0   2   80  0.637500
0   0   0   1   168 0   12  0   1   2   135 3   319 0.526646
10  0   1   0   0   1   0   0   0   0   0   1   2   0.500000
13  0   0   2   2   0   1   0   0   3   0   8   8   0.375000</code></pre>
<p>ì´ ëŒ€í‘œ ì´ë¯¸ì§€ ê²°ê³¼ëŠ” Hierarchical(Ward) ë°©ë²•ì´ ìˆ«ìë¥¼ ë‹¨ìˆœíˆ 0~9ì˜ 10ê°œ ë²”ì£¼ë¡œ ë¬¶ì€ ê²ƒì´ ì•„ë‹ˆë¼, ê°™ì€ ìˆ«ì ì•ˆì—ì„œë„ í•„ê¸° ìŠ¤íƒ€ì¼ì˜ ì°¨ì´ë¥¼ ì„¸ë¶„í™”í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ êµ°ì§‘ìœ¼ë¡œ ë¶„í•´í–ˆìŒì„ ë³´ì—¬ì¤€ë‹¤.</p>
<p>ì¼ë¶€ í´ëŸ¬ìŠ¤í„°ëŠ” 0, 2, 4, 6ì²˜ëŸ¼ ê±°ì˜ í•œ ìˆ«ìë§Œì„ ë‹´ëŠ” ì „í˜•ì ì¸ í˜•íƒœë¡œ ë‚˜íƒ€ë‚˜ ë§¤ìš° ë†’ì€ ìˆœë„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ë°˜ë©´, 3ê³¼ 9ì²˜ëŸ¼ í˜•íƒœê°€ ìœ ì‚¬í•œ ìˆ«ìëŠ” ì„œë¡œ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë°˜ë³µ ë“±ì¥í•˜ê±°ë‚˜ ë‹¤ì†Œ ì• ë§¤í•œ ëŒ€í‘œ ì´ë¯¸ì§€ë¥¼ ë³´ì´ê¸°ë„ í•œë‹¤.</p>
<p>ì´ëŠ” Wardê°€ êµ°ì§‘ ë‚´ ë¶„ì‚°ì„ ìµœì†Œí™”í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™í•˜ë©´ì„œ ìˆ«ì ë‚´ë¶€ì˜ íš êµ¬ì¡°, ê¸°ìš¸ê¸°, ë‹«í˜ ì—¬ë¶€ ë“±ì˜ ë¯¸ì„¸í•œ ì°¨ì´ê¹Œì§€ ë°˜ì˜í–ˆê¸° ë•Œë¬¸ì´ë©°, ê·¸ ê²°ê³¼ ARIì™€ purityëŠ” ë†’ê²Œ ë‚˜íƒ€ë‚¬ì§€ë§Œ êµ°ì§‘ ìˆ˜ê°€ 20ê°œë¡œ ëŠ˜ì–´ë‚˜ ê³¼ë¶„í• ëœ êµ¬ì¡°ë¥¼ í˜•ì„±í–ˆìŒì„ ì‹œì‚¬í•œë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_compare_ward.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</section>
<section id="autoencoder10d-ì„ë² ë”©-kmeans-k9" class="level5">
<h5 class="anchored" data-anchor-id="autoencoder10d-ì„ë² ë”©-kmeans-k9">AutoEncoder(10D) ì„ë² ë”© + KMeans, K=9</h5>
<p>ì´ ë°©ë²•ì€ ë¨¼ì € ì˜¤í† ì¸ì½”ë”ê°€ 64ì°¨ì› í”½ì…€ì„ 10ì°¨ì› ì„ë² ë”©ìœ¼ë¡œ ì••ì¶•(ì¬êµ¬ì„± ì†ì‹¤ ìµœì†Œí™”)í•˜ê³ , ê·¸ ì„ë² ë”©ì—ì„œ KMeansë¥¼ ìˆ˜í–‰í•œ ê²ƒì´ë‹¤. ê²°ê³¼ì—ì„œ ê°€ì¥ ëˆˆì— ë„ëŠ” ê±´ silhouetteê°€ 0.281ë¡œ ê°€ì¥ ë†’ë‹¤ëŠ” ì ì´ë‹¤. ì¦‰, ì„ë² ë”© ê³µê°„ì—ì„œëŠ” êµ°ì§‘ì´ ë” â€œê¹”ë”í•˜ê²Œâ€ ê°ˆë¼ì¡Œë‹¤ëŠ” ëœ»ì´ë‹¤.</p>
<p>êµì°¨í‘œë¥¼ ë³´ë©´ ìˆœìˆ˜ë„ê°€ ë†’ì€ í´ëŸ¬ìŠ¤í„°ê°€ ëª‡ ê°œ ì¡´ì¬í•œë‹¤.</p>
<ul>
<li>0 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(176/181)</li>
<li>6 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(176/182)</li>
<li>4 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(161/167)</li>
<li>5 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(159/180)</li>
<li>7 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(157/185)</li>
</ul>
<p>ë°˜ë©´, K=9ë¼ì„œ ìˆ«ì 10ì¢…ì„ ì™„ì „íˆ 1:1ë¡œ ë‚˜ëˆŒ ìˆ˜ ì—†ë‹¤. ê·¸ë˜ì„œ ëª‡ ê°œ ìˆ«ìëŠ” í•©ì³ì§€ê±°ë‚˜, ì–´ë–¤ í´ëŸ¬ìŠ¤í„°ëŠ” í¬ê²Œ ì„ì¸ë‹¤.</p>
<ul>
<li>cluster 3ì€ 3(160)ê³¼ 9(140)ì´ ê°™ì´ ë§ê³ , 8(40)ë„ ì„ì¸ë‹¤.</li>
<li>cluster 5ëŠ” 1(106)ê³¼ 8(107)ì´ ê°™ì´ ë§ë‹¤.</li>
</ul>
<p>ì´ í˜„ìƒì€ â€œì„ë² ë”©ì´ ìˆ«ì ë¶„ë¦¬ ëª©ì ì´ ì•„ë‹ˆë¼ ì¬êµ¬ì„± ëª©ì â€ìœ¼ë¡œ í•™ìŠµë˜ì—ˆê¸° ë•Œë¬¸ì— ìì—°ìŠ¤ëŸ½ë‹¤. ì¦‰, ë¹„ìŠ·í•œ ìœ¤ê³½ì„ ê°–ëŠ” ìˆ«ììŒ(3-9, 1-8)ì´ ì„ë² ë”© ê³µê°„ì—ì„œë„ ê°€ê¹Œì›Œì ¸ í•˜ë‚˜ì˜ êµ°ì§‘ìœ¼ë¡œ ë¬¶ì´ê¸° ì‰½ë‹¤.</p>
<pre class="text"><code>=== AutoEncoder(10D, val_loss=0.02413) + KMeans (Sil-best) ===
K=9, overall_purity(majority vote)=0.7173, ARI=0.5977, NMI=0.7012, silhouette=0.2807, WSS=21491.1
true_digit  0   1   2   3   4   5   6   7   8   9   major_digit cluster_size    cluster_purity
cluster                                                 
7   176 0   1   0   0   1   1   0   1   1   0   181 0.972376
4   0   2   0   0   0   1   176 0   3   0   6   182 0.967033
1   2   0   0   0   161 1   1   0   2   0   4   167 0.964072
2   0   1   0   3   2   159 0   0   8   7   5   180 0.883333
8   0   0   1   7   9   0   0   157 5   6   7   185 0.848649
0   0   25  145 4   0   0   0   0   2   1   2   177 0.819209
6   0   48  3   2   6   0   0   17  6   22  1   104 0.461538
3   0   0   8   160 0   20  0   0   40  140 3   368 0.434783
5   0   106 19  7   3   0   3   5   107 3   8   253 0.422925</code></pre>
<p>ì´ ê²°ê³¼ëŠ” AutoEncoder(10ì°¨ì› ì„ë² ë”©)ì—ì„œ í•™ìŠµëœ í‘œí˜„ ê³µê°„ì— KMeansë¥¼ ì ìš©í–ˆì„ ë•Œ ì–»ì–´ì§„ ê° í´ëŸ¬ìŠ¤í„°ì˜ ëŒ€í‘œ ì´ë¯¸ì§€ì´ë‹¤. ì „ë°˜ì ìœ¼ë¡œ 0, 4, 6 ë“±ì€ ë¹„êµì  ì „í˜•ì ì¸ í˜•íƒœë¡œ ë˜ë ·í•˜ê²Œ ë¶„ë¦¬ë˜ì–´ ë‚˜íƒ€ë‚˜ë©°, ì´ëŠ” ì˜¤í† ì¸ì½”ë”ê°€ í”½ì…€ì˜ ë…¸ì´ì¦ˆë¥¼ ì¤„ì´ê³  ìˆ«ìì˜ í•µì‹¬ êµ¬ì¡°ë¥¼ ìš”ì•½í•œ ë•ë¶„ì— ê°™ì€ ìˆ«ìë“¤ì´ ì„ë² ë”© ê³µê°„ì—ì„œ ë” ê°€ê¹Œì›Œì¡ŒìŒì„ ì‹œì‚¬í•œë‹¤.</p>
<p>ê·¸ëŸ¬ë‚˜ ì¼ë¶€ í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” 3ê³¼ 9ì²˜ëŸ¼ í˜•íƒœê°€ ìœ ì‚¬í•œ ìˆ«ìë“¤ì´ ì¸ì ‘í•˜ê²Œ ë°°ì¹˜ë˜ê±°ë‚˜, íšì˜ êµµê¸°Â·ê¸°ìš¸ê¸° ì°¨ì´ì— ë”°ë¼ ê²½ê³„ê°€ ë‹¤ì†Œ ëª¨í˜¸í•œ ëŒ€í‘œ ì´ë¯¸ì§€ë„ ê´€ì°°ëœë‹¤. íŠ¹íˆ K=9ë¡œ ì„ íƒë˜ì—ˆê¸° ë•Œë¬¸ì— 10ê°œì˜ ìˆ«ì ì¤‘ ì¼ë¶€ëŠ” í•˜ë‚˜ì˜ êµ°ì§‘ìœ¼ë¡œ í†µí•©ë  ê°€ëŠ¥ì„±ì´ êµ¬ì¡°ì ìœ¼ë¡œ ì¡´ì¬í•˜ë©°, ì´ëŠ” purityì™€ ARIê°€ Ward ë°©ë²•ë³´ë‹¤ ë‹¤ì†Œ ë‚®ê²Œ ë‚˜íƒ€ë‚œ ì´ìœ ì™€ ì—°ê²°ëœë‹¤.</p>
<p>ì¦‰, ì´ ê²°ê³¼ëŠ” í‘œí˜„ í•™ìŠµì„ í†µí•´ êµ°ì§‘ ê°„ ë¶„ë¦¬ë„ëŠ” ê°œì„ ë˜ì—ˆì§€ë§Œ, êµ°ì§‘ ìˆ˜ ì„ íƒì˜ ì˜í–¥ìœ¼ë¡œ ì¼ë¶€ ìˆ«ì í†µí•© í˜„ìƒì´ í•¨ê»˜ ë‚˜íƒ€ë‚œ ì‚¬ë¡€ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_compare_autoencorder.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</section>
<section id="kmeansì›ê³µê°„-k15" class="level5">
<h5 class="anchored" data-anchor-id="kmeansì›ê³µê°„-k15">KMeans(ì›ê³µê°„), K=15</h5>
<p>ì›ê³µê°„(í‘œì¤€í™”ëœ í”½ì…€)ì—ì„œ ë°”ë¡œ KMeansë¥¼ ëŒë¦° ê²°ê³¼ëŠ” ê°„ë‹¨í•œ ë² ì´ìŠ¤ë¼ì¸ì´ë‹¤. ì¼ë¶€ ìˆ«ìëŠ” ë§¤ìš° ê¹¨ë—í•˜ê²Œ ì¡íŒë‹¤.</p>
<ul>
<li>4 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(154/155)</li>
<li>0 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(177/179)</li>
<li>6 ì¤‘ì‹¬ í´ëŸ¬ìŠ¤í„°(173/176)</li>
</ul>
<p>ê·¸ëŸ¬ë‚˜ ëª‡ ê°œ í° í´ëŸ¬ìŠ¤í„°ëŠ” ì—¬ëŸ¬ ìˆ«ìê°€ ì„ì¸ë‹¤.</p>
<ul>
<li>cluster 1ì€ 1(98)ê³¼ 8(95)ì´ ë¹„ìŠ·í•œ ê·œëª¨ë¡œ ì„ì¸ë‹¤.</li>
<li>cluster 3ì€ 3(153)ê³¼ 9(144)ê°€ ê°•í•˜ê²Œ ì„ì¸ë‹¤.</li>
</ul>
<p>silhouetteê°€ ë‚®ì€ ì´ìœ (0.158)ëŠ” í”½ì…€ê±°ë¦¬ì˜ í•œê³„ ë•Œë¬¸ì´ë‹¤. í•„ê¸°ì²´ëŠ” ì¡°ê¸ˆë§Œ ì´ë™/ê¸°ìš¸ì–´ë„ í”½ì…€ê³µê°„ì—ì„œëŠ” ë©€ì–´ì§ˆ ìˆ˜ ìˆê³ , ë°˜ëŒ€ë¡œ ë‹¤ë¥¸ ìˆ«ìë¼ë„ ìœ¤ê³½ì´ ë¹„ìŠ·í•˜ë©´ ê°€ê¹Œì›Œì§ˆ ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ â€œê±°ë¦¬ ê¸°ë°˜ ë¶„ë¦¬â€ê°€ ì„ë² ë”© ê¸°ë°˜ë³´ë‹¤ ë¶ˆë¦¬í•˜ë‹¤.</p>
<p><strong>í•œ ì¤„ ê²°ë¡ </strong></p>
<ul>
<li>ì •ë‹µ ë¼ë²¨ê³¼ ê°€ì¥ ì˜ ë§ì¶˜ ê²ƒì€ Ward(K=20)ì´ë©°, ëŒ€ì‹  êµ°ì§‘ì´ ë§ì•„(20ê°œ) ìˆ«ì í•˜ë‚˜ê°€ ì—¬ëŸ¬ êµ°ì§‘ìœ¼ë¡œ ìª¼ê°œì§€ëŠ” ê²½í–¥ì´ ìˆë‹¤.</li>
<li>ì„ë² ë”© ê¸°ë°˜(AE+KMeans)ì€ êµ°ì§‘ì˜ ë‚´ë¶€ ë¶„ë¦¬(silhouette)ë¥¼ ê°€ì¥ ê°œì„ í–ˆì§€ë§Œ, íŠ¹ì • ìˆ«ììŒ(3-9, 1-8 ë“±)ì´ ì„ì´ëŠ” ë¬¸ì œê°€ ë‚¨ëŠ”ë‹¤.</li>
<li>ì›ê³µê°„ KMeansëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ê¸°ì¤€ì„ ì´ë©°, ì¼ë¶€ ìˆ«ìëŠ” ì˜ ì¡ì§€ë§Œ í˜¼í•© í´ëŸ¬ìŠ¤í„°ê°€ ìƒëŒ€ì ìœ¼ë¡œ í¬ë‹¤.</li>
</ul>
<p>ì´ íë¦„ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§€ëŠ” ì•„ì´ë””ì–´ê°€ â€œdeep clustering(DECë¥˜)â€ì´ë‹¤. ì¬êµ¬ì„±ë§Œ í•˜ë˜ ì„ë² ë”©ì„, êµ°ì§‘ì´ ë” ì˜ ë¶„ë¦¬ë˜ë„ë¡(soft assignmentì™€ KL divergence ë“±) ëª©ì í•¨ìˆ˜ì— êµ°ì§‘ í•­ì„ ì¶”ê°€í•´ í•¨ê»˜ í•™ìŠµí•˜ëŠ” ë°©ì‹ì´ë‹¤.</p>
<pre class="text"><code>=== KMeans (Sil-best) ===
K=15, overall_purity(majority vote)=0.7145, ARI=0.5683, NMI=0.6882, silhouette=0.1583, WSS=59534.5
true_digit  0   1   2   3   4   5   6   7   8   9   major_digit cluster_size    cluster_purity
cluster                                                 
11  0   0   1   0   0   0   0   0   0   0   2   1   1.000000
13  0   0   0   0   1   0   0   0   0   0   4   1   1.000000
10  0   0   0   0   154 1   0   0   0   0   4   155 0.993548
6   177 0   0   0   0   0   1   0   1   0   0   179 0.988827
5   0   0   0   0   0   1   173 0   2   0   6   176 0.982955
14  0   0   103 4   0   0   0   2   4   0   2   113 0.911504
8   0   0   0   1   2   130 0   1   8   4   5   146 0.890411
4   0   0   2   10  5   0   0   152 2   9   7   180 0.844444
0   0   0   0   0   9   0   0   17  0   3   7   29  0.586207
9   0   27  36  1   0   0   0   0   0   0   2   64  0.562500
2   0   56  4   0   7   0   1   2   11  19  1   100 0.560000
7   0   0   13  8   0   31  0   5   3   0   5   60  0.516667
1   1   98  12  5   3   1   6   0   95  1   1   222 0.441441
3   0   0   5   153 0   18  0   0   46  144 3   366 0.418033
12  0   1   1   1   0   0   0   0   2   0   8   5   0.400000</code></pre>
<p>ì´ ê²°ê³¼ëŠ” ì›ê³µê°„(64ì°¨ì› í”½ì…€ ê³µê°„)ì—ì„œ ì§ì ‘ KMeansë¥¼ ì ìš©í–ˆì„ ë•Œì˜ ê° í´ëŸ¬ìŠ¤í„° ëŒ€í‘œ ì´ë¯¸ì§€ì´ë‹¤. ì „ë°˜ì ìœ¼ë¡œ 0, 4, 6ê³¼ ê°™ì´ êµ¬ì¡°ê°€ ë¹„êµì  ëšœë ·í•œ ìˆ«ìëŠ” ë¹„êµì  ì•ˆì •ì ìœ¼ë¡œ í•˜ë‚˜ì˜ êµ°ì§‘ ì¤‘ì‹¬ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ì§€ë§Œ, 1Â·8Â·3Â·9ì²˜ëŸ¼ íš êµ¬ì¡°ê°€ ìœ ì‚¬í•˜ê±°ë‚˜ í•„ê¸° ìŠ¤íƒ€ì¼ ë³€í˜•ì´ í° ìˆ«ìë“¤ì€ ì„œë¡œ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë°˜ë³µë˜ê±°ë‚˜ í˜•íƒœê°€ ë‹¤ì†Œ ì„ì¸ ëª¨ìŠµì´ ê´€ì°°ëœë‹¤.</p>
<p>íŠ¹íˆ ì¼ë¶€ ëŒ€í‘œ ì´ë¯¸ì§€ëŠ” íŠ¹ì • ìˆ«ìì˜ ì „í˜•ì  í˜•íƒœë¼ê¸°ë³´ë‹¤ëŠ” ì—¬ëŸ¬ ìˆ«ìì˜ í‰ê· ì ì¸ ìœ¤ê³½ì²˜ëŸ¼ ë³´ì´ëŠ”ë°, ì´ëŠ” í”½ì…€ ê¸°ë°˜ ìœ í´ë¦¬ë“œ ê±°ë¦¬ê°€ ìˆ«ìì˜ â€œì˜ë¯¸ì  í˜•íƒœ ì°¨ì´â€ë¥¼ ì¶©ë¶„íˆ ë°˜ì˜í•˜ì§€ ëª»í–ˆê¸° ë•Œë¬¸ìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤. ë˜í•œ K=15ë¡œ ê³¼ë¶„í• ëœ ìƒíƒœì´ë¯€ë¡œ ë™ì¼ ìˆ«ìê°€ ì—¬ëŸ¬ êµ°ì§‘ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ë‚˜íƒ€ë‚˜ëŠ” ê²½í–¥ì´ ìˆìœ¼ë©°, ì´ëŠ” purityë¥¼ ì¼ì • ìˆ˜ì¤€ê¹Œì§€ ëŒì–´ì˜¬ë¦¬ì§€ë§Œ êµ°ì§‘ ê°„ ë¶„ë¦¬ë„(silhouette)ê°€ ë†’ì§€ ì•Šì€ ê²°ê³¼ì™€ ì—°ê²°ëœë‹¤.</p>
<p>ì¦‰, ì´ ê·¸ë¦¼ì€ ì „í†µì  KMeansê°€ ìˆ«ìì˜ ê¸°í•˜í•™ì  í”½ì…€ ìœ ì‚¬ì„±ì—ëŠ” ë°˜ì‘í•˜ì§€ë§Œ, í˜•íƒœì  ì˜ë¯¸ êµ¬ì¡°ê¹Œì§€ ì¶©ë¶„íˆ ë°˜ì˜í•˜ì§€ëŠ” ëª»í•˜ëŠ” í•œê³„ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ì‚¬ë¡€ë¼ í•  ìˆ˜ ìˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clustering_compare_kmeans.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<p><strong>ì„¸ ë°©ë²• ë¹„êµ</strong></p>
<p>ì„¸ ë°©ë²•ì„ í•œ ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½í•˜ë©´, WardëŠ” ë§ì´ ìª¼ê°œì„œ ë” ìˆœìˆ˜í•œ ë©ì–´ë¦¬ë¥¼ ë§Œë“¤ì—ˆê³ , AutoEncoder+KMeansëŠ” í‘œí˜„ì„ ë°”ê¿”ì„œ ë©ì–´ë¦¬ ì‚¬ì´ ê°„ê²©ì„ ë²Œë ¸ê³ , KMeansëŠ” ì›ë˜ í”½ì…€ ê³µê°„ì—ì„œ ê·¸ëƒ¥ ê±°ë¦¬ë¡œë§Œ ë°€ì–´ë¶™ì¸ ê²°ê³¼ë‹¤.</p>
<p>ë¨¼ì € Hierarchical(Ward)ì˜ K=20ì€ ìˆ«ìê°€ 10ê°œì¸ë° êµ°ì§‘ì´ 20ê°œë¼ëŠ” ëœ»ì´ë¼, ê°™ì€ ìˆ«ìë¼ë„ í•„ê¸°ì²´ ëª¨ì–‘ ì°¨ì´ë¥¼ ë”°ë¡œ ë–¼ì–´ë‚´ëŠ” ë°©í–¥ìœ¼ë¡œ ì‘ë™í–ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 9ë„ ì–´ë–¤ ì‚¬ëŒì€ ë‘¥ê¸€ê²Œ ì“°ê³  ì–´ë–¤ ì‚¬ëŒì€ ê°ì§€ê²Œ ì“°ëŠ”ë°, WardëŠ” ì´ëŸ° ëª¨ì–‘ ì°¨ì´ë¥¼ ë³„ê°œì˜ êµ°ì§‘ìœ¼ë¡œ ë§Œë“¤ì–´ë²„ë¦´ ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ purityê°€ 0.840ìœ¼ë¡œ ë†’ê²Œ ë‚˜ì˜¨ë‹¤.</p>
<p>â€œì˜ê²Œ ë‚˜ëˆ„ë©´ ëœ ì„ì¸ë‹¤â€ëŠ” íš¨ê³¼ê°€ ê·¸ëŒ€ë¡œ ë°˜ì˜ëœ ê²ƒì´ë‹¤. ARIì™€ NMIë„ ê°€ì¥ ë†’ì•„ì„œ, ê²°ê³¼ì ìœ¼ë¡œ ìˆ«ì ë¼ë²¨ê³¼ì˜ ì •ë ¬ì´ ê°€ì¥ ì˜ ë§ëŠ”ë‹¤. ë‹¤ë§Œ silhouetteê°€ ë‚®ë‹¤ëŠ” ê²ƒì€, ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ 20ê°œ ë©ì–´ë¦¬ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì•„ì£¼ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆë‹¤ê¸°ë³´ë‹¤ëŠ”, ê°€ê¹Œìš´ ë©ì–´ë¦¬ë“¤ì„ ì´˜ì´˜íˆ ë‚˜ëˆˆ í˜•íƒœì¼ ìˆ˜ ìˆìŒì„ ì‹œì‚¬í•œë‹¤.</p>
<p>AutoEncoder(10D)+KMeansëŠ” K=9ë¡œ ì„ íƒëë‹¤. silhouetteë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë³´ë©´, ì„ë² ë”© ê³µê°„ì—ì„œ ê°€ì¥ â€œêµ°ì§‘ ê°„ ê°„ê²©ì´ ê¹”ë”í•´ ë³´ì´ëŠ” Kâ€ê°€ 9ì˜€ë‹¤ëŠ” ëœ»ì´ë‹¤. ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì§ê´€ì€, ì˜¤í† ì¸ì½”ë”ê°€ í”½ì…€ì„ ê·¸ëŒ€ë¡œ ì“°ì§€ ì•Šê³  â€œìˆ«ì ëª¨ì–‘ì„ ì„¤ëª…í•˜ëŠ” í•µì‹¬ ìš”ì•½ ì¢Œí‘œâ€ë¡œ ëˆŒëŸ¬ ë‹´ì•„ ì£¼ì—ˆë‹¤ëŠ” ì ì´ë‹¤.</p>
<p>ê·¸ë˜ì„œ ê°™ì€ ìˆ«ìëŠ” ë” ê°€ê¹Œì›Œì§€ê³  ë‹¤ë¥¸ ìˆ«ìëŠ” ë” ë©€ì–´ì§€ë©´ì„œ silhouetteê°€ ê°€ì¥ ë†’ê²Œ(0.281) ë‚˜ì˜¨ë‹¤. ê·¸ëŸ°ë° Kê°€ 9ë¼ì„œ 10ê°œ ìˆ«ì ì¤‘ ì¼ë¶€ëŠ” í•©ì³ì§ˆ ìˆ˜ë°–ì— ì—†ë‹¤. ì´ í•©ì³ì§ì´ purityë¥¼ 0.717 ìˆ˜ì¤€ìœ¼ë¡œ ì œí•œí•˜ê³ , ARIë„ Wardë§Œí¼ ì˜¬ë¼ê°€ì§€ ëª»í•˜ê²Œ ë§Œë“ ë‹¤. ì¦‰, ì´ ê²°ê³¼ëŠ” â€œí‘œí˜„ í•™ìŠµì˜ ì´ë“â€ê³¼ â€œK ì„ íƒ(ê³¼ì†Œë¶„í• )ì˜ ì†í•´â€ê°€ ê°™ì´ ë“¤ì–´ ìˆëŠ” ê²°ê³¼ë‹¤.</p>
<p>KMeansëŠ” ì›ê³µê°„ì—ì„œ K=15ë¡œ ì„ íƒë˜ì—ˆë‹¤. ìˆ«ì 10ê°œë³´ë‹¤ ë” ë§ì´ ìª¼ê°œì¡Œê¸° ë•Œë¬¸ì— purityê°€ 0.715ë¡œ AE+KMeansì™€ ë¹„ìŠ·í•˜ê²Œ ë³´ì´ì§€ë§Œ, ì˜ë¯¸ëŠ” ë‹¤ë¥´ë‹¤.</p>
<p>AE+KMeansì˜ 0.715ëŠ” â€œì„ë² ë”©ì´ ì–´ëŠ ì •ë„ ì˜ë¯¸ë¥¼ ì¡ì•˜ëŠ”ë° Kê°€ ì‘ì•„ í•©ì³ì§„ íƒ“â€ì´ ì„ì¸ ê°’ì´ê³ , KMeansì˜ 0.715ëŠ” â€œì›ê³µê°„ ê±°ë¦¬ë¡œ ì• ë§¤í•œ êµ¬ì¡°ë¥¼ ìª¼ê°œì„œ ìˆœë„ë¥¼ ì˜¬ë¦° íƒ“â€ì´ ì„ì¸ ê°’ì´ë‹¤. ARI/NMIê°€ AE+KMeansë³´ë‹¤ ë‚®ì€ ê²ƒì€, ì›ê³µê°„ ê±°ë¦¬ ê¸°ë°˜ êµ°ì§‘ì´ ìˆ«ì ì˜ë¯¸ë¥¼ ë°˜ì˜í•˜ëŠ” ë° í•œê³„ê°€ ìˆë‹¤ëŠ” ì‹ í˜¸ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤.</p>
<p>ìµœì¢…ì ìœ¼ë¡œ, ì´ ë¹„êµí‘œê°€ ì£¼ëŠ” ë©”ì‹œì§€ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. WardëŠ” ê³¼ë¶„í• ì„ í†µí•´ ë¼ë²¨ ì •ë ¬ì„ ê°€ì¥ ì˜ ë§ì¶”ëŠ” ë°©ë²•ì´ê³ , AutoEncoder+KMeansëŠ” í‘œí˜„ì„ ë°”ê¿” êµ°ì§‘ êµ¬ì¡°(ë‚´ë¶€ ë¶„ë¦¬ë„)ë¥¼ ê°€ì¥ ì„ ëª…í•˜ê²Œ ë§Œë“¤ì§€ë§Œ Kê°€ 9ë¡œ ì„ íƒë˜ë©° ì¼ë¶€ ìˆ«ì í•©ì³ì§ì„ ê°ìˆ˜í•œë‹¤. KMeansëŠ” ì „í†µì  ê¸°ì¤€ì„ ìœ¼ë¡œì„œ, ì„ë² ë”©ì„ ì“°ë©´ ë¬´ì—‡ì´ ì¢‹ì•„ì§€ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ë¹„êµ ëŒ€ìƒìœ¼ë¡œ ì í•©í•˜ë‹¤.</p>
<pre class="text"><code>=== Top-3 summary table ===
method  K   purity(majority)    ARI NMI silhouette  WSS
0   Hierarchical(Ward) (Sil-best)   20  0.839733    0.688082    0.794962    0.152754    54003.237083
1   AutoEncoder(10D, val_loss=0.02413) + KMeans (S...   9   0.717307    0.597681    0.701210    0.280719    21491.074219
2   KMeans (Sil-best)   15  0.714524    0.568326    0.688241    0.158307    59534.498937</code></pre>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>